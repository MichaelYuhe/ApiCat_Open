var Ds=Object.defineProperty,Ps=Object.defineProperties;var js=Object.getOwnPropertyDescriptors;var dt=Object.getOwnPropertySymbols;var lo=Object.prototype.hasOwnProperty,uo=Object.prototype.propertyIsEnumerable;var Ct=(e,t,s)=>t in e?Ds(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,D=(e,t)=>{for(var s in t||(t={}))lo.call(t,s)&&Ct(e,s,t[s]);if(dt)for(var s of dt(t))uo.call(t,s)&&Ct(e,s,t[s]);return e},H=(e,t)=>Ps(e,js(t));var po=(e,t)=>{var s={};for(var o in e)lo.call(e,o)&&t.indexOf(o)<0&&(s[o]=e[o]);if(e!=null&&dt)for(var o of dt(e))t.indexOf(o)<0&&uo.call(e,o)&&(s[o]=e[o]);return s};var O=(e,t,s)=>(Ct(e,typeof t!="symbol"?t+"":t,s),s);import{aY as Me,o as d,h as g,aZ as Xe,a_ as Qe,j as a,K as ee,a$ as ne,v,Y as B,V as T,$ as h,b0 as Ss,W as U,r as N,b1 as vt,b2 as Io,b3 as S,b4 as Rs,as as Q,at as ie,Z as m,a1 as $,L as ft,aF as xs,aG as Ts,b5 as ae,b6 as Ls,a0 as ce,ak as Y,S as mt,b7 as bo,y as et,C as No,X as M,T as te,U as pe,b8 as tt,x as he,a4 as Os,u as ue,b9 as $s,ba as Ms,bb as wo,a5 as Bt,ap as Ft,bc as Kt,t as ge,bd as Bs,p as $e,be as Vt,ar as Rt,aX as Fs,bf as We,bg as Ks,bh as Vs,bi as Re,l as xt,bj as kt,bk as Us,q as Do,m as Gs,i as zs,a2 as Po,_ as Hs,J as ho,A as Js,a6 as Ys,bl as Pe,ax as Ut,bm as Ws,bn as Ee,bo as fo,aB as jo,aA as So,M as qs,bp as Zs,bq as Ro,br as Xs,bs as Qs,bt as en,bu as tn,bv as on,bw as _o,aU as sn,bx as nn}from"./vendor.b7ec7f69.js";import{E as fe,a as Gt,b as zt,c as ot,d as yt,e as st,f as Ht,g as Be,h as Jt,m as rn,i as an,j as xo,k as cn,l as ln,_ as dn,v as nt,n as un,o as pn,p as hn,q as fn,r as To,s as Lo,t as At,u as Tt,w as Yt,x as _n,y as mn,z as gn,A as Oo,B as $o,C as vn,D as yn,F as En}from"./element-plus.aa12b6bd.js";const Cn=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const r of i.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function s(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerpolicy&&(i.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?i.credentials="include":n.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(n){if(n.ep)return;n.ep=!0;const i=s(n);fetch(n.href,i)}};Cn();const kn=Me({id:"app.store",state:()=>({isShowLoading:!1}),actions:{showLoading(){this.isShowLoading=!0},hideLoading(){this.isShowLoading=!1}}});var Z=(e,t)=>{const s=e.__vccOpts||e;for(const[o,n]of t)s[o]=n;return s};const An={},In=e=>(Xe("data-v-2dbca8a7"),e=e(),Qe(),e),bn={class:"vertical-center splash"},Nn=In(()=>a("div",{class:"w-full text-center text-light"},[a("svg",{class:"spin",style:{width:"70px"},xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 100 100"},[a("path",{id:"p",fill:"#006bff",d:"M94.1 58.8c.6-2.8.9-5.8.9-8.8s-.3-6-.9-8.8l-11.7-.4c-.7-2.6-1.7-5-3-7.3l8-8.5c-3.3-4.9-7.5-9.2-12.5-12.5l-8.5 8c-2.3-1.3-4.7-2.3-7.3-3l-.3-11.6C56 5.3 53 5 50 5s-6 .3-8.8.9l-.4 11.7c-2.6.7-5 1.7-7.3 3l-8.5-8c-4.9 3.3-9.2 7.5-12.5 12.5l8 8.5c-1.3 2.3-2.3 4.7-3 7.3l-11.6.3C5.3 44 5 47 5 50s.3 6 .9 8.8l11.7.4c.7 2.6 1.7 5 3 7.3l-8 8.5c3.3 4.9 7.5 9.2 12.5 12.5l8.5-8c2.3 1.3 4.7 2.3 7.3 3l.4 11.7c2.7.5 5.7.8 8.7.8s6-.3 8.8-.9l.4-11.7c2.6-.7 5-1.7 7.3-3l8.5 8c4.9-3.3 9.2-7.5 12.5-12.5l-8-8.5c1.3-2.3 2.3-4.7 3-7.3l11.6-.3zM50 66.9c-9.3 0-16.9-7.6-16.9-16.9S40.7 33.1 50 33.1 66.9 40.7 66.9 50 59.3 66.9 50 66.9z"})])],-1)),wn=[Nn];function Dn(e,t){return d(),g("div",bn,wn)}var Pn=Z(An,[["render",Dn],["__scopeId","data-v-2dbca8a7"]]);const jn=ee({setup(e){const t=kn(),{isShowLoading:s}=ne(t);return(o,n)=>(d(),g(U,null,[v(s)?(d(),B(Pn,{key:0})):T("",!0),h(v(Ss))],64))}}),Mo="/",fu=Mo,qe="/login",Wt="/register",it="/home",Ne={path:"/404"},Bo="/project/:project_id",Sn=Bo,Fo="/project/:project_id/setting",Ko="/project/:project_id/members",Vo="/project/:project_id/params",Uo="/project/:project_id/trash",qt="preview.project",Zt=`${qt}.verification`,Ze="preview.document",Rn="/doc/:doc_id",gt=`${Ze}.verification`,Xt="document",Te="document.api.edit",Go="/project/:project_id/doc/:node_id/edit",Le="document.api.detail",Qt="/project/:project_id/doc/:node_id?",zo="/iteration/:iterate_id",Ho="iteration.document",Jo="/iteration/:iterate_id/doc/:node_id/edit",Ie="iteration.document.api.edit",ze="iteration.document.api.detail",Yo="/iteration/:iterate_id/doc/:node_id?";var rt="/assets/logo.1c8e1405.svg";function Wo(e,t){t=D({isCatch:!0,isShowMessage:!0},t);const s=N(!1),{isCatch:o,isShowMessage:n,msg:i}=t;async function r(c){s.value=!0;try{const l=await e(c)||{};return n&&(i||l.msg)&&fe.success(i||l.msg),l}catch(l){if(o)return{};throw l}finally{s.value=!1}}return[s,r]}const xn="/api",Tn=1e3*10,_u=15;var Ke=(e=>(e[e.OK=0]="OK",e[e.FAIL=-1]="FAIL",e[e.NO_LOGIN=-2]="NO_LOGIN",e[e.NO_PARENT_DIR=-102]="NO_PARENT_DIR",e[e.NO_EXIST_TEAM=-100]="NO_EXIST_TEAM",e[e.INVALID_PREVIEW_SECRET=-103]="INVALID_PREVIEW_SECRET",e[e.NOT_FOUND=-404]="NOT_FOUND",e))(Ke||{});const xe={DIR:0,DOC:1,HTTP:1,OTHER:2,MARKDOWN:3},mu={API:{text:"\u63A5\u53E3\u6587\u6863",key:"api.doc",value:1},DB:{text:"\u6570\u636E\u5E93\u6587\u6863",key:"db.doc",value:2}},Ve={WAIT:"wait",FINISH:"finish",FAIL:"fail"},J={ADMIN:"admin",MANAGER:"manage",DEVELOPER:"write",READER:"read",NONE:"none"},It={MANAGER:0,DEVELOPER:1,READER:2},Ln=[{text:"\u56E2\u961F\u7BA1\u7406\u5458",value:999,key:J.ADMIN},{text:"\u7BA1\u7406\u8005",value:It.MANAGER,key:J.MANAGER},{text:"\u7EF4\u62A4\u8005",value:It.DEVELOPER,key:J.DEVELOPER},{text:"\u9605\u8BFB\u8005",value:It.READER,key:J.READER}],gu=Ln.filter(e=>[J.DEVELOPER,J.READER].indexOf(e.key)!==-1),vu="/static/icon-project.png",ke={PRIVATE:"private",PUBLIC:"public"},bt=[{text:"\u79C1\u6709",value:0,key:ke.PRIVATE},{text:"\u516C\u5F00",value:1,key:ke.PUBLIC}],Nt={PRIVATE:0,PUBLIC:1},Ue={ADMIN:0,MANAGER:1,NORMAL:2},On=[{text:"\u7BA1\u7406\u5458",value:Ue.MANAGER},{text:"\u666E\u901A\u6210\u5458",value:Ue.NORMAL}];[Ue.ADMIN,...On];const qo={baseURL:xn,headers:{Accept:"application/json, text/plain, */*"}};vt.defaults.timeout=Tn;var C=vt.create(qo);const Lt=vt.create(qo),$n=(e={})=>C.post("/email_login",D({},e)),Mn=(e={})=>C.post("/email_register",D({},e)),Bn=()=>C.post("/logout"),yu=(e={})=>C.post("/user/change_avatar",e),Fn=(e={})=>C.post("/user/change_profile",D({},e)),Kn=()=>C.get("/user/profile").then(e=>{if(e.data){const{name:t,avatar:s}=e.data;s||(e.data.lastName=Io(t||"\u65E0"))}return e}),Eu=()=>Wo((e={})=>C.post("/user/change_password",D({},e))),be=Me({id:"user",state:()=>({token:S.get(S.KEYS.TOKEN)||null,userInfo:S.get(S.KEYS.USER_INFO)||{}}),getters:{isLogin:e=>!!e.token,isAdmin:e=>e.userInfo.authority===Ue.ADMIN,isManager:e=>e.userInfo.authority===Ue.MANAGER,isNormal:e=>e.userInfo.authority===Ue.NORMAL,lastName:e=>Io(e.userInfo.name)},actions:{updateToken(e){S.set(S.KEYS.TOKEN,e),this.token=e},async login(e){try{const t=await $n(e);return await this.getUserInfo(),this.goHome(),t}catch{}},async register(e){try{const t=await Mn(e);return this.goHome(),t}catch{}},async logout(){S.removeAll([S.KEYS.TOKEN,S.KEYS.USER_INFO,S.KEYS.ACTIVE_PROJECT_GROUP]);try{await Bn()}catch{}finally{this.token=null,this.userInfo={},location.href=qe}},async getUserInfo(){if(!Rs.exports.isEmpty(this.userInfo))return this.userInfo;try{const{data:e}=await Kn()||{};return S.set(S.KEYS.USER_INFO,e),this.userInfo=e,this.userInfo}catch{}return{}},goHome(e){Ae.replace(e||it)},async updateUserInfo(e){await Fn(e),this.$patch({userInfo:{name:e.name,email:e.email,avatar:e.avatar}}),S.set(S.KEYS.USER_INFO,this.userInfo)}}}),Vn="modulepreload",mo={},Un="/",W=function(t,s){return!s||s.length===0?t():Promise.all(s.map(o=>{if(o=`${Un}${o}`,o in mo)return;mo[o]=!0;const n=o.endsWith(".css"),i=n?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${o}"]${i}`))return;const r=document.createElement("link");if(r.rel=n?"stylesheet":Vn,n||(r.as="script",r.crossOrigin=""),r.href=o,document.head.appendChild(r),n)return new Promise((c,l)=>{r.addEventListener("load",c),r.addEventListener("error",()=>l(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>t())},Gn={class:"flex flex-col border divide-y bg-white"},zn=ee({props:{menus:{type:Array,default:()=>[]}},setup(e){return(t,s)=>{const o=Q("router-link");return d(),g("div",Gn,[(d(!0),g(U,null,ie(e.menus,n=>(d(),B(o,{key:n.name,to:{name:n.name},class:"relative h-12 pl-6 flex items-center text-neutral-600 hover:text-neutral-900"},{default:m(()=>[a("span",null,$(n.meta.title),1)]),_:2},1032,["to"]))),128))])}}}),Hn={},Jn={class:"flex justify-between flex-col lg:flex-row"},Yn={class:"sidebar-nav flex-none lg:w-64 mb-4 lg:mb-0"},Wn={class:"flex-auto lg:ml-4 overflow-hidden"};function qn(e,t){const s=zn,o=Q("RouterView");return d(),g("div",Jn,[a("aside",Yn,[ft(e.$slots,"default",{},()=>[h(s,xs(Ts(e.$attrs)),null,16)])]),a("div",Wn,[h(o)])])}var eo=Z(Hn,[["render",qn]]);const Fe=(e=!0)=>e?window.origin:"",Ot=()=>{},Cu=(e={})=>C.post("/project/create",e),ku=(e={})=>C.post("/project/icon",e),Au=e=>C.post("/project/remove",{project_id:e}),Iu=e=>C.post("/project/quit",{project_id:e}),bu=(e={})=>C.post("/project/add_member",e),Nu=e=>C.get("/project/members",{params:e}),wu=(e,t)=>C.post("/project/remove_member",{project_id:e,user_id:t}),Du=(e,t)=>C.post("/project/transfer",{project_id:e,user_id:t}),Pu=(e={})=>C.post("/project/change_member_authority",e),Zn=(e={})=>C.post("/project/setting",e),Xn=(e,t)=>C.post("/project/share",{project_id:e,share:t}),Qn=e=>C.post("/project/reset_share_secretkey",{project_id:e}),ju=(e={})=>C.post("/doc/restore_api_doc",e),Zo=e=>C.get("/projects/base",{params:{authority:e}}),Su=()=>Zo([J.MANAGER,J.DEVELOPER,J.READER]),Ru=()=>Zo([J.MANAGER,J.DEVELOPER]),xu=e=>C.get("/projects",{params:{group_id:e==0?"":e}}),ei=e=>C.post("/project_group/create",e),ti=()=>C.get("/project_groups"),oi=e=>C.post("/project_group/remove",{id:e}),si=e=>C.post("/project_group/rename",e),ni=e=>C.post("/project_group/change_order",{ids:e}),ii=(e,t)=>C.get("/project",{params:{project_id:e,token:t}}),ri=(e={project_id:null,iteration_id:null},t)=>C.get("/project",{params:H(D({},e),{token:t})}),ai=e=>C.get("/project/status",{params:{project_id:e}}),Tu=e=>C.post("/project/change_group",e),Lu=e=>C.get("/doc/trash",{params:{project_id:e}}),Ou=e=>C.get("/project/without_members",{params:{project_id:e}}),go=(e,t)=>Fe(t)+ae(Bo)({project_id:e}),ci=(e,t)=>Fe(t)+ae(Fo)({project_id:e}),li=(e,t)=>Fe(t)+ae(Ko)({project_id:e}),di=(e,t)=>Fe(t)+ae(Vo)({project_id:e}),ui=(e,t)=>Fe(t)+ae(Uo)({project_id:e}),vo={id:0,name:"\u6240\u6709\u9879\u76EE"},Xo=Me({id:"projects",state:()=>({projectGroupList:[],activeGroup:S.get(S.KEYS.ACTIVE_PROJECT_GROUP)||vo}),getters:{},actions:{async getProjectGroupList(){const{data:e=[]}=await ti()||{};this.projectGroupList=e},switchProjectGroup(e=vo){S.set(S.KEYS.ACTIVE_PROJECT_GROUP,e),this.activeGroup=e},async addProjectGroup(e){const t=await ei(e);return t&&this.projectGroupList.push(t.data),t},async renameProjectGroup(e){const t=await si(e);if(t){const s=this.projectGroupList.find(o=>o.id==e.id);s.name=e.name}return t},async deleteProjectGroup(e){const t=await oi(e.id);return this.projectGroupList=this.projectGroupList.filter(s=>s.id!==e.id),this.activeGroup.id===e.id&&this.switchProjectGroup(),t},async sortProjectGroup(e,t){const s=this.projectGroupList.splice(e,1)[0];this.projectGroupList.splice(t,0,s),await ni(this.projectGroupList.map(o=>o.id))}}}),pi={data(){return{title:"",isShow:!1,isLoading:!1,isEdit:!1,form:{name:""},categoryInfo:null,rules:{name:{required:!0,message:"\u8BF7\u8F93\u5165\u5206\u7EC4\u540D\u79F0",trigger:"blur"}}}},watch:{isShow:function(){this.isShow&&(this.title=`${this.isEdit?"\u7F16\u8F91":"\u6DFB\u52A0"}\u5206\u7EC4`),!this.isShow&&this.reset()}},methods:H(D({},Ls(Xo,["addProjectGroup","renameProjectGroup"])),{show(e){this.isEdit=!!e,e?(this.categoryInfo=e,this.form=D({},e)):this.form.name="",this.isShow=!0,this.focus()},hide(){this.isShow=!1},onCloseBtnClick(){this.isShow=!1,this.reset()},reset(){this.$refs.teamForm.resetFields()},handleSubmit(e){this.$refs[e].validate(t=>t&&this.submit())},submit(){this.isLoading=!0,(this.isEdit?this.renameProjectGroup:this.addProjectGroup)(this.form).then(t=>{this.$Message.success(t.msg||`${this.isEdit?"\u7F16\u8F91":"\u6DFB\u52A0"}\u5206\u7EC4\u6210\u529F!`),this.onCloseBtnClick()}).finally(()=>{this.isLoading=!1}).catch(t=>{})},focus(){setTimeout(()=>this.$refs.input.focus(),200)}})},hi=Y(" \u53D6\u6D88 "),fi=Y(" \u786E\u5B9A ");function _i(e,t,s,o,n,i){const r=yt,c=Gt,l=zt,_=st,f=ot;return d(),B(f,{modelValue:n.isShow,"onUpdate:modelValue":t[4]||(t[4]=u=>n.isShow=u),width:340,"close-on-click-modal":!1,title:n.title,"append-to-body":"",class:"show-footer-line"},{footer:m(()=>[h(_,{onClick:t[2]||(t[2]=u=>i.onCloseBtnClick())},{default:m(()=>[hi]),_:1}),h(_,{loading:n.isLoading,type:"primary",onClick:t[3]||(t[3]=u=>i.handleSubmit("teamForm"))},{default:m(()=>[fi]),_:1},8,["loading"])]),default:m(()=>[h(l,{ref:"teamForm",model:n.form,rules:n.rules,"label-position":"top",style:{"margin-bottom":"-19px"},onSubmit:t[1]||(t[1]=ce(u=>i.handleSubmit("teamForm"),["prevent"]))},{default:m(()=>[h(c,{label:"\u5206\u7EC4\u540D\u79F0",prop:"name",class:"hide_required"},{default:m(()=>[h(r,{type:"text",ref:"input",modelValue:n.form.name,"onUpdate:modelValue":t[0]||(t[0]=u=>n.form.name=u),placeholder:"\u8BF7\u8F93\u5165\u5206\u7EC4\u540D\u79F0",maxlength:255},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}var mi=Z(pi,[["render",_i]]);const Qo=(e=Ht)=>({title:t,message:s,content:o,cb:n,onOk:i})=>(n=n||i,s=s||o,e({title:t,message:s,showCancelButton:!0,confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",beforeClose:function(r,c,l){r==="confirm"?(c.confirmButtonLoading=!0,Promise.resolve(n(l)).then(()=>l()).catch(_=>_).finally(()=>{c.confirmButtonLoading=!1})):l()}})),es=Qo();var gi={install:function(e){const t=e.config.globalProperties.$msgbox||Ht;e.config.globalProperties.$asyncMsgBox=Qo(t)}};function ts(e,t){function s(){mt(async()=>{if(e=v(e),!e)return;(await W(()=>import("./sortable.esm.85cd8ec3.js"),[])).default.create(e,D({animation:200,delay:400,delayOnTouchOnly:!0},t))})}return{initSortable:s}}const os=e=>(Xe("data-v-4f147e22"),e=e(),Qe(),e),vi={class:"flex flex-col bg-white border divide-y"},yi=os(()=>a("span",{class:"ml-1"},"\u6240\u6709\u9879\u76EE",-1)),Ei=["onClick"],Ci=["title"],ki=os(()=>a("span",{class:"ml-1"},"\u6DFB\u52A0\u5206\u7EC4",-1)),Ai=Y("\u91CD\u547D\u540D "),Ii=Y("\u5220\u9664 "),bi=ee({setup(e){const t=Xo(),{activeGroup:s,projectGroupList:o}=ne(t),n=N(null),i=N(!1),r=N(),c=N();let l=null;const _=A=>[{active:s.value.id===A}],f=()=>{var A;(A=n.value)==null||A.show()},u=A=>{t.switchProjectGroup(A)},y=(A,j)=>{l=j,r.value=A.currentTarget,i.value=!0},E=()=>{var A;l&&((A=n.value)==null||A.show(l))},p=()=>{l&&es({title:"\u5220\u9664\u63D0\u793A",content:`\u786E\u5B9A\u5220\u9664${l.name}\u5206\u7EC4\uFF1F`,onOk:()=>t.deleteProjectGroup(l).then(A=>{fe.success(A.msg||"\u5220\u9664\u6210\u529F\uFF01")})})};bo(r,A=>{var F,w;const P=A.target.parentNode,R=P.parentNode;((F=P==null?void 0:P.classList)==null?void 0:F.contains("el-icon__more"))||((w=R==null?void 0:R.classList)==null?void 0:w.contains("el-icon__more"))||(i.value=!1)});const{initSortable:k}=ts(c,{draggable:".ac-group-nav__item",onEnd(A){t.sortProjectGroup(A.oldIndex,A.newIndex)}});return et(async()=>{await t.getProjectGroupList(),k()}),No(()=>{l=null}),(A,j)=>{const P=Be,R=Jt;return d(),g(U,null,[h(eo,null,{default:m(()=>[a("div",vi,[a("a",{class:M(["relative flex items-center h-12 pl-6 text-neutral-600 hover:text-neutral-900",_(0)]),href:"javascript:void(0);",onClick:j[0]||(j[0]=F=>u())},[h(P,null,{default:m(()=>[h(v(rn))]),_:1}),yi],2),te(a("div",{class:"divide-y ac-group-nav",ref_key:"sortableList",ref:c},[(d(!0),g(U,null,ie(v(o),F=>(d(),g("a",{key:F.name,class:M(["relative flex items-center justify-between pr-4 text-neutral-600 hover:text-neutral-900 ac-group-nav__item",_(F.id)]),href:"javascript:void(0);"},[a("section",{class:"flex items-center flex-1 h-12 pl-6 overflow-hidden",onClick:w=>u(F)},[h(P,null,{default:m(()=>[h(v(an))]),_:1}),a("span",{class:"ml-1 truncate",title:F.name},$(F.name),9,Ci)],8,Ei),h(P,{onClick:w=>y(w,F),class:"ml-1 el-icon__more"},{default:m(()=>[h(v(xo))]),_:2},1032,["onClick"])],2))),128))],512),[[pe,v(o).length]]),a("a",{class:"relative flex items-center h-12 pl-6 text-neutral-600 hover:text-neutral-900",href:"javascript:void(0);",onClick:f},[h(P,null,{default:m(()=>[h(v(cn))]),_:1}),ki])])]),_:1}),h(mi,{ref_key:"addProjectCategoryModal",ref:n},null,512),h(R,{"popper-class":"ac-popper-menu",width:"auto",visible:i.value,"onUpdate:visible":j[1]||(j[1]=F=>i.value=F),"virtual-ref":r.value,"virtual-triggering":""},{default:m(()=>[a("ul",null,[a("li",{class:"ac-popper-menu__item",onClick:E},[h(P,{class:"mr-1"},{default:m(()=>[h(v(ln))]),_:1}),Ai]),a("li",{class:"ac-popper-menu__item",onClick:p},[h(P,{class:"mr-1"},{default:m(()=>[h(v(dn))]),_:1}),Ii])])]),_:1},8,["visible","virtual-ref"])],64)}}});var Ni=Z(bi,[["__scopeId","data-v-4f147e22"]]);const wi=()=>W(()=>import("./Projects.3ff4feb2.js"),["assets/Projects.3ff4feb2.js","assets/Projects.93e1632d.css","assets/element-plus.aa12b6bd.js","assets/element-plus.8e6ef202.css","assets/vendor.b7ec7f69.js","assets/ImagePreview.e3b8fddd.js","assets/ImagePreview.e9afec23.css"]),Di={path:"",name:"projects.index",meta:{title:"\u9879\u76EE\u5217\u8868"},component:wi},Pi=[Di],ss={path:it,name:"projects",meta:{title:"\u9879\u76EE",activeClassPrefixes:"project",browserTitle:"\u9879\u76EE - ApiCat"},redirect:{name:"projects.index"}};var ji=H(D({},ss),{component:Ni,children:Pi});const $u=e=>C.get("/iterations",{params:e}),Si=e=>C.get("/iteration",{params:e}),Mu=e=>C.post("/iteration/create",e),Bu=e=>C.post("/iteration/edit",e),Fu=e=>C.post("/iteration/remove",e),Ri=()=>C.get("/iteration/stars"),xi=e=>C.post("/iteration/star_order",e),Ti=e=>C.post("/iteration/star",e),Li=e=>C.post("/iteration/unstar",e),Ku=e=>C.post("/iteration/push",e),Vu=e=>ae(zo)({iterate_id:e}),Oi=(e,t)=>ae(Yo)({iterate_id:e,node_id:t});ae(Jo);const we=Me({id:"iterations",state:()=>({activeTab:void 0,collection:[],iterateInfo:null,isIterateRoute:!1}),getters:{isActiveIterateList:e=>e.activeTab===""},actions:{async getIterateInfo(e){if(this.iterateInfo&&this.iterateInfo.id===e)return this.iterateInfo;const{data:t}=await Si({iteration_id:e});return this.iterateInfo=t,this.iterateInfo},switchActiveCollectTab(e){const t=this.collection.find(s=>s.project_id===e);this.activeTab=t?e:""},async getIterateCollectionList(){try{const{data:e}=await Ri();this.collection=e||[],this.switchActiveCollectTab(this.collection.length?this.collection[0].project_id:"")}catch{}},async addProjectToCollect(e){const{project_id:t,project_title:s}=e;await Ti({project_id:t}),fe.success("\u6536\u85CF\u6210\u529F"),!this.collection.find(n=>n.project_id===t)&&this.collection.push({project_id:t,project_name:s})},async removeProjectFromCollect(e){const{project_id:t}=e;await Li({project_id:t}),fe.success("\u53D6\u6D88\u6536\u85CF\u6210\u529F"),this.collection=this.collection.filter(s=>s.project_id!==t)},async sortCollectionList(e,t){const s=this.collection.splice(e,1)[0];this.collection.splice(t,0,s),await xi({project_ids:this.collection.map(o=>o.project_id)})}}});const ns=e=>(Xe("data-v-615cfc29"),e=e(),Qe(),e),$i={class:"flex flex-col border divide-y bg-white"},Mi=ns(()=>a("span",{class:"ml-1"},"\u8FED\u4EE3\u5217\u8868",-1)),Bi=[Mi],Fi={class:"overflow-y-scroll mt-2 collection_list"},Ki=["onClick"],Vi={class:"overflow-hidden flex items-center flex-1 h-12 pl-6"},Ui=["title"],Gi={key:0,class:"relative flex pr-4 items-center justify-between text-neutral-600 hover:text-neutral-900"},zi=ns(()=>a("section",{class:"overflow-hidden flex items-center flex-1 h-12 pl-6"},[a("span",{class:"ml-1",title:"ApiCat"},"\u6682\u65E0\u6536\u85CF")],-1)),Hi=[zi],Ji=ee({setup(e){const t=N(),s=we(),{activeTab:o,collection:n}=ne(s),[i,r]=Wo(s.getIterateCollectionList),c=f=>[{active:o.value===f.project_id}],l=f=>{s.switchActiveCollectTab(f.project_id)},{initSortable:_}=ts(t,{draggable:".collection_item",onEnd(f){const{oldIndex:u,newIndex:y}=f;s.sortCollectionList(u,y)}});return et(async()=>{await r(),_()}),No(()=>{s.$patch({activeTab:void 0})}),(f,u)=>{const y=nt;return d(),B(eo,null,{default:m(()=>[a("div",$i,[a("a",{class:M(["relative h-12 pl-6 flex items-center text-neutral-600 hover:text-neutral-900",c({project_id:""})]),href:"javascript:void(0);",onClick:u[0]||(u[0]=E=>l({}))},Bi,2)]),te((d(),g("div",Fi,[a("div",{class:"flex flex-col border divide-y bg-white",ref_key:"sortableEle",ref:t},[(d(!0),g(U,null,ie(v(n),E=>(d(),g("a",{key:E.project_id,class:M(["relative flex pr-4 items-center justify-between text-neutral-600 hover:text-neutral-900 collection_item",c(E)]),href:"javascript:void(0);",onClick:p=>l(E)},[a("section",Vi,[a("span",{class:"ml-1 truncate",title:E.project_name},$(E.project_name),9,Ui)])],10,Ki))),128)),v(n).length?T("",!0):(d(),g("a",Gi,Hi))],512)])),[[y,v(i)]])]),_:1})}}});var Yi=Z(Ji,[["__scopeId","data-v-615cfc29"]]);const Wi=()=>W(()=>import("./IterateListContainer.415869c3.js"),["assets/IterateListContainer.415869c3.js","assets/IterateListContainer.6f16337e.css","assets/element-plus.aa12b6bd.js","assets/element-plus.8e6ef202.css","assets/vendor.b7ec7f69.js","assets/useTable.c5e7e86a.js","assets/usePage.c385c079.js"]),qi={path:"",name:"iterations.index",meta:{title:"\u8FED\u4EE3"},component:Wi},Zi=[qi],is={path:"/iterations",name:"iterations",meta:{title:"\u8FED\u4EE3",activeClassPrefixes:"iterations",browserTitle:"\u8FED\u4EE3 - ApiCat"},redirect:{name:"iterations.index"}};var Xi=H(D({},is),{component:Yi,children:Zi});const Qi=()=>W(()=>import("./MemberList.af797ec1.js"),["assets/MemberList.af797ec1.js","assets/element-plus.aa12b6bd.js","assets/element-plus.8e6ef202.css","assets/vendor.b7ec7f69.js","assets/usePage.c385c079.js"]),rs={path:"/members",name:"members",meta:{title:"\u6210\u5458"}};var er=H(D({},rs),{component:Qi});const tr={class:"h-14"},or={class:"fixed top-0 z-50 w-full bg-white shadow"},sr={class:"relative flex items-center justify-between viewport h-14"},nr={class:"flex items-center flex-1"},ir=a("img",{class:"w-auto h-10",src:rt,alt:"ApiCat"},null,-1),rr=a("span",{class:"logo-text logo-apicat"},"ApiCat",-1),ar={class:"ml-6"},cr=["onClick"],lr={class:"flex items-center"},dr={class:"relative ml-3"},ur={class:"el-dropdown-link"},pr={type:"button",class:"flex items-center rounded-full","aria-expanded":"false","aria-haspopup":"true"},hr=["src"],fr={key:1},_r={class:"flex flex-col justify-center text-sm divide-y"},mr={class:"px-6 py-2"},gr=["title"],vr=["title"],yr={class:"ml-1"},Er=a("i",{class:"iconfont iconIconPopoverExit"},null,-1),Cr=a("span",{class:"ml-1"},"\u9000\u51FA\u767B\u5F55",-1),kr=[Er,Cr],Ar={class:"px-8 py-4 viewport"},Ir=ee({setup(e){const t={modifiers:[{name:"offset",options:{offset:[-24,10]}}]},s=N([{name:"user.profile",title:"\u4E2A\u4EBA\u4FE1\u606F",icon:"iconIconPopoverUser"}]),o=[ss,is,rs],n=be(),{currentRoute:i}=tt(),{userInfo:r,lastName:c}=ne(n),l=async()=>{await n.logout()},_=f=>{const u=(i.value.name||"").startsWith(f.meta.activeClassPrefixes||f.name);return["px-3 cursor-pointer",{"text-blue-600":u}]};return et(async()=>{await n.getUserInfo()}),(f,u)=>{const y=Q("router-link"),E=un,p=Be,k=pn,A=hn,j=Q("router-view");return d(),g(U,null,[a("header",tr,[a("div",or,[a("div",sr,[a("div",nr,[h(y,{class:"inline-flex items-center",to:v(it)},{default:m(()=>[ir,rr]),_:1},8,["to"]),a("div",ar,[(d(),g(U,null,ie(o,P=>h(y,{to:{name:P.name},key:P.name,custom:""},{default:m(({navigate:R})=>[a("span",{class:M(_(P)),onClick:R},$(P.meta.title),11,cr)]),_:2},1032,["to"])),64))])]),a("div",lr,[a("div",dr,[h(A,{placement:"bottom-end",trigger:"click","popper-class":"nav-dropdown","popper-options":t},{dropdown:m(()=>[h(k,null,{default:m(()=>[a("div",_r,[a("div",mr,[a("p",{class:"text-base font-bold text-gray-600 truncate",title:v(r).name},$(v(r).name),9,gr),a("p",{class:"text-gray-500 truncate",title:v(r).email},$(v(r).email),9,vr)]),(d(!0),g(U,null,ie(s.value,P=>(d(),B(y,{key:P.name,class:"flex items-center px-6 py-3 hover:text-gray-700",to:{name:P.name}},{default:m(()=>[a("i",{class:M("iconfont "+P.icon)},null,2),a("span",yr,$(P.title),1)]),_:2},1032,["to"]))),128)),a("a",{class:"flex items-center px-6 py-3 hover:text-gray-700",href:"javascript:void(0)",onClick:l},kr)])]),_:1})]),default:m(()=>[a("span",ur,[a("button",pr,[h(E,null,{default:m(()=>[v(r).avatar?(d(),g("img",{key:0,src:v(r).avatar},null,8,hr)):(d(),g("span",fr,$(v(c)),1))]),_:1}),h(p,{class:"el-icon--right"},{default:m(()=>[h(v(fn))]),_:1})])])]),_:1})])])])])]),a("main",Ar,[h(j)])],64)}}});const ve=e=>(Xe("data-v-47f509cc"),e=e(),Qe(),e),br={class:"h-14"},Nr={class:"shadow bg-white fixed top-0 w-full z-50"},wr={class:"viewport relative items-center justify-between h-14 lg:flex hidden"},Dr={class:"flex-1 flex items-center"},Pr=ve(()=>a("div",{class:"flex-shrink-0 flex"},[a("a",{class:"inline-flex items-center",href:"/"},[a("img",{class:"h-10 w-auto",src:rt,alt:"ApiCat"}),a("span",{class:"logo-text logo-apicat"},"ApiCat")])],-1)),jr={key:0,class:"ml-6 hidden lg:block"},Sr=ve(()=>a("div",{class:"flex text-gray-600"},[a("a",{href:"https://apicat.net",target:"_blank",class:"px-3 py-2 rounded-md text-sm"},"\u9996\u9875"),a("a",{href:"https://apicat.net/app/31eb8ec8c295c8c4130ee50304d55ab5",target:"_blank",class:"px-3 py-2 rounded-md text-sm"},"\u6587\u6863"),a("a",{href:"https://github.com/NatosoftCN/ApiCat_Open",target:"_blank",class:"px-3 py-2 rounded-md text-sm"},"Github")],-1)),Rr=[Sr],xr={key:0},Tr=Y("\u767B\u5F55"),Lr=Y("\u6CE8\u518C"),Or={class:"lg:hidden"},$r={class:"flex items-center justify-between h-14 px-4 relative"},Mr=ve(()=>a("img",{class:"h-10 w-auto",src:rt,alt:"ApiCat"},null,-1)),Br=ve(()=>a("span",{class:"logo-text logo-apicat"},"ApiCat",-1)),Fr=ve(()=>a("svg",{viewBox:"0 0 24 24",width:"1em",height:"1em",style:{"font-size":"24px"},fill:"currentColor"},[a("path",{d:"M21 7H3V5H21V7Z","fill-rule":"evenodd","clip-rule":"evenodd",fill:"currentColor"}),a("path",{d:"M21 13H3V11H21V13Z","fill-rule":"evenodd","clip-rule":"evenodd",fill:"currentColor"}),a("path",{d:"M21 19H3V17H21V19Z","fill-rule":"evenodd","clip-rule":"evenodd",fill:"currentColor"})],-1)),Kr=[Fr],Vr={key:0,class:"bg-white fixed top-0 left-0 w-full max-h-screen flex flex-col z-10"},Ur={class:"flex items-center justify-between h-14 px-4"},Gr=ve(()=>a("img",{class:"h-10 w-auto",src:rt,alt:"ApiCat"},null,-1)),zr=ve(()=>a("span",{class:"logo-text logo-apicat"},"ApiCat",-1)),Hr=ve(()=>a("svg",{viewBox:"0 0 24 24",width:"1em",height:"1em",style:{"font-size":"24px"},fill:"currentColor"},[a("path",{d:"M12.0001 13.4141L17.6568 19.0708L19.0711 17.6566L13.4143 11.9998L19.0711 6.34304L17.6569 4.92883L12.0001 10.5856L6.34314 4.92871L4.92893 6.34292L10.5859 11.9998L4.92896 17.6567L6.34317 19.071L12.0001 13.4141Z","fill-rule":"evenodd","clip-rule":"evenodd",fill:"currentColor"})],-1)),Jr=[Hr],Yr={class:"flex-1 overflow-y-auto"},Wr=ve(()=>a("div",{class:"px-4 text-base font-medium"},[a("a",{class:"px-3 py-2 mb-1 rounded-lg block",href:"/"},"\u9996\u9875"),a("a",{class:"px-3 py-2 mb-1 rounded-lg block",href:"#"},"\u6587\u6863"),a("a",{class:"px-3 py-2 mb-1 rounded-lg block",href:"#"},"GitHub")],-1)),qr={class:"px-5"},Zr=Y("\u767B\u5F55"),Xr=Y("\u6CE8\u518C"),Qr=ee({props:{isShowNav:{type:Boolean,default:!0}},setup(e){const t=N(!1);return he(t,()=>{document.body.classList.toggle("overflow-hidden")}),(s,o)=>{const n=st,i=Q("router-link");return d(),g("header",br,[a("div",Nr,[a("div",wr,[a("div",Dr,[Pr,e.isShowNav?(d(),g("div",jr,Rr)):T("",!0)]),e.isShowNav?(d(),g("div",xr,[h(i,{to:v(qe),class:"mr-4"},{default:m(()=>[h(n,null,{default:m(()=>[Tr]),_:1})]),_:1},8,["to"]),h(i,{to:v(Wt)},{default:m(()=>[h(n,{type:"primary"},{default:m(()=>[Lr]),_:1})]),_:1},8,["to"])])):T("",!0)]),a("div",Or,[a("div",$r,[h(i,{class:"inline-flex items-center",to:"/"},{default:m(()=>[Mr,Br]),_:1}),a("div",{class:"cursor-pointer",onClick:o[0]||(o[0]=r=>t.value=!t.value)},Kr),h(Os,{name:"slide-fade"},{default:m(()=>[t.value?(d(),g("div",Vr,[a("div",Ur,[h(i,{class:"inline-flex items-center",to:"/"},{default:m(()=>[Gr,zr]),_:1}),a("div",{class:"cursor-pointer",onClick:o[1]||(o[1]=r=>t.value=!t.value)},Jr)]),a("div",Yr,[Wr,a("div",qr,[h(i,{to:"/login"},{default:m(()=>[h(n,{class:"w-full"},{default:m(()=>[Zr]),_:1})]),_:1}),h(i,{to:"/"},{default:m(()=>[h(n,{type:"primary",class:"w-full my-5"},{default:m(()=>[Xr]),_:1})]),_:1})])])])):T("",!0)]),_:1}),t.value?(d(),g("div",{key:0,class:"fixed top-0 left-0 w-screen h-screen bg-opacity-40 bg-gray-900",onClick:o[2]||(o[2]=r=>t.value=!t.value)})):T("",!0)])])])])}}});var ea=Z(Qr,[["__scopeId","data-v-47f509cc"]]);const as=ee({setup(e){const t=N(!0);return ue("switchNavState",o=>{t.value=o}),(o,n)=>{const i=Q("router-view");return d(),g(U,null,[h(ea,{"is-show-nav":t.value},null,8,["is-show-nav"]),h(i)],64)}}}),ta=()=>W(()=>import("./Index.5b94cc10.js"),["assets/Index.5b94cc10.js","assets/Index.46d30f47.css","assets/vendor.b7ec7f69.js"]),oa=()=>W(()=>import("./Login.f789f568.js"),["assets/Login.f789f568.js","assets/element-plus.aa12b6bd.js","assets/element-plus.8e6ef202.css","assets/vendor.b7ec7f69.js"]),sa=()=>W(()=>import("./Register.9ec299ec.js"),["assets/Register.9ec299ec.js","assets/element-plus.aa12b6bd.js","assets/element-plus.8e6ef202.css","assets/vendor.b7ec7f69.js"]),na=()=>W(()=>import("./NotFound.7686d0e3.js"),["assets/NotFound.7686d0e3.js","assets/NotFound.3339f423.css","assets/vendor.b7ec7f69.js","assets/element-plus.aa12b6bd.js","assets/element-plus.8e6ef202.css"]),ia={path:Mo,name:"index",component:as,meta:{ignoreAuth:!0},children:[{path:"",name:"index.feature",component:ta}]},ra={path:qe,name:"login",meta:{ignoreAuth:!0},component:oa},aa={path:Wt,name:"register",meta:{ignoreAuth:!0},component:sa},ca={path:"/:path(.*)*",name:"error",component:as,meta:{ignoreAuth:!0},children:[{path:"/:path(.*)*",name:"error.not.found",component:na}]},la=ee({setup(e){const t=N(cs);return(s,o)=>(d(),B(eo,{menus:t.value},null,8,["menus"]))}}),da=()=>W(()=>import("./UserProfile.31576b19.js"),["assets/UserProfile.31576b19.js","assets/ImagePreview.e3b8fddd.js","assets/ImagePreview.e9afec23.css","assets/element-plus.aa12b6bd.js","assets/element-plus.8e6ef202.css","assets/vendor.b7ec7f69.js"]),ua=()=>W(()=>import("./ModifyPassword.cfcd5b58.js"),["assets/ModifyPassword.cfcd5b58.js","assets/element-plus.aa12b6bd.js","assets/element-plus.8e6ef202.css","assets/vendor.b7ec7f69.js"]),cs=[{path:"profile",name:"user.profile",meta:{title:"\u4E2A\u4EBA\u4FE1\u606F"},component:da},{path:"password",name:"user.password",meta:{title:"\u4FEE\u6539\u5BC6\u7801"},component:ua}];var pa={path:"/user",name:"user",redirect:{name:"user.profile"},component:la,children:cs};const ha=()=>W(()=>import("./ProjectNav.ff7354ba.js"),["assets/ProjectNav.ff7354ba.js","assets/vendor.b7ec7f69.js","assets/element-plus.aa12b6bd.js","assets/element-plus.8e6ef202.css"]),fa=()=>W(()=>import("./ProjectSetting.7c4e9102.js"),["assets/ProjectSetting.7c4e9102.js","assets/ImagePreview.e3b8fddd.js","assets/ImagePreview.e9afec23.css","assets/element-plus.aa12b6bd.js","assets/element-plus.8e6ef202.css","assets/vendor.b7ec7f69.js"]),_a=()=>W(()=>import("./ProjectMembers.31ed8502.js"),["assets/ProjectMembers.31ed8502.js","assets/element-plus.aa12b6bd.js","assets/element-plus.8e6ef202.css","assets/vendor.b7ec7f69.js","assets/useTable.c5e7e86a.js","assets/usePage.c385c079.js"]),ma=()=>W(()=>import("./ProjectParam.31e600bd.js"),["assets/ProjectParam.31e600bd.js","assets/element-plus.aa12b6bd.js","assets/element-plus.8e6ef202.css","assets/vendor.b7ec7f69.js","assets/params.b7b3bcd7.js"]),ga=()=>W(()=>import("./ProjectTrash.3757afca.js"),["assets/ProjectTrash.3757afca.js","assets/element-plus.aa12b6bd.js","assets/element-plus.8e6ef202.css","assets/vendor.b7ec7f69.js"]),ls=[{path:Fo,name:"project.setting",component:fa,meta:{title:"\u9879\u76EE\u8BBE\u7F6E",role:[J.MANAGER]}},{path:Ko,name:"project.members",component:_a,meta:{title:"\u9879\u76EE\u6210\u5458",role:[J.MANAGER,J.DEVELOPER,J.READER]}},{path:Vo,name:"project.params",component:ma,meta:{title:"\u516C\u5171\u53C2\u6570",role:[J.MANAGER,J.DEVELOPER]}},{path:Uo,name:"project.trash",component:ga,meta:{title:"\u56DE\u6536\u7AD9",role:[J.MANAGER,J.DEVELOPER]}}],yo=$s(ls);var va={path:"/project/:project_id",name:"project",component:ha,children:ls};const ya={data(){return{isShow:!1,isLoading:!1,isPoll:!1,title:"\u5BFC\u51FA\u9879\u76EE",params:{},exportList:[],jobParams:{id:null},currentConfig:null,timer:null}},watch:{isShow:function(){this.isShow||(this.clearTimer(),this.isLoading=!1)}},methods:{hide(){this.isShow=!1},show(e,t){this.clearTimer(),this.isShow=!0,this.exportList=t||[],this.params=e||{}},onItemClick(e){this.currentConfig=e||null,this.getImportJobId(this.buildParams(e))},getImportJobId(e){if(this.jobParams.id=null,!this.currentConfig||!this.currentConfig.action)return this.isLoading=!1,Promise.resolve();this.currentConfig.action(e).then(t=>{this.jobParams.id=t.data||null,this.isPoll=!0,this.getExecResult()}).catch(()=>{this.isLoading=!1})},clearTimer(){this.isLoading=!1,this.isPoll=!1},async exec(){if(!this.currentConfig||!this.currentConfig.getJobResult)return this.clearTimer(),Promise.resolve();this.isLoading=!0;try{const{data:e}=await this.currentConfig.getJobResult(this.params.project_id,this.jobParams.id);let t=e.description||"";if(e.result===Ve.FAIL&&this.isShow){this.isLoading=!1,this.$Message.error(t||"\u5BFC\u51FA\u5931\u8D25\uFF01"),this.clearTimer();return}if(e.result===Ve.WAIT&&this.isShow)return;e.result===Ve.FINISH&&this.isShow&&(this.$Message.success(t||"\u5BFC\u51FA\u5B8C\u6210\uFF01"),this.isLoading=!1,this.clearTimer(),this.hide(),e.url&&Ms(e.url))}catch{this.clearTimer()}},async getExecResult(){for(;this.isPoll;)await this.exec(this.params),await wo(2e3)},buildParams(e){return this.params.type=e.type,this.params}},unmounted(){this.clearTimer()}},Ea={class:"ac-project-export","element-loading-text":"\u5BFC\u5165\u4E2D\uFF0C\u8BF7\u52FF\u5173\u95ED\u7A97\u53E3\uFF01"},Ca=["onClick"],ka=["src","alt"],Aa={class:"mt-1.5"};function Ia(e,t,s,o,n,i){const r=ot,c=nt;return d(),B(r,{modelValue:n.isShow,"onUpdate:modelValue":t[0]||(t[0]=l=>n.isShow=l),width:"fit-content","close-on-click-modal":!1,"append-to-body":"",title:n.title},{default:m(()=>[te((d(),g("div",Ea,[(d(!0),g(U,null,ie(n.exportList,l=>(d(),g("div",{class:"ac-project-export-item",key:l.type},[a("div",{class:"ac-project-export-inner",onClick:_=>i.onItemClick(l)},[a("img",{src:l.icon,alt:l.text},null,8,ka),a("p",Aa,$(l.text),1)],8,Ca)]))),128))])),[[c,n.isLoading]])]),_:1},8,["modelValue","title"])}var ba=Z(ya,[["render",Ia],["__scopeId","data-v-159cc67b"]]),ds="/assets/logo-apicat@2x.ca5d403d.png",Na="/assets/logo-markdown@2x.084fed6d.png",us="/assets/logo-postman@2x.3bda39f9.png";const Uu=e=>C.get("/api_url/list",{params:{project_id:e}}),Gu=(e,t)=>C.post("/api_url/remove",{project_id:e,url_id:t}),zu=(e,t="json")=>{const{project_id:s,doc_id:o}=e||{},n=S.get(S.KEYS.SECRET_PROJECT_TOKEN+s||"",!0);return C.get("/api_doc",{params:{project_id:s,doc_id:o,format:t,token:n}})},wa=(e,t)=>{const s=S.get(S.KEYS.SECRET_PROJECT_TOKEN+e.project_id||"",!0);return C.get("/api_doc/search",{params:H(D({},e||{}),{keywords:t,token:s})})},Da=(e={})=>C.post("/api_doc/create",D({},e)),Pa=(e={})=>C.post("/api_doc/http_template",D({},e)),Hu=(e={})=>(typeof e.content=="object"&&(e.content=JSON.stringify(e.content)),C.post("/api_doc/update",e)),ja=(e={})=>C.post("/api_doc/copy",e),Sa=(e={})=>C.post("/api_doc/rename",e),Ra=(e={})=>C.post("/api_doc/remove",e),xa=(e={})=>C.post("/api_doc/share",D({},e)),Ta=(e={})=>C.post("/api_doc/share_detail",D({},e)),La=(e={})=>C.post("/api_doc/share_secretkey",D({},e)),wt=e=>C.post("/api_doc/import",e),Dt=(e,t)=>C.get("/api_doc/import_result",{params:{project_id:e,job_id:t}}),Oa=[{text:"ApiCat",icon:ds,type:"apicat",action:wt,getJobResult:Dt,maxSize:2,accept:".json"},{text:"Markdown",icon:Na,type:"markdown",action:wt,getJobResult:Dt,maxSize:.5,accept:".md"},{text:"Postman(v2.1)",icon:us,type:"postman",action:wt,getJobResult:Dt,maxSize:2,accept:".json"}],ps=(e,t)=>ae(Qt)({project_id:e,node_id:t}),$a=(e,t,s)=>Fe(s)+ps(e,t),re=Me({id:"project",state:()=>({projectInfo:null,projectAuthInfo:{}}),getters:{isManager:e=>e.projectAuthInfo&&e.projectAuthInfo.authority===J.MANAGER,isDeveloper:e=>e.projectAuthInfo&&e.projectAuthInfo.authority===J.DEVELOPER,isReader:e=>e.projectAuthInfo&&e.projectAuthInfo.authority===J.READER,isGuest:e=>e.projectAuthInfo&&e.projectAuthInfo.authority===J.NONE,isPrivate:e=>e.projectAuthInfo&&e.projectAuthInfo.visibility===ke.PRIVATE},actions:{async getProjectDetail(e){var o;const t=S.get(S.KEYS.SECRET_PROJECT_TOKEN+e||"",!0),{data:s}=await ii(e,t);return this.projectInfo=H(D({},s||{}),{visible:(o=bt.find(n=>n.key===s.visibility))==null?void 0:o.value}),this.projectInfo},async getProjectDetailById(e={project_id:null,iteration_id:null}){var s;const{data:t}=await ri(e);return this.projectInfo=H(D({},t||{}),{visible:(s=bt.find(o=>o.key===t.visibility))==null?void 0:s.value}),this.projectInfo},async getProjectAuth(e){const{data:t}=await ai(e);return this.projectAuthInfo=t||{},this.projectAuthInfo.id=e,this.projectAuthInfo.in_this=this.projectAuthInfo.authority!==J.NONE,this.projectAuthInfo},async updateProjectInfo(e){var s;const t=await Zn(e);return this.projectInfo=H(D(D({},this.projectInfo),e),{visibility:(s=bt.find(o=>o.value===e.visible))==null?void 0:s.key}),this.projectAuthInfo.visibility=this.projectInfo.visibility,t},clearProjectInfo(){this.projectInfo=null}}}),Ju=e=>C.post("/api_doc/secretkey_check",e),Ma=e=>C.get("/api_doc/has_shared",{params:{doc_id:e}}),Ba=(e,t)=>C.get("/api_doc",{params:{doc_id:e,token:t,format:"html"}}),Yu=(e,t)=>C.get("/api_doc",{params:{project_id:e,doc_id:t,deleted:1,format:"html"}}),Fa=e=>C.get("/preview/project",{params:{project_id:e}}),Wu=e=>C.post("/project/secretkey_check",e),Ka=(e,t,s)=>C.get("/preview/search",{params:{project_id:t,keywords:s,token:e}}),Eo=(e,t)=>Fe(t)+ae(Rn)({doc_id:e}),Va={watch:{shareData(){this.shareData.docId!==-1&&this.getShareDetail()}},setup(){const e=re(),{projectInfo:t}=ne(e),s=Bt({projectInfo:t,document:null,isShow:!1,isShowDetail:!1,isLoading:!1,isLoadingResetPwd:!1,shareUrl:"",isShare:!1,password:"",copyText:"",copyTextEl:N(),shareData:{docId:-1}});return D({},Ft(s))},methods:{onShareStatusSwitch(e){this.document!==null&&(this.isLoading=!0,xa({project_id:this.projectInfo.id,doc_id:this.shareData.docId,share:e}).then(({data:t})=>{e?(this.updateLinkAndPassword(Eo(this.shareData.docId),t.secret_key),this.document.secret_key=t.secret_key):(this.document.secret_key="",this.isShare=!1)}).catch(t=>{console.log(t),this.isShare=!this.isShare}).finally(()=>{this.isLoading=!1}))},copy(){this.copyTextEl.select(),document.execCommand("copy")&&(this.copyText="\u590D\u5236\u6210\u529F",setTimeout(()=>{this.copyText=this.document.visibility===Nt.PUBLIC?"\u590D\u5236\u94FE\u63A5":"\u590D\u5236\u94FE\u63A5\u548C\u5BC6\u7801"},2e3))},show(e){this.shareData=e||{docId:-1},this.isShow=!0},setDocument(e={}){this.document=e;const t=e.visibility===Nt.PUBLIC;return this.copyText=t?"\u590D\u5236\u94FE\u63A5":"\u590D\u5236\u94FE\u63A5\u548C\u5BC6\u7801",this.isShare=!t&&!!e.secret_key,e.link=t?$a(this.projectInfo.id,this.shareData.docId):this.isShare?Eo(this.shareData.docId):"",this.updateLinkAndPassword(e.link,e.secret_key),this},updateLinkAndPassword(e,t){this.shareUrl=e||this.shareUrl,this.password=t||this.password,this.updateCopyText()},onResetPasswordBtnClick(){this.isLoadingResetPwd=!0,La({project_id:this.projectInfo.id,doc_id:this.shareData.docId}).then(({data:e})=>this.updateLinkAndPassword(null,e)).finally(()=>{this.isLoadingResetPwd=!1})},updateCopyText(){this.copyTextEl.value=this.document.visibility===Nt.PUBLIC?this.shareUrl:[`\u94FE\u63A5\uFF1A${this.shareUrl}`,`\u5BC6\u7801\uFF1A${this.password}`].join(`
`)},getShareDetail(){this.isShowDetail=!0,Ta({project_id:this.projectInfo.id,doc_id:this.shareData.docId}).then(({data:e})=>{this.setDocument(e)}).finally(()=>{this.isShowDetail=!1})}}},Ua={class:"-m-4"},Ga={key:0},za={key:1},Ha=a("div",{class:"flex-1"},[a("h4",null,"\u5F00\u542F\u5206\u4EAB"),a("div",{class:"ivu-list-item-meta-description"},"\u5F00\u542F\u5206\u4EAB\u540E\uFF0C\u83B7\u5F97\u94FE\u63A5\u7684\u4EBA\u53EF\u4EE5\u8BBF\u95EE\u9879\u76EE\u5185\u5BB9\u3002")],-1),Ja=Y("\u91CD\u7F6E\u5BC6\u7801"),Ya={ref:"copyTextEl",style:{position:"fixed",left:"-9999px"}};function Wa(e,t,s,o,n,i){const r=st,c=yt,l=Gt,_=zt,f=To,u=Lo,y=ot,E=nt;return d(),B(y,{modelValue:e.isShow,"onUpdate:modelValue":t[4]||(t[4]=p=>e.isShow=p),title:"\u5206\u4EAB\u6587\u6863",class:"vertical-center-modal",width:540,"append-to-body":""},{default:m(()=>[te((d(),g("div",Ua,[e.document&&e.document.visibility===1?(d(),g("div",Ga,[h(_,{"label-position":"top",class:"px-6 py-3"},{default:m(()=>[h(l,{label:""},{default:m(()=>[h(c,{readonly:"",modelValue:e.shareUrl,"onUpdate:modelValue":t[0]||(t[0]=p=>e.shareUrl=p)},{append:m(()=>[h(r,{type:"primary",onClick:i.copy},{default:m(()=>[Y($(e.copyText),1)]),_:1},8,["onClick"])]),_:1},8,["modelValue"])]),_:1})]),_:1})])):T("",!0),e.document&&e.document.visibility===0?(d(),g("div",za,[a("div",{class:M(["flex items-center px-6",{"py-3":!e.isShare,"pt-3":e.isShare}])},[Ha,h(f,{loading:e.isLoading,modelValue:e.isShare,"onUpdate:modelValue":t[1]||(t[1]=p=>e.isShare=p),onChange:i.onShareStatusSwitch,"inline-prompt":"","active-text":"\u5F00","inactive-text":"\u5173"},null,8,["loading","modelValue","onChange"])],2),e.isShare?(d(),B(u,{key:0})):T("",!0),e.isShare?(d(),B(_,{key:1,"label-position":"top",class:"px-6"},{default:m(()=>[h(l,{label:"\u6587\u6863\u94FE\u63A5"},{default:m(()=>[h(c,{readonly:"",modelValue:e.shareUrl,"onUpdate:modelValue":t[2]||(t[2]=p=>e.shareUrl=p)},{append:m(()=>[h(r,{type:"primary",onClick:i.copy},{default:m(()=>[Y($(e.copyText),1)]),_:1},8,["onClick"])]),_:1},8,["modelValue"])]),_:1}),h(l,{label:"\u5BC6\u7801"},{default:m(()=>[h(l,{prop:"date",class:"mr-1"},{default:m(()=>[h(c,{readonly:"",modelValue:e.password,"onUpdate:modelValue":t[3]||(t[3]=p=>e.password=p)},null,8,["modelValue"])]),_:1}),h(r,{loading:e.isLoadingResetPwd,onClick:i.onResetPasswordBtnClick},{default:m(()=>[Ja]),_:1},8,["loading","onClick"])]),_:1})]),_:1})):T("",!0)])):T("",!0)])),[[E,e.isShowDetail]]),a("textarea",Ya,null,512)]),_:1},8,["modelValue"])}var qa=Z(Va,[["render",Wa]]);const Za={setup(){const e=Bt({project:null,dom:null,isShow:!1,isLoading:!1,isLoadingResetPwd:!1,shareUrl:"",isShare:!1,password:"",copyText:"",copyTextEl:N()});return D({PROJECT_VISIBLE_TYPES:ke},Ft(e))},methods:{onShareStatusSwitch(e){this.project!==null&&(this.isLoading=!0,Xn(this.project.id,Number(e)).then(({msg:t,data:s})=>{s=s||{},this.$Message.success(t||"\u64CD\u4F5C\u6210\u529F"),this.updateLinkAndPassword(go(this.project.id),s.secret_key),e?this.project.secret_key=s.secret_key:delete this.project.secret_key}).catch(t=>{this.isShare=!this.isShare}).finally(()=>{this.isLoading=!1}))},copy(){this.copyTextEl.select(),document.execCommand("copy")&&(this.copyText="\u590D\u5236\u6210\u529F",setTimeout(()=>{this.copyText=this.project.visibility===ke.PUBLIC?"\u590D\u5236\u94FE\u63A5":"\u590D\u5236\u94FE\u63A5\u548C\u5BC6\u7801"},2e3))},show(e={}){this.isShow=!0,this.project=e,this.copyText=e.visibility===ke.PUBLIC?"\u590D\u5236\u94FE\u63A5":"\u590D\u5236\u94FE\u63A5\u548C\u5BC6\u7801",e.visibility===ke.PRIVATE&&e.secret_key?this.isShare=!0:this.isShare=!1,this.updateLinkAndPassword(go(e.id),e.secret_key)},updateLinkAndPassword(e,t){this.shareUrl=e||this.shareUrl,this.password=t||this.password,this.updateCopyText()},onResetPasswordBtnClick(){this.isLoadingResetPwd=!0,Qn(this.project.id).then(({data:e})=>{this.project.secret_key=e,this.updateLinkAndPassword(null,e)}).finally(()=>{this.isLoadingResetPwd=!1})},updateCopyText(){var e=[this.project.name?`\u300A${this.project.name}\u300B`:"",`\u94FE\u63A5\uFF1A${this.shareUrl}`];this.project.visibility!==ke.PUBLIC&&e.push(`\u5BC6\u7801\uFF1A${this.password}`),this.$nextTick(()=>{this.copyTextEl.value=e.join(`
`)})}}},Xa={key:0,class:"-m-4"},Qa={key:1,class:"-m-4"},ec=a("div",{class:"flex-1"},[a("h4",null,"\u5F00\u542F\u5206\u4EAB"),a("div",{class:"ivu-list-item-meta-description"},"\u5F00\u542F\u5206\u4EAB\u540E\uFF0C\u83B7\u5F97\u94FE\u63A5\u7684\u4EBA\u53EF\u4EE5\u8BBF\u95EE\u9879\u76EE\u5185\u5BB9\u3002")],-1),tc=Y("\u91CD\u7F6E\u5BC6\u7801"),oc={ref:"copyTextEl",style:{position:"fixed",left:"-9999px"}};function sc(e,t,s,o,n,i){const r=st,c=yt,l=Gt,_=zt,f=To,u=Lo,y=ot;return d(),B(y,{modelValue:e.isShow,"onUpdate:modelValue":t[4]||(t[4]=E=>e.isShow=E),width:540,"close-on-click-modal":!1,title:"\u5206\u4EAB\u9879\u76EE","append-to-body":""},{default:m(()=>[e.project&&e.project.visibility===o.PROJECT_VISIBLE_TYPES.PUBLIC?(d(),g("div",Xa,[h(_,{"label-position":"top",class:"px-6 py-3"},{default:m(()=>[h(l,{label:""},{default:m(()=>[h(c,{readonly:"",modelValue:e.shareUrl,"onUpdate:modelValue":t[0]||(t[0]=E=>e.shareUrl=E)},{append:m(()=>[h(r,{type:"primary",onClick:i.copy},{default:m(()=>[Y($(e.copyText),1)]),_:1},8,["onClick"])]),_:1},8,["modelValue"])]),_:1})]),_:1})])):T("",!0),e.project&&e.project.visibility===o.PROJECT_VISIBLE_TYPES.PRIVATE?(d(),g("div",Qa,[a("div",{class:M(["px-6 flex items-center",{"py-3":!e.isShare,"pt-3":e.isShare}])},[ec,h(f,{loading:e.isLoading,modelValue:e.isShare,"onUpdate:modelValue":t[1]||(t[1]=E=>e.isShare=E),onChange:i.onShareStatusSwitch,"inline-prompt":"","active-text":"\u5F00","inactive-text":"\u5173"},null,8,["loading","modelValue","onChange"])],2),e.isShare?(d(),B(u,{key:0})):T("",!0),e.isShare?(d(),B(_,{key:1,"label-position":"top",class:"px-6"},{default:m(()=>[h(l,{label:"\u9879\u76EE\u94FE\u63A5"},{default:m(()=>[h(c,{readonly:"",modelValue:e.shareUrl,"onUpdate:modelValue":t[2]||(t[2]=E=>e.shareUrl=E)},{append:m(()=>[h(r,{type:"primary",onClick:i.copy},{default:m(()=>[Y($(e.copyText),1)]),_:1},8,["onClick"])]),_:1},8,["modelValue"])]),_:1}),h(l,{label:"\u5BC6\u7801"},{default:m(()=>[h(l,{prop:"date",class:"mr-1"},{default:m(()=>[h(c,{readonly:"",modelValue:e.password,"onUpdate:modelValue":t[3]||(t[3]=E=>e.password=E)},null,8,["modelValue"])]),_:1}),h(r,{loading:e.isLoadingResetPwd,onClick:i.onResetPasswordBtnClick},{default:m(()=>[tc]),_:1},8,["loading","onClick"])]),_:1})]),_:1})):T("",!0)])):T("",!0),a("textarea",oc,null,512)]),_:1},8,["modelValue"])}var nc=Z(Za,[["render",sc]]);const Co=(e={})=>C.post("/api_doc/export",e),ko=(e,t)=>C.get("/api_doc/export_result",{params:{project_id:e,job_id:t}}),hs=[{text:"ApiCat",icon:ds,type:"apicat",action:Co,getJobResult:ko},{text:"Postman(v2.1)",icon:us,type:"postman",action:Co,getJobResult:ko}],fs=hs,_s=()=>{const{projectInfo:e}=re(),{iterateInfo:t,isIterateRoute:s}=we(),o={isIterateRoute:s};return o.projectId=e.id,o.projectPublicId=e.id,s&&(o.iterationPublicId=t.id,o.iterationId=t.id),o},ms=()=>{const{isIterateRoute:e}=we(),{params:t}=Kt();return t[e?"iterate_id":"project_id"]},Ce=e=>{const t={};return e.projectId&&(t.project_id=e.projectId),e.iterationId&&(t.iteration_id=e.iterationId),t},ic={class:"ac-project-info ac-project-info--hover"},rc={key:0,class:"ac-project-info__img"},ac=["src","alt"],cc=["href"],lc={class:"ac-project-info__img"},dc=["src","alt"],uc=["href"],pc=["onClick"],hc={key:1,class:"ac-project-info__img"},fc=["src","alt"],_c=["href"],mc={class:"pr-2 overflow-hidden"},gc=["title"],vc=["title"],yc=["title"],Ec=ee({setup(e){const t=re(),s=we(),{isIterateRoute:o,iterateInfo:n}=ne(s),{projectInfo:i,isManager:r,isPrivate:c,isDeveloper:l}=ne(t),_=N(),f=ge("projectExportModal"),u=ms(),y=j=>{if(j.hrefFn){location.href=j.hrefFn(u,!1);return}},E=()=>{var j;f.value.title="\u5BFC\u51FA\u9879\u76EE",(j=f.value)==null||j.show({project_id:i.value.id},hs)},p=()=>{var j;(j=_.value)==null||j.show(i.value)},k=[{text:"\u9879\u76EE\u8BBE\u7F6E",icon:"iconIconPopoverSetting",hrefFn:ci},{text:"\u516C\u5171\u53C2\u6570",icon:"iconIconPopoverConfig",hrefFn:di},{text:"\u9879\u76EE\u6210\u5458",icon:"iconIconPopoverUser",hrefFn:li},{text:"\u5206\u4EAB\u9879\u76EE",icon:"iconshare2",onClick:()=>p()},{text:"\u5BFC\u51FA\u9879\u76EE",icon:"iconIconPopoverUpload",onClick:()=>E()},{text:"\u56DE\u6536\u7AD9",icon:"icontrash",hrefFn:ui}],A=N(k);return he(i,()=>{i.value&&!r.value&&(A.value=k.filter(j=>j.icon!=="iconIconPopoverSetting"))},{immediate:!0}),(j,P)=>{const R=Be,F=Jt,w=Yt,G=nc;return d(),g(U,null,[a("div",ic,[v(r)||v(l)?(d(),g(U,{key:0},[v(o)?(d(),g("div",rc,[a("img",{src:v(i).icon,alt:v(i).name},null,8,ac),a("a",{href:v(o)?"/iterations":"/home"},[h(R,{class:"ac-project-info__back"},{default:m(()=>[h(v(At))]),_:1})],8,cc)])):(d(),B(F,{key:1,placement:"bottom","popper-class":"ac-popper-menu ac-popper-menu--large",width:"250px"},{reference:m(()=>[a("div",lc,[a("img",{src:v(i).icon,alt:v(i).name},null,8,dc),a("a",{href:v(o)?"/iterations":"/home"},[h(R,{class:"ac-project-info__back"},{default:m(()=>[h(v(At))]),_:1})],8,uc)])]),default:m(()=>[a("ul",null,[(d(!0),g(U,null,ie(A.value,z=>(d(),g("li",{key:z.icon,class:M(["ac-popper-menu__item",{"border-t":z.divided}]),onClick:X=>z.onClick?z.onClick(z):y(z)},[a("i",{class:M(["mr-1 icon iconfont",z.icon])},null,2),Y($(z.text),1)],10,pc))),128))])]),_:1}))],64)):(d(),g("div",hc,[a("img",{src:v(i).icon,alt:v(i).name},null,8,fc),a("a",{href:v(o)?"/iterations":"/home"},[h(R,{class:"ac-project-info__back"},{default:m(()=>[h(v(At))]),_:1})],8,_c)])),v(o)&&v(n)?(d(),g(U,{key:2},[a("div",mc,[a("p",{class:"text-base truncate",title:v(i).name},$(v(i).name),9,gc),a("p",{class:"text-sm truncate",title:v(n).title},$(v(n).title),9,vc)]),v(c)?(d(),B(w,{key:0,effect:"dark",content:"\u79C1\u6709\u9879\u76EE",placement:"bottom"},{default:m(()=>[h(R,{size:16},{default:m(()=>[h(v(Tt))]),_:1})]),_:1})):T("",!0)],64)):(d(),g("div",{key:3,class:"ac-project-info__title",title:v(i).name},[Y($(v(i).name)+" ",1),v(c)?(d(),B(w,{key:0,effect:"dark",content:"\u79C1\u6709\u9879\u76EE",placement:"bottom"},{default:m(()=>[h(R,{class:"ac-project-info__icon"},{default:m(()=>[h(v(Tt))]),_:1})]),_:1})):T("",!0)],8,yc))]),h(G,{ref_key:"projectShareModal",ref:_},null,512)],64)}}}),Cc={class:"ac-project-info"},kc={class:"ac-project-info__img"},Ac={href:"/"},Ic=["src","alt"],bc=["title"],Nc=ee({setup(e){const t=re(),{projectInfo:s,isPrivate:o}=ne(t);return(n,i)=>{const r=Be,c=Yt;return d(),g("div",Cc,[a("div",kc,[a("a",Ac,[a("img",{src:v(s).icon,alt:v(s).name},null,8,Ic)])]),a("div",{class:"ac-project-info__title",title:v(s).name},[Y($(v(s).name)+" ",1),v(o)?(d(),B(c,{key:0,effect:"dark",content:"\u79C1\u6709\u9879\u76EE",placement:"bottom"},{default:m(()=>[h(r,{class:"ac-project-info__icon"},{default:m(()=>[h(v(Tt))]),_:1})]),_:1})):T("",!0)],8,bc)])}}}),wc="is.show.document.title",Dc="doc.save.ing",Pc="doc.save.done",jc="doc.save.error",Sc="doc.save.btn.ing",Rc="doc.save.btn.done",xc="doc.save.btn.error";var je=Bs();const Tc={class:"ac-header-operate"},Lc={class:"ac-header-operate__main"},Oc={key:1},$c={key:0,class:"ac-header-operate__btns"},Mc=ee({props:{title:{type:String,default:""}},setup(e){const t=ge("documentShareModal"),s=ge("projectExportModal"),{params:o}=Kt(),{currentRoute:n,push:i}=tt(),r=re(),{isIterateRoute:c}=we(),{isGuest:l,projectInfo:_}=ne(r),f=N(!1),u=N(!1),y=N(!1),E=$e(()=>["ac-header-operate__title",{hidden:!y.value,animate__slideInDown:y.value,animate__slideOutUp:!y.value}]),p=$e(()=>n.value.name===Te||n.value.name===Ie),k=()=>{const{params:w}=n.value,G=parseInt(w.node_id,10);return{iterate_id_public:w.iterate_id_public,project_id_public:w.project_id_public,node_id:G}},A=()=>{const{node_id:w}=k();if(p.value){u.value=!0,je.emit(Sc);return}i({name:c?Ie:Te,params:H(D({},o),{node_id:w})})},j=()=>{var G;const{node_id:w}=k();(G=t.value)==null||G.show({docId:w,nodeId:w})},P=()=>{const{node_id:w}=k();s.value.title="\u5BFC\u51FA\u6587\u6863",s.value.show({project_id:_.value.id,doc_id:w},fs)},R=()=>{f.value=!1},F=()=>{u.value=!1;const{node_id:w}=k();i({name:c?ze:Le,params:H(D({},o),{node_id:w})})};return je.on(wc,w=>{y.value=w}),je.on(Dc,()=>{f.value=!0}),je.on(Pc,R),je.on(jc,R),je.on(Rc,F),je.on(xc,()=>{u.value=!1}),(w,G)=>{const z=st,X=Yt;return d(),g("div",Tc,[a("div",Lc,[v(p)?(d(),g("p",Oc,[a("i",{class:M(["iconfont",f.value?"iconcloud-upload":"iconcloud"])},null,2),Y(" "+$(f.value?"\u4FDD\u5B58\u4E2D...":"\u5DF2\u4FDD\u5B58\u5728\u4E91\u7AEF"),1)])):(d(),g("p",{key:0,class:M(v(E))},$(e.title),3))]),v(l)?T("",!0):(d(),g("div",$c,[h(z,{type:"primary",onClick:A,loading:u.value},{default:m(()=>[Y($(v(p)?"\u9884\u89C8":"\u7F16\u8F91"),1)]),_:1},8,["loading"]),h(X,{effect:"dark",content:"\u5206\u4EAB\u8BE5\u6587\u6863",placement:"bottom"},{default:m(()=>[a("i",{class:"iconfont iconshare2",onClick:j})]),_:1}),h(X,{effect:"dark",content:"\u5BFC\u51FA\u8BE5\u6587\u6863",placement:"bottom"},{default:m(()=>[a("i",{class:"iconfont iconIconPopoverUpload",onClick:P})]),_:1})]))])}}}),Bc={emits:["on-menu-item-click"],name:"NewMenus",props:{node:{type:Object,default:()=>({})}},setup(){return{menus:vs}},methods:{onPopperItemClick(e){Vt(this,"on-menu-item-click",e)}}},Fc={class:"ac-popper-menu"},Kc=["onClick"],Vc=["src"];function Uc(e,t,s,o,n,i){return d(),g("ul",Fc,[(d(!0),g(U,null,ie(o.menus,r=>(d(),g(U,{key:r.value},[s.node.level<5||s.node.level===5&&r.value!=="newCatetory"?(d(),g("li",{key:0,class:M(["ac-popper-menu__item",{"border-t":r.divided}]),onClick:ce(c=>i.onPopperItemClick(r),["stop"])},[r.icon?(d(),g("span",{key:0,class:M(["icon iconfont ac-popper-menu__icon",r.icon])},null,2)):T("",!0),r.img?(d(),g("img",{key:1,class:"ac-popper-menu__icon",src:r.img,alt:""},null,8,Vc)):T("",!0),Y($(r.text),1)],10,Kc)):T("",!0)],64))),128))])}var Gc=Z(Bc,[["render",Uc]]);const zc={name:"DirOperateMenus",data(){return{menus:nl}},methods:{onPopperItemClick(e){Vt(this,"on-menu-item-click",e)}}},Hc={class:"ac-popper-menu ac-popper-menu--thin"},Jc=["onClick"];function Yc(e,t,s,o,n,i){return d(),g("ul",Hc,[(d(!0),g(U,null,ie(n.menus,r=>(d(),g("li",{class:M(["ac-popper-menu__item",{"border-t":r.divided}]),key:r.value,onClick:ce(c=>i.onPopperItemClick(r),["stop"])},$(r.text),11,Jc))),128))])}var Wc=Z(zc,[["render",Yc]]);const qc={emits:["on-menu-item-click"],name:"DocOperateMenus",props:{node:{type:Object,default:()=>({})},source:{type:Object,default:()=>({})},isDetailPage:{type:Boolean,default:!1}},data(){return{menus:$t}},methods:{onPopperItemClick(e){Vt(this,"on-menu-item-click",e)}}},Zc={class:"ac-popper-menu ac-popper-menu--thin"},Xc=["onClick"],Qc=["onClick"],el=["onClick"];function tl(e,t,s,o,n,i){return d(),g("ul",Zc,[(d(!0),g(U,null,ie(n.menus,r=>(d(),g(U,null,[(r.value==="delete"||r.value==="export"||r.value==="share"||r.value==="copy")&&s.isDetailPage&&s.source.isCurrent?(d(),g("li",{class:M(["ac-popper-menu__item",{"border-t":r.divided}]),key:r.value,onClick:ce(c=>i.onPopperItemClick(r),["stop"])},$(r.text),11,Xc)):T("",!0),r.value==="delete"&&!s.isDetailPage&&s.source.isCurrent?(d(),g("li",{class:M(["ac-popper-menu__item",{"border-t":r.divided}]),key:r.value,onClick:ce(c=>i.onPopperItemClick(r),["stop"])},$(r.text),11,Qc)):T("",!0),s.source.isCurrent?T("",!0):(d(),g("li",{class:M(["ac-popper-menu__item",{"border-t":r.divided}]),key:r.value,onClick:ce(c=>i.onPopperItemClick(r),["stop"])},$(r.text),11,el))],64))),256))])}var ol=Z(qc,[["render",tl]]),gs="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAUGVYSWZNTQAqAAAACAACARIAAwAAAAEAAQAAh2kABAAAAAEAAAAmAAAAAAADoAEAAwAAAAEAAQAAoAIABAAAAAEAAAAgoAMABAAAAAEAAAAgAAAAAL5bTO0AAAIwaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA1LjQuMCI+CiAgIDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+CiAgICAgIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICAgICAgICAgIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIgogICAgICAgICAgICB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyI+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgICAgIDxleGlmOkNvbG9yU3BhY2U+MTwvZXhpZjpDb2xvclNwYWNlPgogICAgICAgICA8ZXhpZjpQaXhlbFhEaW1lbnNpb24+MzI8L2V4aWY6UGl4ZWxYRGltZW5zaW9uPgogICAgICAgICA8ZXhpZjpQaXhlbFlEaW1lbnNpb24+MzI8L2V4aWY6UGl4ZWxZRGltZW5zaW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4K9GTeTwAAAW9JREFUWAntVLtKQ0EQvWsUi0AKtRFESaWlP2Nl/AMLK62sbExhlz+I8XusxE6sfRRBCxuv50guXJKZfS8IZuBw787ZmTk7+6iq/25GacA5/IcKZ3O/gxwBj7ZJbW6lPWj9xxRn+AZwARxw4GNaB+5mwWN8nx2J9sEfAVz9N7AFfAFDwNmJVUyyGYs/2CaA6874D3xvgEuAItgJpwhtCxAbZS+IugJegXXAuR25BaBmFSSihIAgEaUESCJO6Zw31yGcn28bb4O8FiY0i+QVXbAcAp6QlddvDdhdqOBw5BDAE38G9JVaO/DznRAthwAmpghCsk/J2fia/WnGoV++pEk5UjtQQwARbb7qO9EVHIG+ApJWadPgK4DXrIj5CihSnEmXApYdCOpAXdfm9vitp51Icpyj8ZI/6CU0xvA9mEqJ6BtMNqeDicbK/qAOyCnSvK4O7KWl/4225nAJOMkgwJpC24J7a1QcWSJnnJI/FfUDsbg5OtwYRrcAAAAASUVORK5CYII=",sl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABZUlEQVRYR+3XMUvEMBTA8X9uvkHE2wQRBMHJQScdHO4rCCL4DTp4izgoOLh4KBxSP4HgZ3AQXHRzcBJXXVxEHE8FI4EuXtt7LyGhg3ZsXvJ+eU3T1NDwZRrOTx1gB1gMwL0BOfCo7VsHuNAOUBH3ARxpERLgHHgSMPPAOuBm/w1MAWqEBDgEHgTAMtADnoETYN8HERuwC3R8ECkArmBqRCqAGpESMIpwizQbXU8xAV/AS8WCbQOTxf3NFAD32g2AlmLvSAJweR1itgYwXewTrjkZYNzkF4C9lI9AqnwEQGaXsFxJmX61G7rk5g6IAljBcuMJWCU3t3EALvO2nfACDMx7ER+hAl6ZS8ERAD07xyfHpaENQ3KzIfgiADK7huW6MtGZkY51EQAHts0r3RKgxZBTc5m+Ao2vgX/AX66A5lgu1WcG2Ar9GkqD+7arzwOhv2bjQPdAX3sk851ZcLy0jQYPrO34A6sFhSHFThBJAAAAAElFTkSuQmCC";const vs=[{text:"\u65B0\u5EFA\u6587\u6863",value:"createDoc",img:gs,onClick:"createDoc"},{text:"\u65B0\u5EFA HTTP API \u6587\u6863",value:"createHttpDoc",img:sl,onClick:"createHttpDoc"},{text:"\u5BFC\u5165\u6587\u4EF6",value:"importFile",icon:"iconimport",onClick:"onImportBtnClick",divided:!0},{text:"\u65B0\u5EFA\u5206\u7C7B",value:"newCatetory",type:"newCatetory",icon:"iconIconPopoverTree",onClick:"onCreateDirBtnClick",divided:!0}],$t=[{text:"\u590D\u5236",value:"copy",onClick:"onCopyBtnClick"},{text:"\u91CD\u547D\u540D",value:"rename",onClick:"onRenameBtnClick"},{text:"\u5206\u4EAB",value:"share",onClick:"onShareBtnClick"},{text:"\u5BFC\u51FA",value:"export",onClick:"onExportBtnClick"},{text:"\u5220\u9664",value:"delete",onClick:"onDeleteBtnClick"}],nl=[$t[1],$t[4]],il="DIR_NEW_TYPE",rl="DIR_OPERATE_TYPE",al="DOC_OPERATE_TYPE";function Pt(e,t){const s=document.createElement("div"),o=Rt(e);return Fs(o,s),Object.keys(t).forEach(n=>{o.component.props[n]=t[n]}),o}var cl={[il]:{render(e){return Pt(Gc,e)}},[rl]:{render(e){return Pt(Wc,e)}},[al]:{render(e){return Pt(ol,e)}}},jt={onPopperItemClick:We,onPopperHide:We,popper:Ks(document.body,{appendTo:()=>document.body,trigger:"manual",placement:"bottom",interactive:!0,theme:"light",zIndex:10}),show(e,t,s,o){const n=cl[e];!n||(this.$vm=n.render(s),Vs(this.$vm.component.proxy,"on-menu-item-click",i=>{this.onPopperItemClick(D({menu:i},s)),this.hide()}),this.popper.setProps({appendTo:()=>o||document.body,getReferenceClientRect:()=>t.getBoundingClientRect(),content:this.$vm.el,onHide:()=>{this.onPopperHide()}}),this.popper.show())},hide(){this.popper.hide()}};const ll=(e={})=>C.post("/dir/create",e),dl=(e={})=>C.post("/dir/remove",e),ul=(e={})=>C.post("/dir/rename",e),pl=(e={})=>C.post("/api_tree/sort",e),hl=(e,t)=>C.get("/api_tree",{params:H(D({},e||{}),{token:t})}),qu=e=>C.get("/dir/list",{params:{project_id:e}}),ut=(e={},t=xe.DOC)=>H(D({},e),{type:e.type===void 0?t:e.type,isEditable:!1,isCurrent:!1,isLeaf:(e.type===void 0?t:e.type)===xe.DOC,title:e.title||e.name}),ys=Me({id:"document",state:()=>({apiDocTree:[]}),getters:{},actions:{async getApiDocTree(e){if(!e.project_id)return[];const{project_id:t}=e;try{const s=S.get(S.KEYS.SECRET_PROJECT_TOKEN+t||"",!0),{data:o}=await hl(e,s);this.apiDocTree=Re(n=>(n.isLeaf=n.type===xe.DOC,n.isEditable=!1,n.isCurrent=!1,n),o||[],{subKey:"sub_nodes"})}catch{}return this.apiDocTree}}}),fl="el",_l="is-",Se=(e,t,s,o,n)=>{let i=`${e}-${t}`;return s&&(i+=`-${s}`),o&&(i+=`__${o}`),n&&(i+=`--${n}`),i},at=e=>{const t=$e(()=>fl);return{namespace:t,b:(p="")=>Se(v(t),e,p,"",""),e:p=>p?Se(v(t),e,"",p,""):"",m:p=>p?Se(v(t),e,"","",p):"",be:(p,k)=>p&&k?Se(v(t),e,p,k,""):"",em:(p,k)=>p&&k?Se(v(t),e,"",p,k):"",bm:(p,k)=>p&&k?Se(v(t),e,p,"",k):"",bem:(p,k,A)=>p&&k&&A?Se(v(t),e,p,k,A):"",is:(p,...k)=>{const A=k.length>=1?k[0]:!0;return p&&A?`${_l}${p}`:""},cssVar:p=>{const k={};for(const A in p)k[`--${t.value}-${A}`]=p[A];return k},cssVarName:p=>`--${t.value}-${p}`,cssVarBlock:p=>{const k={};for(const A in p)k[`--${t.value}-${e}-${A}`]=p[A];return k},cssVarBlockName:p=>`--${t.value}-${e}-${p}`}},ml=(e,t,s,o=!1)=>{e&&t&&s&&(e==null||e.addEventListener(t,s,o))},gl=(e,t,s,o=!1)=>{e&&t&&s&&(e==null||e.removeEventListener(t,s,o))},Ge="$treeNodeId",Ao=function(e,t){!t||t[Ge]||Object.defineProperty(t,Ge,{value:e.id,enumerable:!1,configurable:!1,writable:!1})},to=function(e,t){return e?t[e]:t[Ge]},Mt=e=>{let t=!0,s=!0,o=!0;for(let n=0,i=e.length;n<i;n++){const r=e[n];(r.checked!==!0||r.indeterminate)&&(t=!1,r.disabled||(o=!1)),(r.checked!==!1||r.indeterminate)&&(s=!1)}return{all:t,none:s,allWithoutDisable:o,half:!t&&!s}},_t=function(e){if(e.childNodes.length===0)return;const{all:t,none:s,half:o}=Mt(e.childNodes);t?(e.checked=!0,e.indeterminate=!1):o?(e.checked=!1,e.indeterminate=!0):s&&(e.checked=!1,e.indeterminate=!1);const n=e.parent;!n||n.level===0||e.store.checkStrictly||_t(n)},pt=function(e,t){const s=e.store.props,o=e.data||{},n=s[t];if(typeof n=="function")return n(o,e);if(typeof n=="string")return o[n];if(typeof n=="undefined"){const i=o[t];return i===void 0?"":i}};let vl=0;class Oe{constructor(t){O(this,"id");O(this,"text");O(this,"checked");O(this,"indeterminate");O(this,"data");O(this,"expanded");O(this,"parent");O(this,"visible");O(this,"isCurrent");O(this,"store");O(this,"isLeafByUser");O(this,"isLeaf");O(this,"canFocus");O(this,"level");O(this,"loaded");O(this,"childNodes");O(this,"loading");this.id=vl++,this.text=void 0,this.checked=!1,this.indeterminate=!1,this.data=void 0,this.expanded=!1,this.parent=void 0,this.visible=!0,this.isCurrent=!1,this.canFocus=!1;for(const s in t)xt(t,s)&&(this[s]=t[s]);this.level=0,this.loaded=!1,this.childNodes=[],this.loading=!1,this.parent&&(this.level=this.parent.level+1)}initialize(){const t=this.store;if(!t)throw new Error("[Node]store is required!");t.registerNode(this);const s=t.props;if(s&&typeof s.isLeaf!="undefined"){const i=pt(this,"isLeaf");typeof i=="boolean"&&(this.isLeafByUser=i)}if(t.lazy!==!0&&this.data?(this.setData(this.data),t.defaultExpandAll&&(this.expanded=!0,this.canFocus=!0)):this.level>0&&t.lazy&&t.defaultExpandAll&&this.expand(),Array.isArray(this.data)||Ao(this,this.data),!this.data)return;const o=t.defaultExpandedKeys,n=t.key;n&&o&&o.includes(this.key)&&this.expand(void 0,t.autoExpandParent),n&&t.currentNodeKey!==void 0&&this.key===t.currentNodeKey&&(t.currentNode=this,t.currentNode.isCurrent=!0),t.lazy&&t._initDefaultCheckedNode(this),this.updateLeafState(),this.parent&&(this.level===1||this.parent.expanded===!0)&&(this.canFocus=!0)}setData(t){Array.isArray(t)||Ao(this,t),this.data=t,this.childNodes=[];let s;this.level===0&&Array.isArray(this.data)?s=this.data:s=pt(this,"children")||[];for(let o=0,n=s.length;o<n;o++)this.insertChild({data:s[o]})}get label(){return pt(this,"label")}get key(){const t=this.store.key;return this.data?this.data[t]:null}get disabled(){return pt(this,"disabled")}get nextSibling(){const t=this.parent;if(t){const s=t.childNodes.indexOf(this);if(s>-1)return t.childNodes[s+1]}return null}get previousSibling(){const t=this.parent;if(t){const s=t.childNodes.indexOf(this);if(s>-1)return s>0?t.childNodes[s-1]:null}return null}contains(t,s=!0){return(this.childNodes||[]).some(o=>o===t||s&&o.contains(t))}remove(){const t=this.parent;t&&t.removeChild(this)}insertChild(t,s,o){if(!t)throw new Error("InsertChild error: child is required.");if(!(t instanceof Oe)){if(!o){const n=this.getChildren(!0);n.includes(t.data)||(typeof s=="undefined"||s<0?n.push(t.data):n.splice(s,0,t.data))}Object.assign(t,{parent:this,store:this.store}),t=Bt(new Oe(t)),t instanceof Oe&&t.initialize()}t.level=this.level+1,typeof s=="undefined"||s<0?this.childNodes.push(t):this.childNodes.splice(s,0,t),this.updateLeafState()}insertBefore(t,s){let o;s&&(o=this.childNodes.indexOf(s)),this.insertChild(t,o)}insertAfter(t,s){let o;s&&(o=this.childNodes.indexOf(s),o!==-1&&(o+=1)),this.insertChild(t,o)}removeChild(t){const s=this.getChildren()||[],o=s.indexOf(t.data);o>-1&&s.splice(o,1);const n=this.childNodes.indexOf(t);n>-1&&(this.store&&this.store.deregisterNode(t),t.parent=null,this.childNodes.splice(n,1)),this.updateLeafState()}removeChildByData(t){let s=null;for(let o=0;o<this.childNodes.length;o++)if(this.childNodes[o].data===t){s=this.childNodes[o];break}s&&this.removeChild(s)}expand(t,s){const o=()=>{if(s){let n=this.parent;for(;n.level>0;)n.expanded=!0,n=n.parent}this.expanded=!0,t&&t(),this.childNodes.forEach(n=>{n.canFocus=!0})};this.shouldLoadData()?this.loadData(n=>{Array.isArray(n)&&(this.checked?this.setChecked(!0,!0):this.store.checkStrictly||_t(this),o())}):o()}doCreateChildren(t,s={}){t.forEach(o=>{this.insertChild(Object.assign({data:o},s),void 0,!0)})}collapse(){this.expanded=!1,this.childNodes.forEach(t=>{t.canFocus=!1})}shouldLoadData(){return this.store.lazy===!0&&this.store.load&&!this.loaded}updateLeafState(){if(typeof this.isLeafByUser!="undefined"){this.isLeaf=this.isLeafByUser;return}this.isLeaf=!1}setChecked(t,s,o,n){if(this.indeterminate=t==="half",this.checked=t===!0,this.store.checkStrictly)return;if(!(this.shouldLoadData()&&!this.store.checkDescendants)){const{all:r,allWithoutDisable:c}=Mt(this.childNodes);!this.isLeaf&&!r&&c&&(this.checked=!1,t=!1);const l=()=>{if(s){const _=this.childNodes;for(let y=0,E=_.length;y<E;y++){const p=_[y];n=n||t!==!1;const k=p.disabled?p.checked:n;p.setChecked(k,s,!0,n)}const{half:f,all:u}=Mt(_);u||(this.checked=u,this.indeterminate=f)}};if(this.shouldLoadData()){this.loadData(()=>{l(),_t(this)},{checked:t!==!1});return}else l()}const i=this.parent;!i||i.level===0||o||_t(i)}getChildren(t=!1){if(this.level===0)return this.data;const s=this.data;if(!s)return null;const o=this.store.props;let n="children";return o&&(n=o.children||"children"),s[n]===void 0&&(s[n]=null),t&&!s[n]&&(s[n]=[]),s[n]}updateChildren(){const t=this.getChildren()||[],s=this.childNodes.map(i=>i.data),o={},n=[];t.forEach((i,r)=>{const c=i[Ge];!!c&&s.findIndex(_=>_[Ge]===c)>=0?o[c]={index:r,data:i}:n.push({index:r,data:i})}),this.store.lazy||s.forEach(i=>{o[i[Ge]]||this.removeChildByData(i)}),n.forEach(({index:i,data:r})=>{this.insertChild({data:r},i)}),this.updateLeafState()}loadData(t,s={}){if(this.store.lazy===!0&&this.store.load&&!this.loaded&&(!this.loading||Object.keys(s).length)){this.loading=!0;const o=n=>{this.loaded=!0,this.loading=!1,this.childNodes=[],this.doCreateChildren(n,s),this.updateLeafState(),t&&t.call(this,n)};this.store.load(this,o)}else t&&t.call(this)}}class yl{constructor(t){O(this,"currentNode");O(this,"currentNodeKey");O(this,"nodesMap");O(this,"root");O(this,"data");O(this,"lazy");O(this,"load");O(this,"filterNodeMethod");O(this,"key");O(this,"defaultCheckedKeys");O(this,"checkStrictly");O(this,"defaultExpandedKeys");O(this,"autoExpandParent");O(this,"defaultExpandAll");O(this,"checkDescendants");O(this,"props");this.currentNode=null,this.currentNodeKey=null;for(const s in t)xt(t,s)&&(this[s]=t[s]);this.nodesMap={}}initialize(){this.root=new Oe({data:this.data,store:this}),this.root.initialize(),this.lazy&&this.load?this.load(this.root,s=>{this.root.doCreateChildren(s),this._initDefaultCheckedNodes()}):this._initDefaultCheckedNodes()}filter(t){const s=this.filterNodeMethod,o=this.lazy,n=function(i){const r=i.root?i.root.childNodes:i.childNodes;if(r.forEach(c=>{c.visible=s.call(c,t,c.data,c),n(c)}),!i.visible&&r.length){let c=!0;c=!r.some(l=>l.visible),i.root?i.root.visible=c===!1:i.visible=c===!1}!t||i.visible&&!i.isLeaf&&!o&&i.expand()};n(this)}setData(t){t!==this.root.data?(this.root.setData(t),this._initDefaultCheckedNodes()):this.root.updateChildren()}getNode(t){if(t instanceof Oe)return t;const s=typeof t!="object"?t:to(this.key,t);return this.nodesMap[s]||null}insertBefore(t,s){const o=this.getNode(s);o.parent.insertBefore({data:t},o)}insertAfter(t,s){const o=this.getNode(s);o.parent.insertAfter({data:t},o)}remove(t){const s=this.getNode(t);s&&s.parent&&(s===this.currentNode&&(this.currentNode=null),s.parent.removeChild(s))}append(t,s){const o=s?this.getNode(s):this.root;o&&o.insertChild({data:t})}_initDefaultCheckedNodes(){const t=this.defaultCheckedKeys||[],s=this.nodesMap;t.forEach(o=>{const n=s[o];n&&n.setChecked(!0,!this.checkStrictly)})}_initDefaultCheckedNode(t){(this.defaultCheckedKeys||[]).includes(t.key)&&t.setChecked(!0,!this.checkStrictly)}setDefaultCheckedKey(t){t!==this.defaultCheckedKeys&&(this.defaultCheckedKeys=t,this._initDefaultCheckedNodes())}registerNode(t){const s=this.key;!t||!t.data||(s?t.key!==void 0&&(this.nodesMap[t.key]=t):this.nodesMap[t.id]=t)}deregisterNode(t){!this.key||!t||!t.data||(t.childNodes.forEach(o=>{this.deregisterNode(o)}),delete this.nodesMap[t.key])}getCheckedNodes(t=!1,s=!1){const o=[],n=function(i){(i.root?i.root.childNodes:i.childNodes).forEach(c=>{(c.checked||s&&c.indeterminate)&&(!t||t&&c.isLeaf)&&o.push(c.data),n(c)})};return n(this),o}getCheckedKeys(t=!1){return this.getCheckedNodes(t).map(s=>(s||{})[this.key])}getHalfCheckedNodes(){const t=[],s=function(o){(o.root?o.root.childNodes:o.childNodes).forEach(i=>{i.indeterminate&&t.push(i.data),s(i)})};return s(this),t}getHalfCheckedKeys(){return this.getHalfCheckedNodes().map(t=>(t||{})[this.key])}_getAllNodes(){const t=[],s=this.nodesMap;for(const o in s)xt(s,o)&&t.push(s[o]);return t}updateChildren(t,s){const o=this.nodesMap[t];if(!o)return;const n=o.childNodes;for(let i=n.length-1;i>=0;i--){const r=n[i];this.remove(r.data)}for(let i=0,r=s.length;i<r;i++){const c=s[i];this.append(c,o.data)}}_setCheckedKeys(t,s=!1,o){const n=this._getAllNodes().sort((c,l)=>l.level-c.level),i=Object.create(null),r=Object.keys(o);n.forEach(c=>c.setChecked(!1,!1));for(let c=0,l=n.length;c<l;c++){const _=n[c],f=_.data[t].toString();if(!r.includes(f)){_.checked&&!i[f]&&_.setChecked(!1,!1);continue}let y=_.parent;for(;y&&y.level>0;)i[y.data[t]]=!0,y=y.parent;if(_.isLeaf||this.checkStrictly){_.setChecked(!0,!1);continue}if(_.setChecked(!0,!0),s){_.setChecked(!1,!1);const E=function(p){p.childNodes.forEach(A=>{A.isLeaf||A.setChecked(!1,!1),E(A)})};E(_)}}}setCheckedNodes(t,s=!1){const o=this.key,n={};t.forEach(i=>{const r=i||{};n[r[o]]=!0}),this._setCheckedKeys(o,s,n)}setCheckedKeys(t,s=!1){this.defaultCheckedKeys=t;const o=this.key,n={};t.forEach(i=>{n[i]=!0}),this._setCheckedKeys(o,s,n)}setDefaultExpandedKeys(t){t=t||[],this.defaultExpandedKeys=t,t.forEach(s=>{const o=this.getNode(s);o&&o.expand(void 0,this.autoExpandParent)})}setChecked(t,s,o){const n=this.getNode(t);n&&n.setChecked(!!s,o)}getCurrentNode(){return this.currentNode}setCurrentNode(t){const s=this.currentNode;s&&(s.isCurrent=!1),this.currentNode=t,this.currentNode.isCurrent=!0}setUserCurrentNode(t,s=!0){const o=t[this.key],n=this.nodesMap[o];this.setCurrentNode(n),s&&this.currentNode.level>1&&this.currentNode.parent.expand(null,!0)}setCurrentNodeKey(t,s=!0){if(t==null){this.currentNode&&(this.currentNode.isCurrent=!1),this.currentNode=null;return}const o=this.getNode(t);o&&(this.setCurrentNode(o),s&&this.currentNode.level>1&&this.currentNode.parent.expand(null,!0))}}const El=ee({name:"AcTreeNodeContent",props:{node:{type:Object,required:!0},renderContent:Function},setup(e){const t=at("tree"),s=ge("NodeInstance"),o=ge("RootTree");return()=>{const n=e.node,{data:i,store:r}=n;return e.renderContent?e.renderContent(Rt,{_self:s,node:n,data:i,store:r}):o.ctx.slots.default?o.ctx.slots.default({node:n,data:i}):Rt("span",{class:t.be("node","label")},[n.label])}}});function Es(e){const t=ge("TreeNodeMap",void 0),s={treeNodeExpand:o=>{e.node!==o&&e.node.collapse()},children:[]};return t&&t.children.push(s),ue("TreeNodeMap",s),{broadcastExpanded:o=>{if(!!e.accordion)for(const n of s.children)n.treeNodeExpand(o)}}}const Cs=Symbol("dragEvents");function Cl({props:e,ctx:t,el$:s,dropIndicator$:o,store:n}){const i=at("tree"),r=N({showDropIndicator:!1,draggingNode:null,dropNode:null,allowDrop:!0,dropType:null});return ue(Cs,{treeNodeDragStart:({event:f,treeNode:u})=>{if(typeof e.allowDrag=="function"&&!e.allowDrag(u.node))return f.preventDefault(),!1;f.dataTransfer.effectAllowed="move";try{f.dataTransfer.setData("text/plain","")}catch{}r.value.draggingNode=u,t.emit("node-drag-start",u.node,f)},treeNodeDragOver:({event:f,treeNode:u})=>{const y=u,E=r.value.dropNode;E&&E!==y&&kt(E.$el,i.is("drop-inner"));const p=r.value.draggingNode;if(!p||!y)return;let k=!0,A=!0,j=!0,P=!0;typeof e.allowDrop=="function"&&(k=e.allowDrop(p.node,y.node,"prev"),P=A=e.allowDrop(p.node,y.node,"inner"),j=e.allowDrop(p.node,y.node,"next")),f.dataTransfer.dropEffect=A||k||j?"move":"none",(k||A||j)&&E!==y&&(E&&t.emit("node-drag-leave",p.node,E.node,f),t.emit("node-drag-enter",p.node,y.node,f)),(k||A||j)&&(r.value.dropNode=y),y.node.nextSibling===p.node&&(j=!1),y.node.previousSibling===p.node&&(k=!1),y.node.contains(p.node,!1)&&(A=!1),(p.node===y.node||p.node.contains(y.node))&&(k=!1,A=!1,j=!1);const R=y.$el.getBoundingClientRect(),F=s.value.getBoundingClientRect();let w;const G=k?A?.25:j?.45:1:-1,z=j?A?.75:k?.55:0:1;let X=-9999;const b=f.clientY-R.top;b<R.height*G?w="before":b>R.height*z?w="after":A?w="inner":w="none";const V=y.$el.querySelector(`.${i.be("node","expand-icon")}`).getBoundingClientRect(),q=o.value;w==="before"?X=V.top-F.top:w==="after"&&(X=V.bottom-F.top),q.style.top=`${X}px`,q.style.left=`${V.right-F.left}px`,w==="inner"?Us(y.$el,i.is("drop-inner")):kt(y.$el,i.is("drop-inner")),r.value.showDropIndicator=w==="before"||w==="after",r.value.allowDrop=r.value.showDropIndicator||P,r.value.dropType=w,t.emit("node-drag-over",p.node,y.node,f)},treeNodeDragEnd:f=>{const{draggingNode:u,dropType:y,dropNode:E}=r.value;if(f.preventDefault(),f.dataTransfer.dropEffect="move",u&&E){const p={data:u.node.data};y!=="none"&&u.node.remove(),y==="before"?E.node.parent.insertBefore(p,E.node):y==="after"?E.node.parent.insertAfter(p,E.node):y==="inner"&&E.node.insertChild(p),y!=="none"&&n.value.registerNode(p),kt(E.$el,i.is("drop-inner")),t.emit("node-drag-end",u.node,E.node,y,f),y!=="none"&&t.emit("node-drop",u.node,E.node,y,f)}u&&!E&&t.emit("node-drag-end",u.node,null,y,f),r.value.showDropIndicator=!1,r.value.draggingNode=null,r.value.dropNode=null,r.value.allowDrop=!0}}),{dragState:r}}const kl=ee({name:"AcTreeNode",components:{NodeContent:El,Loading:_n},props:{node:{type:Oe,default:()=>({})},props:{type:Object,default:()=>({})},accordion:Boolean,renderContent:Function,renderAfterExpand:Boolean,showCheckbox:{type:Boolean,default:!1}},emits:["node-expand"],setup(e,t){const s=at("tree"),{broadcastExpanded:o}=Es(e),n=ge("RootTree"),i=N(!1),r=N(!1),c=N(!1),l=N(!1),_=N(null),f=ge(Cs),u=Do();ue("NodeInstance",u),e.node.expanded&&(i.value=!0,r.value=!0);const y=n.props.children||"children";he(()=>{const b=e.node.data[y];return b&&[...b]},()=>{e.node.updateChildren()}),he(()=>e.node.indeterminate,b=>{k(e.node.checked,b)}),he(()=>e.node.checked,b=>{k(b,e.node.indeterminate)}),he(()=>e.node.expanded,b=>{mt(()=>i.value=b),b&&(r.value=!0)});const E=b=>to(n.props.nodeKey,b.data),p=b=>{const V=e.props.class;if(!V)return{};let q;if(Gs(V)){const{data:le}=b;q=V(le,b)}else q=V;return zs(q)?{[q]:!0}:q},k=(b,V)=>{(c.value!==b||l.value!==V)&&n.ctx.emit("check-change",e.node.data,b,V),c.value=b,l.value=V},A=b=>{const V=n.store.value;V.setCurrentNode(e.node),n.ctx.emit("current-change",V.currentNode?V.currentNode.data:null,V.currentNode),n.currentNode.value=e.node,n.props.expandOnClickNode&&P(),n.props.checkOnClickNode&&!e.node.disabled&&R(null,{target:{checked:!e.node.checked}}),n.ctx.emit("node-click",e.node.data,e.node,u,b)},j=b=>{n.instance.vnode.props.onNodeContextmenu&&(b.stopPropagation(),b.preventDefault()),n.ctx.emit("node-contextmenu",b,e.node.data,e.node,u)},P=()=>{e.node.isLeaf||(i.value?(n.ctx.emit("node-collapse",e.node.data,e.node,u),e.node.collapse()):(e.node.expand(),t.emit("node-expand",e.node.data,e.node,u)))},R=(b,V)=>{e.node.setChecked(V.target.checked,!n.props.checkStrictly),mt(()=>{const q=n.store.value;n.ctx.emit("check",e.node.data,{checkedNodes:q.getCheckedNodes(),checkedKeys:q.getCheckedKeys(),halfCheckedNodes:q.getHalfCheckedNodes(),halfCheckedKeys:q.getHalfCheckedKeys()})})};return{ns:s,node$:_,tree:n,expanded:i,childNodeRendered:r,oldChecked:c,oldIndeterminate:l,getNodeKey:E,getNodeClass:p,handleSelectChange:k,handleClick:A,handleContextMenu:j,handleExpandIconClick:P,handleCheckChange:R,handleChildNodeExpand:(b,V,q)=>{o(V),n.ctx.emit("node-expand",b,V,q)},handleDragStart:b=>{!n.props.draggable||f.treeNodeDragStart({event:b,treeNode:e})},handleDragOver:b=>{b.preventDefault(),n.props.draggable&&f.treeNodeDragOver({event:b,treeNode:{$el:_.value,node:e.node}})},handleDrop:b=>{b.preventDefault()},handleDragEnd:b=>{!n.props.draggable||f.treeNodeDragEnd(b)},CaretRight:mn}}}),Al=["aria-expanded","aria-disabled","aria-checked","draggable","data-key"],Il=["aria-expanded"];function bl(e,t,s,o,n,i){const r=Be,c=gn,l=Q("loading"),_=Q("node-content"),f=Q("ac-tree-node");return te((d(),g("div",{ref:"node$",class:M([e.ns.b("node"),e.ns.is("expanded",e.expanded),e.ns.is("current",e.node.isCurrent),e.ns.is("hidden",!e.node.visible),e.ns.is("focusable",!e.node.disabled),e.ns.is("checked",!e.node.disabled&&e.node.checked),e.getNodeClass(e.node)]),role:"treeitem",tabindex:"-1","aria-expanded":e.expanded,"aria-disabled":e.node.disabled,"aria-checked":e.node.checked,draggable:e.tree.props.draggable,"data-key":e.getNodeKey(e.node),onClick:t[1]||(t[1]=ce((...u)=>e.handleClick&&e.handleClick(...u),["stop"])),onContextmenu:t[2]||(t[2]=(...u)=>e.handleContextMenu&&e.handleContextMenu(...u)),onDragstart:t[3]||(t[3]=ce((...u)=>e.handleDragStart&&e.handleDragStart(...u),["stop"])),onDragover:t[4]||(t[4]=ce((...u)=>e.handleDragOver&&e.handleDragOver(...u),["stop"])),onDragend:t[5]||(t[5]=ce((...u)=>e.handleDragEnd&&e.handleDragEnd(...u),["stop"])),onDrop:t[6]||(t[6]=ce((...u)=>e.handleDrop&&e.handleDrop(...u),["stop"]))},[a("div",{class:M(e.ns.be("node","content")),style:Po({paddingLeft:(e.node.level-1)*e.tree.props.indent+"px"})},[e.tree.props.icon||e.CaretRight?(d(),B(r,{key:0,class:M([e.ns.be("node","expand-icon"),e.ns.is("leaf",e.node.isLeaf),{expanded:!e.node.isLeaf&&e.expanded}]),onClick:ce(e.handleExpandIconClick,["stop"])},{default:m(()=>[(d(),B(Hs(e.tree.props.icon||e.CaretRight)))]),_:1},8,["class","onClick"])):T("",!0),e.showCheckbox?(d(),B(c,{key:1,"model-value":e.node.checked,indeterminate:e.node.indeterminate,disabled:!!e.node.disabled,onClick:t[0]||(t[0]=ce(()=>{},["stop"])),onChange:e.handleCheckChange},null,8,["model-value","indeterminate","disabled","onChange"])):T("",!0),e.node.loading?(d(),B(r,{key:2,class:M([e.ns.be("node","loading-icon"),e.ns.is("loading")])},{default:m(()=>[h(l)]),_:1},8,["class"])):T("",!0),h(_,{node:e.node,"render-content":e.renderContent},null,8,["node","render-content"])],6),!e.renderAfterExpand||e.childNodeRendered?te((d(),g("div",{key:0,class:M(e.ns.be("node","children")),role:"group","aria-expanded":e.expanded},[(d(!0),g(U,null,ie(e.node.childNodes,u=>(d(),B(f,{key:e.getNodeKey(u),"render-content":e.renderContent,"render-after-expand":e.renderAfterExpand,"show-checkbox":e.showCheckbox,node:u,accordion:e.accordion,props:e.props,onNodeExpand:e.handleChildNodeExpand},null,8,["render-content","render-after-expand","show-checkbox","node","accordion","props","onNodeExpand"]))),128))],10,Il)),[[pe,e.expanded]]):T("",!0)],42,Al)),[[pe,e.node.visible]])}var Nl=Z(kl,[["render",bl]]);function wl({el$:e},t){const s=at("tree"),o=ho([]),n=ho([]);et(()=>{r(),ml(e.value,"keydown",i)}),Js(()=>{gl(e.value,"keydown",i)}),Ys(()=>{o.value=Array.from(e.value.querySelectorAll("[role=treeitem]")),n.value=Array.from(e.value.querySelectorAll("input[type=checkbox]"))}),he(n,c=>{c.forEach(l=>{l.setAttribute("tabindex","-1")})});const i=c=>{const l=c.target;if(!l.className.includes(s.b("node")))return;const _=c.code;o.value=Array.from(e.value.querySelectorAll(`.${s.is("focusable")}[role=treeitem]`));const f=o.value.indexOf(l);let u;if([Pe.up,Pe.down].includes(_)){if(c.preventDefault(),_===Pe.up){u=f===-1?0:f!==0?f-1:o.value.length-1;const E=u;for(;!t.value.getNode(o.value[u].dataset.key).canFocus;){if(u--,u===E){u=-1;break}u<0&&(u=o.value.length-1)}}else{u=f===-1?0:f<o.value.length-1?f+1:0;const E=u;for(;!t.value.getNode(o.value[u].dataset.key).canFocus;){if(u++,u===E){u=-1;break}u>=o.value.length&&(u=0)}}u!==-1&&o.value[u].focus()}[Pe.left,Pe.right].includes(_)&&(c.preventDefault(),l.click());const y=l.querySelector('[type="checkbox"]');[Pe.enter,Pe.space].includes(_)&&y&&(c.preventDefault(),y.click())},r=()=>{var l;o.value=Array.from(e.value.querySelectorAll(`.${s.is("focusable")}[role=treeitem]`)),n.value=Array.from(e.value.querySelectorAll("input[type=checkbox]"));const c=e.value.querySelectorAll(`.${s.is("checked")}[role=treeitem]`);if(c.length){c[0].setAttribute("tabindex","0");return}(l=o.value[0])==null||l.setAttribute("tabindex","0")}}const Dl=ee({name:"AcTree",components:{AcTreeNode:Nl},props:{data:{type:Array,default:()=>[]},emptyText:{type:String},renderAfterExpand:{type:Boolean,default:!0},nodeKey:String,checkStrictly:Boolean,defaultExpandAll:Boolean,expandOnClickNode:{type:Boolean,default:!0},checkOnClickNode:Boolean,checkDescendants:{type:Boolean,default:!1},autoExpandParent:{type:Boolean,default:!0},defaultCheckedKeys:Array,defaultExpandedKeys:Array,currentNodeKey:[String,Number],renderContent:Function,showCheckbox:{type:Boolean,default:!1},draggable:{type:Boolean,default:!1},allowDrag:Function,allowDrop:Function,props:{type:Object,default:()=>({children:"children",label:"label",disabled:"disabled"})},lazy:{type:Boolean,default:!1},highlightCurrent:Boolean,load:Function,filterNodeMethod:Function,accordion:Boolean,indent:{type:Number,default:18},icon:[String,Object]},emits:["check-change","current-change","node-click","node-contextmenu","node-collapse","node-expand","check","node-drag-start","node-drag-end","node-drop","node-drag-leave","node-drag-enter","node-drag-over"],setup(e,t){const s=at("tree"),o=N(new yl({key:e.nodeKey,data:e.data,lazy:e.lazy,props:e.props,load:e.load,currentNodeKey:e.currentNodeKey,checkStrictly:e.checkStrictly,checkDescendants:e.checkDescendants,defaultCheckedKeys:e.defaultCheckedKeys,defaultExpandedKeys:e.defaultExpandedKeys,autoExpandParent:e.autoExpandParent,defaultExpandAll:e.defaultExpandAll,filterNodeMethod:e.filterNodeMethod}));o.value.initialize();const n=N(o.value.root),i=N(null),r=N(null),c=N(null),{broadcastExpanded:l}=Es(e),{dragState:_}=Cl({props:e,ctx:t,el$:r,dropIndicator$:c,store:o});wl({el$:r},o);const f=$e(()=>{const{childNodes:I}=n.value;return!I||I.length===0||I.every(({visible:K})=>!K)});he(()=>e.defaultCheckedKeys,I=>{o.value.setDefaultCheckedKey(I)}),he(()=>e.defaultExpandedKeys,I=>{o.value.setDefaultExpandedKeys(I)}),he(()=>e.data,I=>{o.value.setData(I)},{deep:!0}),he(()=>e.checkStrictly,I=>{o.value.checkStrictly=I});const u=I=>{if(!e.filterNodeMethod)throw new Error("[Tree] filterNodeMethod is required when filter");o.value.filter(I)},y=I=>to(e.nodeKey,I.data),E=I=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in getNodePath");const K=o.value.getNode(I);if(!K)return[];const ye=[K.data];let De=K.parent;for(;De&&De!==n.value;)ye.push(De.data),De=De.parent;return ye.reverse()},p=(I,K)=>o.value.getCheckedNodes(I,K),k=I=>o.value.getCheckedKeys(I),A=()=>{const I=o.value.getCurrentNode();return I?I.data:null},j=()=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in getCurrentKey");const I=A();return I?I[e.nodeKey]:null},P=(I,K)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCheckedNodes");o.value.setCheckedNodes(I,K)},R=(I,K)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCheckedKeys");o.value.setCheckedKeys(I,K)},F=(I,K,ye)=>{o.value.setChecked(I,K,ye)},w=()=>o.value.getHalfCheckedNodes(),G=()=>o.value.getHalfCheckedKeys(),z=(I,K=!0)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCurrentNode");o.value.setUserCurrentNode(I,K)},X=(I,K=!0)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCurrentKey");o.value.setCurrentNodeKey(I,K)},b=I=>o.value.getNode(I),V=I=>{o.value.remove(I)},q=(I,K)=>{o.value.append(I,K)},le=(I,K)=>{o.value.insertBefore(I,K)},He=(I,K)=>{o.value.insertAfter(I,K)},lt=(I,K,ye)=>{l(K),t.emit("node-expand",I,K,ye)},Et=(I,K)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in updateKeyChild");o.value.updateChildren(I,K)};return ue("RootTree",{ctx:t,props:e,store:o,root:n,currentNode:i,instance:Do()}),{ns:s,store:o,root:n,currentNode:i,dragState:_,el$:r,dropIndicator$:c,isEmpty:f,filter:u,getNodeKey:y,getNodePath:E,getCheckedNodes:p,getCheckedKeys:k,getCurrentNode:A,getCurrentKey:j,setCheckedNodes:P,setCheckedKeys:R,setChecked:F,getHalfCheckedNodes:w,getHalfCheckedKeys:G,setCurrentNode:z,setCurrentKey:X,getNode:b,remove:V,append:q,insertBefore:le,insertAfter:He,handleNodeExpand:lt,updateKeyChildren:Et}}});function Pl(e,t,s,o,n,i){var c;const r=Q("ac-tree-node");return d(),g("div",{ref:"el$",class:M([e.ns.b(),e.ns.is("dragging",!!e.dragState.draggingNode),e.ns.is("drop-not-allow",!e.dragState.allowDrop),e.ns.is("drop-inner",e.dragState.dropType==="inner"),{[e.ns.m("highlight-current")]:e.highlightCurrent}]),role:"tree"},[(d(!0),g(U,null,ie(e.root.childNodes,l=>(d(),B(r,{key:e.getNodeKey(l),node:l,props:e.props,accordion:e.accordion,"render-after-expand":e.renderAfterExpand,"show-checkbox":e.showCheckbox,"render-content":e.renderContent,onNodeExpand:e.handleNodeExpand},null,8,["node","props","accordion","render-after-expand","show-checkbox","render-content","onNodeExpand"]))),128)),e.isEmpty?(d(),g("div",{key:0,class:M(e.ns.e("empty-block"))},[a("span",{class:M(e.ns.e("empty-text"))},$((c=e.emptyText)!=null?c:"\u6682\u65E0\u6570\u636E"),3)],2)):T("",!0),te(a("div",{ref:"dropIndicator$",class:M(e.ns.e("drop-indicator"))},null,2),[[pe,e.dragState.showDropIndicator]])],2)}var jl=Z(Dl,[["render",Pl]]);const Sl={props:{status:{type:String,default:()=>"success",validate(e){return["success","error"].indexOf(e)!==-1}},title:{type:String,default:()=>""},subTitle:{type:String,default:()=>""},styles:{type:Object,default:()=>({})}}},Rl={class:"result"},xl={class:"result-title"},Tl={class:"mt-1 result-subtitle"};function Ll(e,t,s,o,n,i){return d(),g("div",Rl,[a("div",{class:"result-icon",style:Po(s.styles)},[ft(e.$slots,"icon",{},void 0,!0)],4),ft(e.$slots,"title",{},()=>[a("p",xl,$(s.title),1)],!0),a("p",Tl,[ft(e.$slots,"subTitle",{},()=>[Y($(s.subTitle),1)],!0)])])}var Ol=Z(Sl,[["render",Ll],["__scopeId","data-v-a27469de"]]),ks="/assets/icon-no-result.4a7ec4ce.png";const As=e=>(Xe("data-v-59b62b74"),e=e(),Qe(),e),$l={class:"text-left search-result scroll-content"},Ml=["onClick"],Bl={class:"px-2 truncate hover:bg-gray-100"},Fl=As(()=>a("img",{src:ks},null,-1)),Kl=As(()=>a("span",null,"\u672A\u627E\u5230\u641C\u7D22\u7ED3\u679C\uFF01",-1)),Vl=ee({props:{virtualRef:Object},setup(e,{expose:t}){const s=e,{push:o}=tt(),{apiDocTree:n}=ne(ys()),i=_s(),r=ms(),{isIterateRoute:c}=i,l=N(!1),_=N(!1),f=N(""),u=N([]),y=N(),E=N(),p=N(),k=Ft(s),A={modifiers:[{name:"computeStyles",options:{gpuAcceleration:!1}},{name:"offset",options:{offset:[-300,10]}}]};bo(y,()=>P(),{ignore:[k.virtualRef]});const j=Ut(()=>{const G=v(f);if(G.length<2)return;l.value=!0,_.value=!0;const z=Ce(i);z.project_id_public=i.projectPublicId,wa(z,G).then(X=>{u.value=X.data||[]}).catch(X=>{}).finally(()=>{_.value=!1})},200),P=()=>{u.value=[],f.value="",l.value=!1},R=G=>{let z=null;Re(b=>{if(b.id===parseInt(G.doc_id,10))return z=b,!1},n.value||[],{subKey:"sub_nodes"});const X=c?Oi(r,G.doc_id):ps(r,G.doc_id);z?o({path:X}):location.href=X},F=()=>{p.value.focus()},w=()=>{P()};return t({onShow:F,onHide:w}),(G,z)=>{const X=yt,b=Ol,V=Jt,q=nt;return d(),B(V,{ref_key:"popoverRef",ref:E,placement:"bottom-end",trigger:"click","virtual-ref":s.virtualRef,"virtual-triggering":"",width:"auto","popper-options":A,onAfterEnter:F,onAfterLeave:w},{default:m(()=>[a("div",{ref_key:"searchDomRef",ref:y,class:"search-poptip"},[h(X,{ref_key:"searchInput",ref:p,"suffix-icon":v(Oo),placeholder:"\u5173\u952E\u5B57 \u56DE\u8F66\u641C\u7D22",modelValue:f.value,"onUpdate:modelValue":z[0]||(z[0]=le=>f.value=le),onChange:v(j),clearable:""},null,8,["suffix-icon","modelValue","onChange"]),te((d(),g("div",$l,[(d(!0),g(U,null,ie(u.value,(le,He)=>(d(),g("span",{class:"cursor-pointer",key:le.doc_id+"_"+He,onClick:lt=>R(le)},[a("h4",Bl,$(le.title),1)],8,Ml))),128)),te(h(b,null,{icon:m(()=>[Fl]),title:m(()=>[Kl]),_:1},512),[[pe,l.value&&!_.value&&!u.value.length]])])),[[pe,l.value],[q,_.value]])],512)]),_:1},8,["virtual-ref"])}}});var Ul=Z(Vl,[["__scopeId","data-v-59b62b74"]]);let Ye=null;const Is=()=>{Ye&&Ye.visible.value||(Ye=$o.service({lock:!0,background:"rgba(255, 255, 255, 1)"}))},me=()=>{Ye&&Ye.close()};var Gl=ee({components:{AcTree:jl,Plus:vn,Search:Oo,MoreFilled:xo,SearchDocumentPopover:Ul},setup(){const e=ge("documentShareModal"),t=ge("documentImportModal"),s=ge("projectExportModal"),o=Kt(),n=tt(),{currentRoute:i}=n,{params:r}=o,no=_s(),{isIterateRoute:c}=no,l=po(no,["isIterateRoute"]),_=ys(),{apiDocTree:f}=ne(_),u=re(),y=we(),{isManager:E,isDeveloper:p,projectInfo:k}=ne(u),A=vs,j=N(null),P=N(null),R=N(null),F=N(),w=N(null),G=N(null);let z=1;const X=null,b=$e(()=>i.value.name===Le||i.value.name===Ie);he(()=>o.params.node_id,()=>Je());const V=(L,x,oe)=>{if(oe.target.tagName!=="INPUT"){if(x.isLeaf){q(x);return}L.expanded=!L.expanded}},q=L=>{const{node_id:x}=i.value.params;b.value&&L.id===parseInt(x,10)||(Je(L.id),n.push({name:y.isIterateRoute?ze:Le,params:H(D({},r),{node_id:L.id})}))},le=(L,x,oe,de)=>{L.stopPropagation(),j.value=oe.id,jt.show(de,L.target,{node:x,source:oe,isDetailPage:b.value},G.value)},He=L=>{var x;le(L,(x=R.value)==null?void 0:x.root,f.value,"DIR_NEW_TYPE")},lt=Ws(function(L){let x=0;return Re(oe=>{oe.isLeaf||x++},[L],{subKey:"sub_nodes"}),x}),Et=(L,x,oe)=>{const{data:de}=x,{data:se}=L;return de.isLeaf&&oe==="inner"?!1:!se.isLeaf&&!de.isLeaf?lt(se)+x.level<=5:!0},I=L=>{const x=[L.isLeaf?"is-doc":"is-dir"];return L.selected===!1&&x.push("hidden"),x.join(" ")},K=L=>L.type===xe.DOC,ye=async()=>{var L;await mt(),P.value&&(fo(P.value,{scrollMode:"if-needed"}),P.value.focus(),P.value.setSelectionRange(0,(L=P.value)==null?void 0:L.value.length))},De=L=>{L.target&&L.target.blur()},Ns=Ut(function(L,x){if(x.isEditable=!1,!L.target.value&&x._oldName){x.title=x._oldName;return}const oe=x.type===xe.DIR,de=oe?ul:Sa,se={project_id:k.value.id,title:x.title};se[oe?"node_id":"doc_id"]=x.id,de(se).then(()=>{delete x._oldName}).catch(()=>{x._oldName&&(x.title=x._oldName)})},200),Je=L=>{var ro,ao;Re(co=>{if(co.isCurrent)return co.isCurrent=!1,!1},f.value,{subKey:"sub_nodes"});const{node_id:x}=i.value.params,de=parseInt(L||x,10),se=(ro=R.value)==null?void 0:ro.getNode(de);se&&(se.data.isCurrent=!0,(ao=R.value)==null||ao.setCurrentKey(de));const io=document.querySelector("#tree_node_"+de);io&&fo(io,{scrollMode:"if-needed"})},so=()=>{if(!R.value)return;let L=!1;if(Re(x=>{if(x.isCurrent)return L=!0,!1},f.value,{subKey:"sub_nodes"}),!L){let x=null;Re(de=>{let se=R.value.getNode(de.id);if(c){if(se&&se.data.isLeaf&&se.data.selected)return x=se,!1}else if(se&&se.data.isLeaf)return x=se,!1},f.value,{subKey:"sub_nodes"}),x?(r.node_id=x.key,Je(x.key)):(r.node_id="",me());const oe=G.value;oe==null||oe.scrollTo(0,0),n.replace({name:y.isIterateRoute?ze:Le,params:r})}},ws=async()=>{const L=await _.getApiDocTree(Ce(l));(!L||!L.length)&&me()};return et(async()=>{await ws(),r.node_id?Je():so()}),{isManager:E,isDeveloper:p,router:n,index:z,oldDraggingNodeInfo:X,params:r,projectInfo:k,publicParams:l,isIterateRoute:c,apiDocTree:f,renameInput:P,dir:G,activeMoreNodeId:j,treeIns:R,newMenus:A,documentShareModal:e,createDocIcon:gs,handleTreeNodeClick:V,onRootMoreIconClick:He,onMoreIconClick:le,allowDrop:Et,customNodeClass:I,customNodeLeaf:K,onEnterKeyUp:De,setUnEditable:Ns,inputFocus:ye,activeNode:Je,reactiveNode:so,documentImportModal:t,projectExportModal:s,searchDocumentPopoverRef:w,searchIconRef:F}},mounted(){jt.onPopperItemClick=({menu:e,node:t,source:s})=>this.onPopperItemClick(e,t,s),jt.onPopperHide=()=>{this.activeMoreNodeId=null}},methods:{onPopperItemClick(e,t,s){const o=this[e.onClick];o&&o(t||this.treeIns.root,s||{sub_nodes:this.apiDocTree,id:0},e)},onRenameBtnClick(e,t){t._oldName=t.title,t.isEditable=!0,this.inputFocus()},onDeleteBtnClick(e,t){let s=!t.isLeaf;es({title:"\u5220\u9664\u63D0\u793A",content:h("div",{class:"break-all"},[Y("\u786E\u5B9A\u5220\u9664\u300C"),t.title,Y("\u300D"),s?"\u5206\u7C7B":"\u6587\u6863",Y("\u5417\uFF1F")]),onOk:()=>{const o=t.type===xe.DIR,n=o?dl:Ra;let i=D({},Ce(this.publicParams));return i[o?"node_id":"doc_id"]=t.id,n(i).then(r=>{fe.success(r.msg||"\u5220\u9664\u6210\u529F\uFF01"),this.treeIns.remove(e),this.reactiveNode()})}})},onCreateDirBtnClick(e,t){let s=H(D({},Ce(this.publicParams)),{name:"\u65B0\u5EFA\u5206\u7C7B"+this.index++});t.id&&(s.parent_id=t.id,s.pid=t.id),Ee.start(),ll(s).then(o=>{const n=ut(o.data,xe.DIR);!e.parent&&e.level===0?t.unshift(n):!t.sub_nodes||!t.sub_nodes.length?this.treeIns.append(n,e):this.treeIns.insertBefore(n,t.sub_nodes[0]),this.$nextTick(()=>{const i=this.treeIns.getNode(t);i&&(i.expanded=!0);const r=this.treeIns.getNode(o.data);r.data.isEditable=!0,setTimeout(()=>this.inputFocus(),100)})}).finally(()=>{Ee.done()})},createDoc(e,t){let s=H(D({},Ce(this.publicParams)),{parent_id:e.key,pid:e.key});Ee.start(),Da(s).then(({data:o})=>{this.treeIns.append(ut(o),e),this.$nextTick(()=>{this.treeIns.setCurrentKey(o.id);const n=this.treeIns.getNode(t);n&&(n.expanded=!0),this.router.push({name:this.isIterateRoute?Ie:Te,params:H(D({},this.params),{node_id:o.id}),query:{isNew:!0}}),this.activeNode(o.id)})}).finally(()=>{Ee.done()})},onMoveNodeStart(e){const t=e.parent;this.oldDraggingNodeInfo={oldPid:t.id===0?null:t.key,oldChildIds:t.childNodes.filter(s=>s.id!==e.id).map(s=>s.key)}},onMoveNode(e,t,s){if(!this.oldDraggingNodeInfo)return;const{oldPid:o,oldChildIds:n}=this.oldDraggingNodeInfo;let i=o===t.parent.id&&s!=="inner";const r=this.treeIns.getNode(e.data).parent,c=r.id===0?null:r.key,l=r.childNodes.map(f=>f.key),_={oldPid:i?c:o,oldChildIds:i?l:n,newPid:c,newChildIds:l};this.oldDraggingNodeInfo=null,pl({new_pid:_.newPid||0,new_node_ids:_.newChildIds,old_pid:_.oldPid||0,old_node_ids:_.oldChildIds,project_id:this.projectInfo.id})},onCopyBtnClick(e,t){Ee.start(),ja(H(D({},Ce(this.publicParams)),{doc_id:t.id})).then(({data:s})=>{this.treeIns.insertAfter(ut(s),e),this.router.push({name:this.isIterateRoute?Ie:Te,params:H(D({},this.params),{node_id:s.id})})}).finally(()=>{Ee.done()})},onShareBtnClick(e,t){this.documentShareModal.show({docId:t.id,nodeId:t.id})},onImportBtnClick(e,t){this.documentImportModal.show(H(D({},Ce(this.publicParams)),{parent_id:t.id?t.id:0}),Oa)},onExportBtnClick(e,t){this.projectExportModal.title="\u5BFC\u51FA\u6587\u6863",this.projectExportModal.show({project_id:this.projectInfo.id,doc_id:t.id},fs)},updateTreeNode(e,t={title:""}){let s=this.treeIns.getNode(e);s&&s.data.title&&(s.data.title=t.title||s.title)},createHttpDoc(e,t){let s=H(D({},Ce(this.publicParams)),{parent_id:e.key,pid:e.key});Ee.start(),Pa(s).then(({data:o})=>{this.treeIns.append(ut(o),e),this.$nextTick(()=>{const n=this.treeIns.getNode(t);n&&(n.expanded=!0),this.router.push({name:this.isIterateRoute?Ie:Te,params:H(D({},this.params),{node_id:o.id}),query:{isNew:!0}})})}).finally(()=>{Ee.done()})}}});const zl={class:"flex flex-col h-full"},Hl={class:"ac-doc-catalog"},Jl=a("h3",{class:"text-base font-medium"},"\u76EE\u5F55",-1),Yl={class:"flex-auto overflow-x-scroll scroll-content",ref:"dir"},Wl=a("div",{class:"el-tree-node__bg"},null,-1),ql=["onClick"],Zl=["id"],Xl=["src"],Ql=["title"],ed=["id","onUpdate:modelValue","maxlength","onBlur"],td=a("span",{class:"mx-1"},null,-1);function od(e,t,s,o,n,i){const r=Q("Search"),c=Be,l=Q("Plus"),_=Q("plus"),f=Q("more-filled"),u=Q("ac-tree"),y=Q("SearchDocumentPopover");return d(),g(U,null,[a("div",zl,[a("div",Hl,[Jl,a("div",null,[h(c,{class:M(["cursor-pointer text-zinc-500",{"mr-5":e.isManager||e.isDeveloper}]),ref:"searchIconRef"},{default:m(()=>[h(r)]),_:1},8,["class"]),e.isManager||e.isDeveloper?(d(),B(c,{key:0,class:"cursor-pointer text-zinc-500",onClick:e.onRootMoreIconClick},{default:m(()=>[h(l)]),_:1},8,["onClick"])):T("",!0)])]),a("div",Yl,[h(u,{data:e.apiDocTree,class:"bg-transparent","node-key":"id","empty-text":"",draggable:e.isManager||e.isDeveloper,ref:"treeIns","expand-on-click-node":!1,props:{children:"sub_nodes",label:"title",class:e.customNodeClass,isLeaf:e.customNodeLeaf},"allow-drop":e.allowDrop,onNodeDragStart:e.onMoveNodeStart,onNodeDrop:e.onMoveNode},{default:m(({node:E,data:p})=>[Wl,a("div",{class:M(["flex justify-between ac-tree-node",{"is-editable":p.isEditable}])},[a("div",{class:"ac-tree-node__main",onClick:k=>e.handleTreeNodeClick(E,p,k)},[a("div",{class:M(["ac-doc-node",{"is-active":p.isCurrent}]),id:"tree_node_"+p.id},[p.isLeaf?(d(),g("img",{key:0,class:"ac-doc-node__icon",src:e.createDocIcon},null,8,Xl)):T("",!0),te(a("span",{class:"ac-doc-node__label",title:p.title},$(p.title),9,Ql),[[pe,!p.isEditable]]),p.isEditable?te((d(),g("input",{key:1,type:"text",ref:"renameInput",class:"ac-doc-node__input el-input el-input__inner",id:"tree_input_"+p.id,"onUpdate:modelValue":k=>p.title=k,onKeyup:t[0]||(t[0]=So((...k)=>e.onEnterKeyUp&&e.onEnterKeyUp(...k),["enter"])),maxlength:p.isLeaf?255:50,onBlur:k=>e.setUnEditable(k,p)},null,40,ed)),[[jo,p.title]]):T("",!0)],10,Zl)],8,ql),e.isManager||e.isDeveloper?(d(),g("div",{key:0,class:M(["ac-tree-node__more",{active:p.id===e.activeMoreNodeId}])},[te(h(c,{onClick:k=>e.onMoreIconClick(k,E,p,"DIR_NEW_TYPE")},{default:m(()=>[h(_)]),_:2},1032,["onClick"]),[[pe,!p.isLeaf]]),td,te(h(c,{onClick:k=>e.onMoreIconClick(k,E,p,"DIR_OPERATE_TYPE")},{default:m(()=>[h(f)]),_:2},1032,["onClick"]),[[pe,!p.isLeaf]]),te(h(c,{onClick:k=>e.onMoreIconClick(k,E,p,"DOC_OPERATE_TYPE")},{default:m(()=>[h(f)]),_:2},1032,["onClick"]),[[pe,p.isLeaf]])],2)):T("",!0)],2)]),_:1},8,["data","draggable","props","allow-drop","onNodeDragStart","onNodeDrop"])],512)]),h(y,{ref:"searchDocumentPopoverRef","virtual-ref":e.searchIconRef},null,8,["virtual-ref"])],64)}var sd=Z(Gl,[["render",od]]);const nd=(e={})=>Lt.post("/upload_path",e),St={},Zu=e=>new Promise((t,s)=>{const o={complete:!1,width:0,height:0,src:e};if(!e){s(o);return}if(St[e]){t(D({},St[e]));return}const n=new Image;n.onload=()=>{o.width=n.width,o.height=n.height,o.complete=!0,St[e]=D({},o),t(o)},n.onerror=()=>{s(o)},n.src=e});function _e(){this.chunkSize=1024*1024,this.threadsQuantity=2,this.timeout=1e3*10,this.file=null,this.aborted=!1,this.uploadedSize=0,this.progressCache={},this.activeConnections={},this.taskConfig={}}_e.prototype.setOptions=function(e={}){this.chunkSize=e.chunkSize||this.chunkSize,this.threadsQuantity=e.threadsQuantity||this.threadsQuantity};_e.prototype.setupFile=function(e){!e||(this.file=e)};_e.prototype.start=function(){if(!this.file)throw new Error("Can't start uploading: file have not chosen");const e=Math.ceil(this.file.size/this.chunkSize);this.chunksQueue=new Array(e).fill().map((o,n)=>n).reverse();const t=new XMLHttpRequest;t.timeout=this.timeout,t.open("post","/api/upload_init"),t.setRequestHeader("Content-Type","application/json;charset=UTF-8"),t.setRequestHeader("Accept","application/json, text/plain, */*");let s=S.get(S.KEYS.TOKEN)||"";s&&t.setRequestHeader("Authorization",s),t.withCredentials=!0,t.onreadystatechange=()=>{if(t.readyState===XMLHttpRequest.DONE&&t.status===200){const{status:o,msg:n,data:i}=JSON.parse(t.responseText);if(o!==0){this.complete(new Error(n||"\u4E0A\u4F20\u521D\u59CB\u5316\u5931\u8D25\uFF01"));return}this.fileId=i.file_id,this.sendNext()}},t.onerror=o=>{this.complete(o)},t.ontimeout=o=>{this.complete(o)},t.send(JSON.stringify({name:this.file.name,chunks:e,fileSize:Math.ceil(this.file.size/1024)}))};_e.prototype.sendNext=function(){const e=Object.keys(this.activeConnections).length;let t=!1;if(Object.keys(this.taskConfig).forEach(i=>{this.taskConfig[i].retryCount>=3&&(t=!0)}),t){this.complete(new Error("\u4E0A\u4F20\u5931\u8D25\uFF01"));return}if(e>=this.threadsQuantity)return;if(!this.chunksQueue.length){e||this.getResult();return}const s=this.chunksQueue.pop(),o=s*this.chunkSize,n=this.file.slice(o,o+this.chunkSize);this.sendChunk(n,s).then(()=>this.sendNext()).catch(i=>{this.chunksQueue.push(s);let r=this.taskConfig[s];r&&r.retryCount<=3?this.sendNext():this.complete(i)}),this.sendNext()};_e.prototype.complete=function(e){const t=e&&e.message||e;if(e&&!this.aborted){this.end(t);return}this.end(t)};_e.prototype.sendChunk=function(e,t){return this.upload(t,e)};_e.prototype.handleProgress=function(e,t){(t.type==="progress"||t.type==="error"||t.type==="abort")&&(this.progressCache[e]=t.loaded),t.type==="loadend"&&(this.uploadedSize+=this.progressCache[e]||0,delete this.progressCache[e]);const s=Object.keys(this.progressCache).reduce((n,i)=>n+=this.progressCache[i],0),o=Math.min(this.uploadedSize+s,this.file.size);this.onProgress&&this.onProgress({loaded:o,total:this.file.size})};_e.prototype.upload=function(e,t){return new Promise((s,o)=>{let n=this.taskConfig[e]=this.taskConfig[e]||{retryCount:0};const i=this.activeConnections[e]=new XMLHttpRequest;i.timeout=this.timeout;const r=this.handleProgress.bind(this,e);i.upload.addEventListener("progress",r),i.addEventListener("error",r),i.addEventListener("abort",r),i.addEventListener("loadend",r),i.open("post","/api/upload_save"),i.setRequestHeader("Accept","application/json, text/plain, */*");let c=S.get(S.KEYS.TOKEN)||"";c&&i.setRequestHeader("Authorization",c),i.onreadystatechange=()=>{if(delete this.activeConnections[e],i.readyState===XMLHttpRequest.DONE&&i.status===200){const _=JSON.parse(i.responseText);if(_.status!==0){o(new Error(_.msg||"\u4E0A\u4F20\u5931\u8D25\uFF01")),n.retryCount++;return}_.status===0&&s(_)}i.readyState===XMLHttpRequest.DONE&&i.status!==200&&(o(new Error("\u4E0A\u4F20\u5931\u8D25\uFF01")),n.retryCount++)},i.onerror=_=>{o(_),delete this.activeConnections[e]},i.onabort=()=>{o(new Error("\u53D6\u6D88\u4E0A\u4F20\uFF01")),delete this.activeConnections[e]},i.ontimeout=_=>{o(_),delete this.activeConnections[e]};let l=new FormData;l.append("file_id",this.fileId),l.append("chunk_id",e),l.append("file",t),i.send(l)})};_e.prototype.on=function(e,t){typeof t!="function"&&(t=We),this[e]=t};_e.prototype.abort=function(){Object.keys(this.activeConnections).forEach(e=>{this.activeConnections[e].abort()}),this.aborted=!0};_e.prototype.getResult=function(){nd({file_id:this.fileId}).then(e=>this.end(null,e)).catch(e=>this.complete(e))};const id=function(){const e=new _e;return{options:function(t){return e.setOptions(t),this},send:function(t){return e.setupFile(t),this},continue:function(){e.sendNext()},onProgress:function(t){return e.on("onProgress",t||We),this},end:function(t){return e.on("end",t||We),e.start(),this},abort:function(){e.abort()}}};const rd={props:{maxSize:{type:Number,default:1},multiple:{type:Boolean,default:!1}},data(){return{isShow:!1,isLoading:!1,isPoll:!1,title:"\u5BFC\u5165\u6587\u6863",params:{},jobParams:{id:null},importList:[],currentConfig:null,timer:null}},methods:{projectItemClass(e){return["ac-project-export-item","ac-project-export-file",{disabled:e.disabled}]},hide(){this.isShow=!1},show(e,t){this.clearTimer(),this.isShow=!0,this.importList=t||[],this.params=e||{}},onFileChange(e,t){this.currentConfig=t||{},this.validFile(e)&&this.upload()},validFile(e){const t=e.target.files;if(!t)return!1;let s=Array.prototype.slice.call(t);if(this.multiple||(s=s.slice(0,1)),s.length===0)return!1;let o=s[0];e.target.value=null;let{maxSize:n}=this.currentConfig;return n=n||this.maxSize,o.size>n*1024*1024?(this.$Message.error(`\u6587\u4EF6\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC7${n}MB`),!1):(this.currentConfig.file=o,!0)},upload(){if(!this.currentConfig||!this.currentConfig.file)return this.$Message.error("\u672A\u9009\u62E9\u6587\u4EF6\uFF01");this.isLoading=!0,id().options().send(this.currentConfig.file).end((e,t)=>{if(e){this.isLoading=!1,this.$Message.error(e instanceof Error?e.message:e);return}this.currentConfig.fileUrl=t.data,this.getImportJobId(this.buildParams())})},getImportJobId(e){if(!this.currentConfig||!this.currentConfig.action)return this.isLoading=!1,Promise.resolve();this.currentConfig.action(e).then(t=>{this.jobParams.id=t.data||null,this.isPoll=!0,this.getExecResult()}).catch(()=>{this.isLoading=!1})},clearTimer(){this.currentConfig=null,this.isLoading=!1,this.isPoll=!1},async exec(){if(!this.currentConfig||!this.currentConfig.getJobResult||!this.jobParams.id)return this.clearTimer(),Promise.resolve();try{const{data:e,msg:t}=await this.currentConfig.getJobResult(this.params.project_id,this.jobParams.id);if(e.result===Ve.FAIL){this.$Message.error(t||"\u5BFC\u5165\u5931\u8D25\uFF01"),this.clearTimer();return}if(e.result===Ve.WAIT)return;e.result===Ve.FINISH&&(this.$Message.success(t||"\u5BFC\u5165\u5B8C\u6210\uFF01"),this.clearTimer(),this.hide(),location.reload())}catch{this.clearTimer()}},async getExecResult(){for(;this.isPoll;)await this.exec(),await wo(2e3)},buildParams(){return this.currentConfig?H(D({},this.params),{filename:this.currentConfig.file?this.currentConfig.file.name:"\u672A\u547D\u540D",file:this.currentConfig.fileUrl,type:this.currentConfig.type}):{}}}},ad={class:"ac-project-export","element-loading-text":"\u5BFC\u5165\u4E2D\uFF0C\u8BF7\u52FF\u5173\u95ED\u7A97\u53E3\uFF01"},cd={class:"ac-project-export-inner"},ld=["src","alt"],dd={class:"mt-1.5"},ud=["onChange","accept"];function pd(e,t,s,o,n,i){const r=ot,c=nt;return d(),B(r,{modelValue:n.isShow,"onUpdate:modelValue":t[0]||(t[0]=l=>n.isShow=l),width:"fit-content",class:"vertical-center-modal","close-on-click-modal":!1,title:n.title,"append-to-body":""},{default:m(()=>[te((d(),g("div",ad,[(d(!0),g(U,null,ie(n.importList,l=>(d(),g("div",{class:M(i.projectItemClass(l)),key:l.type},[a("div",cd,[a("img",{src:l.icon,alt:l.text},null,8,ld),a("p",dd,$(l.text),1),a("input",{type:"file",onChange:_=>i.onFileChange(_,l),accept:l.accept},null,40,ud)])],2))),128))])),[[c,n.isLoading]])]),_:1},8,["modelValue","title"])}var hd=Z(rd,[["render",pd],["__scopeId","data-v-5eb02cdd"]]);const fd={class:"ac-doc-layout__left"},_d={class:"ac-doc-layout__right scroll-content"},bs=ee({setup(e){const{currentRoute:t}=tt(),s=re(),{isGuest:o,isReader:n,isManager:i,isDeveloper:r,projectInfo:c}=ne(s),l=we(),{isIterateRoute:_,iterateInfo:f}=ne(l),u=N(),y=N(),E=N(),p=N(),k=N(""),A=$e(()=>["ac-doc-layout",{readonly:o.value||n.value}]),j=$e(()=>!isNaN(parseInt(t.value.params.node_id,10))),P=`<template id="template-zoom-image">
                            <div class="zoom-image-wrapper">
                                <div class="zoom-image-container" data-zoom-container></div>
                            </div>
                          </template>`;return ue("documentShareModal",E),ue("projectExportModal",u),ue("documentImportModal",y),ue("updateTreeNode",(R,F)=>p.value&&p.value.updateTreeNode(R,F)),ue("setDocumentTitle",R=>{document.title=c.value.name+(_.value?`(${f.value.title})`:"")+"-"+R,k.value=R}),(R,F)=>{const w=Q("router-view"),G=ba;return d(),g(U,null,[v(c)?(d(),g("main",{key:0,class:M(v(A))},[v(o)?(d(),B(Nc,{key:0})):(d(),B(Ec,{key:1})),v(j)?(d(),g(U,{key:2},[v(i)||v(r)?(d(),B(Mc,{key:0,title:k.value},null,8,["title"])):T("",!0)],64)):T("",!0),a("div",fd,[h(sd,{ref_key:"directoryTree",ref:p},null,512)]),a("div",_d,[h(w)])],2)):T("",!0),a("div",{innerHTML:P}),h(G,{ref_key:"projectExportModal",ref:u},null,512),h(hd,{ref_key:"documentImportModal",ref:y},null,512),h(qa,{ref_key:"documentShareModal",ref:E},null,512)],64)}}}),md=()=>W(()=>import("./DocumentDetail.84714abd.js"),["assets/DocumentDetail.84714abd.js","assets/element-plus.aa12b6bd.js","assets/element-plus.8e6ef202.css","assets/vendor.b7ec7f69.js","assets/medium-zoom.esm.370ffa3b.js"]),gd=()=>W(()=>import("./DocumentEditor.d50b8c1d.js"),["assets/DocumentEditor.d50b8c1d.js","assets/DocumentEditor.b68616fa.css","assets/element-plus.aa12b6bd.js","assets/element-plus.8e6ef202.css","assets/vendor.b7ec7f69.js","assets/params.b7b3bcd7.js"]),Xu=ae(Qt);ae(Go);var vd={path:Sn,name:Xt,component:bs,redirect:{name:Le},children:[{path:Qt,name:Le,meta:{ignoreAuth:!0},component:md},{path:Go,name:Te,component:gd}]};const yd=()=>W(()=>import("./DocumentDetail.84714abd.js"),["assets/DocumentDetail.84714abd.js","assets/element-plus.aa12b6bd.js","assets/element-plus.8e6ef202.css","assets/vendor.b7ec7f69.js","assets/medium-zoom.esm.370ffa3b.js"]),Ed=()=>W(()=>import("./DocumentEditor.d50b8c1d.js"),["assets/DocumentEditor.d50b8c1d.js","assets/DocumentEditor.b68616fa.css","assets/element-plus.aa12b6bd.js","assets/element-plus.8e6ef202.css","assets/vendor.b7ec7f69.js","assets/params.b7b3bcd7.js"]);var Cd={path:zo,name:Ho,component:bs,redirect:{name:ze},children:[{path:Yo,name:ze,component:yd},{path:Jo,name:Ie,component:Ed}]};const kd=ee({setup(e){return(t,s)=>{const o=Be,n=yn;return d(),B(n,qs(t.$attrs,{class:"ac-backtop"}),{default:m(()=>[h(o,null,{default:m(()=>[h(v(En))]),_:1})]),_:1},16)}}});var Ad=Z(kd,[["__scopeId","data-v-de5b7756"]]);const Id={name:"ProjectSearch",data(){return{data:[],isLoading:!1,isNoData:!1,isShowSearchResult:!1,form:{token:S.get(S.KEYS.SECRET_PROJECT_TOKEN+this.$route.params.project_id||"",!0),project_id:this.$route.params.project_id,keywords:""}}},methods:{onClickSearchResult(e){let t=!1;Re(s=>{if(s.id===(e.node_id||e.doc_id))return t=!0,!1},[]),t?this.$router.push(e.link):location.href=e.href},onStop(e){e.stopPropagation()},onSearchDocument:Ut(function(){!Zs(Ro(this.form.keywords))&&this.form.keywords.length>=2&&(this.isLoading=!0,this.data=[],this.isShowSearchResult=!0,Ka(this.form.token,this.form.project_id,this.form.keywords).then(e=>{this.data=(e.data||[]).map(t=>(t.link={name:"preview.project.document",params:{project_id:this.form.project_id,node_id:t.node_id||t.doc_id}},t.href=`/app/${this.form.project_id}/${t.node_id||t.doc_id}`,t)),this.isNoData=!this.data.length}).finally(()=>{this.isLoading=!1}))},300)},created(){document.body.addEventListener("click",e=>{this.data=[],this.form.keywords="",this.isShowSearchResult=!1})}},bd={class:"search-popper-input"},Nd=a("i",{class:"icon iconfont iconsousuo"},null,-1),wd={style:{padding:"10px","text-align":"center"}},Dd={key:0},Pd=["onClick","title"],jd={key:1,class:"result p-2"},Sd=a("div",{class:"result-icon"},[a("img",{src:ks,alt:""})],-1),Rd=a("span",null,"\u672A\u627E\u5230\u641C\u7D22\u7ED3\u679C\uFF01",-1),xd=[Sd,Rd];function Td(e,t,s,o,n,i){return d(),g("div",{class:"search-popper",onClick:t[3]||(t[3]=(...r)=>i.onStop&&i.onStop(...r))},[a("div",bd,[te(a("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=r=>n.form.keywords=r),placeholder:"\u641C\u7D22",maxlength:"255",onKeyup:t[1]||(t[1]=So((...r)=>i.onSearchDocument&&i.onSearchDocument(...r),["enter"]))},null,544),[[jo,n.form.keywords]]),Nd]),te(a("div",{class:"search-popper-result scroll-content",onClick:t[2]||(t[2]=(...r)=>i.onStop&&i.onStop(...r))},[te(a("div",wd,"\u641C\u7D22\u4E2D...",512),[[pe,n.isLoading]]),n.data.length?(d(),g("ul",Dd,[(d(!0),g(U,null,ie(n.data,r=>(d(),g("li",{key:r.node_id},[a("a",{href:"javascript:void(0);",onClick:c=>i.onClickSearchResult(r),title:r.title},$(r.title),9,Pd)]))),128))])):T("",!0),n.isNoData?(d(),g("div",jd,xd)):T("",!0)],512),[[pe,n.isShowSearchResult]])])}var Ld=Z(Id,[["render",Td]]);const Od={name:"PreviewHeader",props:{isShowSearch:{type:Boolean,default:!0}},components:{ProjectSearch:Ld}},$d={class:"header header-fixed"},Md=Xs('<a class="logo" href="/"><img src="'+rt+'" alt="ApiCat"><span class="logo"><span class="logo-text logo-apicat">ApiCat</span></span></a><ul class="header-nav"></ul>',2);function Bd(e,t,s,o,n,i){const r=Q("project-search");return d(),g("header",$d,[Md,s.isShowSearch?(d(),B(r,{key:0})):T("",!0)])}var Fd=Z(Od,[["render",Bd]]);const oo=ee({setup(e){const t=N(!0),s=N(!0),o=i=>{t.value=i},n=i=>{s.value=i};return ue("showSearchInput",o),ue("showHeader",n),(i,r)=>{const c=Q("router-view"),l=Ad;return d(),g(U,null,[s.value?(d(),B(Fd,{key:0,"is-show-search":t.value},null,8,["is-show-search"])):T("",!0),h(c),h(l,{bottom:100,right:100})],64)}}}),Kd=()=>W(()=>import("./ProjectVerification.5805b833.js"),["assets/ProjectVerification.5805b833.js","assets/element-plus.aa12b6bd.js","assets/element-plus.8e6ef202.css","assets/vendor.b7ec7f69.js","assets/img_join.8db8ddd5.js"]),Vd=()=>W(()=>import("./DocumentPreview.d9c0dce3.js"),["assets/DocumentPreview.d9c0dce3.js","assets/AcEditorDocument.3e5980dd.js","assets/vendor.b7ec7f69.js","assets/medium-zoom.esm.370ffa3b.js","assets/element-plus.aa12b6bd.js","assets/element-plus.8e6ef202.css"]),Ud=()=>W(()=>import("./DocumentVerification.bc95b8e2.js"),["assets/DocumentVerification.bc95b8e2.js","assets/element-plus.aa12b6bd.js","assets/element-plus.8e6ef202.css","assets/vendor.b7ec7f69.js","assets/img_join.8db8ddd5.js"]),Gd=()=>W(()=>import("./TrashDocumentPreview.d1cb0291.js"),["assets/TrashDocumentPreview.d1cb0291.js","assets/element-plus.aa12b6bd.js","assets/element-plus.8e6ef202.css","assets/vendor.b7ec7f69.js","assets/AcEditorDocument.3e5980dd.js","assets/medium-zoom.esm.370ffa3b.js"]);ae("/app/:project_id");const Qu=ae("/doc/:project_id/trash_api_preview/:doc_id"),zd={path:"/doc",name:Ze,component:oo,meta:{ignoreAuth:!0},children:[{path:"/doc/:doc_id",name:`${Ze}.detail`,component:Vd,meta:{ignoreAuth:!0}},{path:"/doc/:doc_id/verification",name:gt,component:Ud,meta:{ignoreAuth:!0}}]},Hd={path:"/app",name:qt,component:oo,meta:{ignoreAuth:!0},children:[{path:"/app/:project_id/verification",name:Zt,component:Kd,meta:{ignoreAuth:!0}}]},Jd={path:"/doc/:project_id/trash_api_preview/:doc_id",name:"preview.trash",component:oo,children:[{path:"",name:"preview.trash.document",component:Gd}]};function Yd(e){e.beforeEach(async(t,s,o)=>{const i=be().isLogin;if(t.meta.ignoreAuth){if(i&&(t.path===qe||t.path===Wt)){o(it);return}o();return}if(!i){o({path:qe,replace:!0});return}o()})}function Wd(e){e.beforeEach(async(t,s,o)=>{const n=re();if(!yo.some(r=>r.name===t.name)||n.projectInfo&&t.params.project_id===String(n.projectInfo.id))return o();let i=null;Is();try{const r=parseInt(t.params.project_id),c=await n.getProjectDetail(r);yo.filter(f=>f.meta.role.indexOf(c.authority)!==-1).some(f=>f.name===t.name)||(i=Ne),await n.getProjectAuth(r)}catch{i=Ne}finally{me()}return i?o(i):o()})}const qd=e=>{e.beforeEach(async(t,s,o)=>{const n=re();if(!t.matched.find(r=>r.name===Xt))return o();const i=parseInt(t.params.project_id,10);if(n.projectAuthInfo&&n.projectAuthInfo.id===i)return o();try{const r=await n.getProjectAuth(i);if(!r||!r.id)return Ot(),!1}catch{return!1}return o()})},Zd=e=>{e.beforeEach(async(t,s,o)=>{const n=re();if(!t.matched.find(r=>r.name===Xt))return o();const i=parseInt(t.params.project_id,10);if(n.projectInfo&&n.projectInfo.id===i)return o();try{await n.getProjectDetail(i)}catch{return!1}return o()})};function Xd(e){e.beforeEach(async(t,s,o)=>t.name===Te&&re().isReader?(me(),o(Ne)):o())}function Qd(e){e.beforeEach(async(t,s,o)=>{const{name:n,params:i}=t;if(n===Le){const r=re(),{isLogin:c}=be(),l=!!S.get(S.KEYS.SECRET_PROJECT_TOKEN+i.project_id,!0),{projectAuthInfo:_,isPrivate:f}=ne(r),{has_shared:u,in_this:y}=v(_),E=v(f);if(!E){o();return}if(c&&y){o();return}if(!c&&E&&!u){me(),o(Ne);return}if(E&&!u&&c&&!y){me(),o(Ne);return}if(E&&!u&&c&&y){o();return}if(E&&u&&!l){me(),o({name:Zt,params:{project_id:i.project_id}});return}if(E&&u&&l){o();return}return me(),o(Ne)}return o()})}const eu=e=>{e.beforeEach(async(t,s,o)=>{const n=re(),i=we();if(i.isIterateRoute=!1,!t.matched.find(c=>c.name===Ho))return o();i.isIterateRoute=!0;const r=t.params.iterate_id;if(i.iterateInfo&&i.iterateInfo.id===r)return o();try{const c=await i.getIterateInfo(r);if(!c||!c.id)return Ot(),!1;const l=await n.getProjectDetailById({iteration_id:r});if(!l||!l.id)return Ot(),!1;await n.getProjectAuth(l.id)}catch{return!1}return o()})};function tu(e){e.beforeEach(async(t,s,o)=>{const{name:n}=t;if(n===ze){const i=re(),{projectAuthInfo:r,isPrivate:c}=ne(i),{has_shared:l,in_this:_}=v(r),f=v(c),{isLogin:u}=be();if(!f){o();return}if(u&&_){o();return}if(!u&&f&&!l||f&&!l&&u&&!_)return!1;if(f&&!l&&u&&_){o();return}return!1}return o()})}function ou(e){e.beforeEach(async(t,s,o)=>t.name===Ie&&re().isReader?!1:o())}function su(e){e.beforeEach(async(t,s,o)=>{const{name:n,params:i}=t,r=!!S.get(S.KEYS.SECRET_DOCUMENT_TOKEN+i.doc_id,!0);if(String(n).startsWith(Ze)){if(!Qs(i.doc_id))return o(Ne);Is();const{data:c}=await Ma(i.doc_id);return c?n===gt?(me(),o()):r?o():(me(),o({name:gt,params:{doc_id:i.doc_id}})):(me(),o(Ne))}o()})}const nu=e=>{Yd(e),qd(e),Xd(e),Qd(e),Zd(e),su(e),Wd(e),eu(e),tu(e),ou(e)},Ae=en({history:tn("/"),routes:[ia,ra,aa,vd,Cd,{path:it,name:"main",component:Ir,redirect:{name:"projects"},children:[ji,pa,er,va,Xi]},Hd,zd,Jd,ca]});var iu=e=>{e.use(fe),e.use(Ht),e.use(gi),e.use($o),e.config.globalProperties.$Message=fe};const ru=function(e){e.mixin({mounted:function(){e.__clipboard__&&e.__clipboard__.destroy(),e.__clipboard__=new on(".copy_text",{text:function(t){return Ro(t.getAttribute("data-text")||t.innerText||"")}}),e.__clipboard__.on("success",()=>{fe.closeAll(),fe.success("\u590D\u5236\u6210\u529F")})}})};var au={install:ru};class cu{constructor(){this._pendingMap=new Map}gatherKey(t){return[t.url,t.method,JSON.stringify(t.params)].join("_")}add(t){this.remove(t);const s=vt.CancelToken.source();t.cancelToken=t.cancelToken||s.token;const o=this.gatherKey(t);this._pendingMap.set(o,s.cancel)}remove(t){const s=this.gatherKey(t);if(this._pendingMap.has(s)){const o=this._pendingMap.get(s);o&&_o(o)&&o(),this._pendingMap.delete(s)}}removeAll(){this._pendingMap.forEach(t=>t&&_o(t)&&t()),this.clear()}clear(){this._pendingMap.clear()}}const lu=Me({id:"preview",state:()=>({projectInfo:null,documentInfo:null}),getters:{},actions:{async getProjectInfo(e){const{data:t}=await Fa(e);return this.projectInfo=t||null,this.projectInfo},async getDocumentInfo(e){const t=S.get(S.KEYS.SECRET_DOCUMENT_TOKEN+e,!0)||"",{data:s}=await Ba(e,t);return this.documentInfo=s||null,this.documentInfo},goVerificationPage(){const e=Ae.currentRoute.value.params.project_id||"",t=Ae.currentRoute.value.params.doc_id||"",s=Ae.currentRoute.value.name||"";if(s.includes(qt)){S.remove(S.KEYS.SECRET_PROJECT_TOKEN+e,!0),Ae.push({name:Zt,params:{project_id:e}});return}s.includes(Ze)&&(S.remove(S.KEYS.SECRET_DOCUMENT_TOKEN+t,!0),Ae.push({name:gt,params:{document_id:t}}))}}}),ht=new cu,du=()=>{C.interceptors.request.use(e=>{ht.add(e);const t=be().token;return t&&(e.headers=H(D({},e.headers),{Authorization:t})),e}),C.interceptors.response.use(e=>{ht.remove(e.config);let t="";!e.data&&(e.data={});const s=e.data.status;switch(e.headers.authorization&&be().updateToken(e.headers.authorization),s){case Ke.NO_LOGIN:t="\u767B\u5F55\u72B6\u6001\u5DF2\u5931\u6548\uFF0C\u8BF7\u91CD\u65B0\u767B\u5F55",ht.removeAll(),be().logout();break;case Ke.INVALID_PREVIEW_SECRET:t=e.data.msg||"\u8BBF\u95EE\u79D8\u94A5\u5DF2\u5931\u6548\u3002",ht.removeAll(),lu().goVerificationPage();break;case Ke.OK:case Ke.NO_PARENT_DIR:case Ke.NOT_FOUND:break;default:t=e.data.msg||"\u6570\u636E\u5F02\u5E38\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5\uFF01";break}return t?Promise.reject({message:t}):e.data}),C.interceptors.response.use(void 0,e=>{var i,r;let t="";const{code:s,message:o}=e||{},n=(r=(i=e==null?void 0:e.toString)==null?void 0:i.call(e))!=null?r:"";return t=o,s==="ECONNABORTED"&&t.indexOf("timeout")!==-1&&(t="\u8BF7\u6C42\u8D85\u65F6\uFF0C\u8BF7\u91CD\u8BD5"),n!=null&&n.includes("Network Error")&&(t="\u7F51\u7EDC\u5F02\u5E38\uFF0C\u8BF7\u91CD\u8BD5"),fe.closeAll(),t&&fe.error(t),Promise.reject(e)}),Lt.interceptors.request.use(e=>{const t=be().token;return t&&(e.headers=H(D({},e.headers),{Authorization:t})),e}),Lt.interceptors.response.use(e=>{let t;switch(!e.data&&(e.data={}),e.data.status){case 0:break;default:t=e.data.msg||"\u6570\u636E\u5F02\u5E38\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5\uFF01";break}return t?Promise.reject(t):e.data},e=>(e.message.indexOf("timeout")!==-1&&fe.error("\u8BF7\u6C42\u8D85\u65F6\uFF0C\u8BF7\u91CD\u8BD5\uFF01"),Promise.reject(e)))};du();const ct=sn(jn);ct.use(nn());ct.use(Ae);ct.use(au);nu(Ae);iu(ct);ct.mount("#app");export{me as $,C as A,re as B,yo as C,xe as D,Nu as E,gu as F,Du as G,wu as H,Pu as I,bu as J,Ou as K,qe as L,it as M,ju as N,$a as O,_u as P,qu as Q,Wt as R,eo as S,On as T,Ke as U,Lu as V,Qu as W,_s as X,Ce as Y,Oa as Z,rt as _,be as a,zu as a0,je as a1,wc as a2,Ol as a3,Ad as a4,W as a5,id as a6,Zu as a7,Uu as a8,Gu as a9,Hu as aa,Rc as ab,xc as ac,Dc as ad,Pc as ae,jc as af,Sa as ag,Sc as ah,we as ai,Ru as aj,Bu as ak,Mu as al,hl as am,Ku as an,$u as ao,Su as ap,Fu as aq,Vu as ar,Wu as as,go as at,lu as au,Is as av,Ju as aw,Yu as ax,fu as b,Z as c,Ue as d,es as e,vu as f,mu as g,Xo as h,ku as i,Cu as j,Tu as k,J as l,Eu as m,ba as n,nc as o,li as p,ci as q,Ln as r,yu as s,ke as t,Wo as u,Au as v,Iu as w,hs as x,xu as y,Xu as z};
