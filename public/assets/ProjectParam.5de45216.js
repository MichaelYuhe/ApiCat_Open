var U=Object.defineProperty;var V=Object.getOwnPropertySymbols;var q=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable;var E=(t,e,a)=>e in t?U(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a,b=(t,e)=>{for(var a in e||(e={}))q.call(e,a)&&E(t,a,e[a]);if(V)for(var a of V(e))O.call(e,a)&&E(t,a,e[a]);return t};import{u as R,a as D,d as I,g as Y}from"./params.5984f49b.js";import{b as N,J as B,y as L,d as K}from"./index.6adbff9a.js";import{bu as z,bi as j,a6 as u,ar as A,o as y,S,T as n,_ as l,U as M,c as H,ai as J,F as Z,ak as G,Y as _,d as Q,r as x,ba as W,x as X,a as g,Z as $}from"./vendor.2ee35ec0.js";import{E as ee}from"./element-plus.5b1d6711.js";const P={name:"",type:B.TYPES[0].value,is_must:!0,default_value:"",description:""},te={emits:["on-ok"],directives:{param:{bind:function(t){let e=t.querySelector("input");e.removeEventListener("input",t.handler),t.handler=function(a){a.preventDefault();for(var f=new RegExp("[`~!#%^&*()=|{}':;',<>/?~\uFF01#\uFFE5\u2026\u2026&*\uFF08\uFF09|{}\u3010\u3011\u2018\uFF1B\uFF1A\u201D\u201C'\u3002\uFF0C\u3001\uFF1F]"),o="",r=0;r<this.value.length;r++)o=o+this.value.substr(r,1).replace(f,"");this.value=o.replace(/[^\w\.@$-\[\]]/gi,"")},e.addEventListener("input",t.handler)},unbind:function(t){t.querySelector("input").removeEventListener("input",t.handler)}}},data(){return{isShow:!1,isEdit:!1,isLoading:!1,types:B.TYPES,form:b({},P),rules:{name:{required:!0,message:"\u8BF7\u8F93\u5165\u53C2\u6570\u540D\u79F0",trigger:"blur"}}}},computed:b({},z(L,{project:"projectInfo"})),watch:{isShow:function(){!this.isShow&&this.reset()}},methods:{onChange(t){this.form.name=t.target.value},show(t={}){!j(t)&&(this.form=t),this.isEdit=!j(t),this.isShow=!0},hide(){this.isShow=!1,this.reset(),this.form.name=""},onCloseBtnClick(){this.isShow=!1,this.reset()},reset(){this.form=b({},P),this.$refs.form.resetFields()},handleSubmit(t){this.$refs[t].validate(e=>e&&this.submit())},submit(){this.isLoading=!0;let t=this.isEdit?R:D;this.form.project_id=this.project.id,this.form.param_id=this.form.id||"",t(this.form).then(e=>{this.$Message.success(e.msg||(this.isEdit?"\u4FEE\u6539\u6210\u529F!":"\u6DFB\u52A0\u6210\u529F!")),this.onCloseBtnClick(),this.$emit("on-ok")}).catch(e=>{}).finally(()=>{this.isLoading=!1})}}},oe=_("\u662F\u5426\u5FC5\u9009"),le=_("\u53D6\u6D88"),se=_("\u786E\u5B9A");function ne(t,e,a,f,o,r){const h=u("el-input"),p=u("el-form-item"),C=u("el-option"),v=u("el-select"),i=u("el-checkbox"),d=u("el-form"),c=u("el-button"),m=u("el-dialog"),k=A("param");return y(),S(m,{modelValue:o.isShow,"onUpdate:modelValue":e[8]||(e[8]=s=>o.isShow=s),width:400,"close-on-click-modal":!1,"append-to-body":"","custom-class":"show-footer-line vertical-center-modal",title:(o.isEdit?"\u7F16\u8F91":"\u6DFB\u52A0")+"\u53C2\u6570"},{footer:n(()=>[l(c,{onClick:e[6]||(e[6]=s=>r.onCloseBtnClick())},{default:n(()=>[le]),_:1}),l(c,{loading:o.isLoading,type:"primary",onClick:e[7]||(e[7]=s=>r.handleSubmit("form"))},{default:n(()=>[se]),_:1},8,["loading"])]),default:n(()=>[l(d,{onKeyup:e[5]||(e[5]=G(s=>r.handleSubmit("form"),["enter"])),ref:"form",model:o.form,rules:o.rules,"label-position":"top"},{default:n(()=>[l(p,{label:"\u53C2\u6570\u540D\u79F0",prop:"name",class:"hide_required"},{default:n(()=>[M(l(h,{onOnChange:r.onChange,modelValue:o.form.name,"onUpdate:modelValue":e[0]||(e[0]=s=>o.form.name=s),placeholder:"\u53C2\u6570\u540D\u79F0",maxlength:"100"},null,8,["onOnChange","modelValue"]),[[k]])]),_:1}),l(p,{label:"\u53C2\u6570\u7C7B\u578B",prop:"type"},{default:n(()=>[l(v,{modelValue:o.form.type,"onUpdate:modelValue":e[1]||(e[1]=s=>o.form.type=s),placeholder:"\u53C2\u6570\u7C7B\u578B",class:"w-full"},{default:n(()=>[(y(!0),H(Z,null,J(o.types,s=>(y(),S(C,{value:s.value,key:s.value,label:s.text},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(p,{label:"",prop:"is_must"},{default:n(()=>[l(i,{modelValue:o.form.is_must,"onUpdate:modelValue":e[2]||(e[2]=s=>o.form.is_must=s)},{default:n(()=>[oe]),_:1},8,["modelValue"])]),_:1}),l(p,{label:"\u9ED8\u8BA4\u503C",prop:"default_value",class:"hide_required"},{default:n(()=>[l(h,{modelValue:o.form.default_value,"onUpdate:modelValue":e[3]||(e[3]=s=>o.form.default_value=s),placeholder:"\u9ED8\u8BA4\u503C",maxlength:"255"},null,8,["modelValue"])]),_:1}),l(p,{label:"\u53C2\u6570\u8BF4\u660E",prop:"description",class:"hide_required"},{default:n(()=>[l(h,{modelValue:o.form.description,"onUpdate:modelValue":e[4]||(e[4]=s=>o.form.description=s),placeholder:"\u53C2\u6570\u540D\u79F0",type:"textarea",autosize:{minRows:4,maxRows:4},maxlength:"255"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}var ae=N(te,[["render",ne]]);const ie=g("span",{innerHTML:"\xA0"},null,-1),re={class:"absolute right-2",style:{top:"7px"}},ue=_("\u6DFB\u52A0\u53C2\u6570"),de=["onClick"],me=["onClick"];var ve=Q({setup(t){const e=x(),a=x([]),f=x(!1),o=L(),{projectInfo:r}=W(o),h=()=>{var i;(i=e.value)==null||i.show()},p=i=>{var d;(d=e.value)==null||d.show(b({},i))},C=i=>{K({title:"\u5220\u9664\u63D0\u793A",content:l("div",{class:"truncate"},[_("\u786E\u5B9A\u5220\u9664\u53C2\u6570\u300C"),i.name,_("\u300D\u5417\uFF1F")]),onOk:()=>I(o.projectInfo.id,i.id).then(d=>{ee.success(d.msg||"\u5220\u9664\u6210\u529F\uFF01"),v()})})},v=async()=>{f.value=!0;try{const{data:i}=await Y(o.projectInfo.id);let d=i.map||{};const c=[];Object.keys(d).forEach(m=>{d[m]&&c.push(d[m])}),a.value=c}catch{}finally{f.value=!1}};return X(()=>r.value,async()=>{r.value&&r.value.id&&await v()},{immediate:!0}),(i,d)=>{const c=u("el-button"),m=u("el-table-column"),k=u("el-table"),s=u("el-card"),F=A("loading");return M((y(),S(s,{shadow:"never","body-style":{padding:0}},{header:n(()=>[ie,g("div",re,[l(c,{type:"primary",onClick:h},{default:n(()=>[ue]),_:1})])]),default:n(()=>[l(k,{data:a.value,"empty-text":"\u6682\u65E0\u6570\u636E"},{default:n(()=>[l(m,{prop:"name",label:"\u53C2\u6570\u540D\u79F0","show-overflow-tooltip":""}),l(m,{prop:"type_name",label:"\u53C2\u6570\u7C7B\u578B",width:"100"}),l(m,{prop:"is_must",label:"\u5FC5\u4F20",width:"70"},{default:n(w=>[g("span",null,$(w.is_must?"\u662F":"\u5426"),1)]),_:1}),l(m,{prop:"default_value",label:"\u9ED8\u8BA4\u503C",width:"100","show-overflow-tooltip":""}),l(m,{prop:"description",label:"\u53C2\u6570\u8BF4\u660E","show-overflow-tooltip":""}),l(m,{label:"\u64CD\u4F5C",width:"120"},{default:n(({row:w})=>[g("span",{class:"cursor-pointer mr-3 text-blue-600",onClick:T=>p(w)},"\u7F16\u8F91",8,de),g("span",{class:"cursor-pointer mr-3 text-red-400",onClick:T=>C(w)},"\u5220\u9664",8,me)]),_:1})]),_:1},8,["data"]),l(ae,{ref_key:"modifyModal",ref:e,onOnOk:v},null,512)]),_:1})),[[F,f.value]])}}});export{ve as default};
