var zo=Object.defineProperty,Ho=Object.defineProperties;var Jo=Object.getOwnPropertyDescriptors;var Ht=Object.getOwnPropertySymbols;var Wo=Object.prototype.hasOwnProperty,qo=Object.prototype.propertyIsEnumerable;var _t=(e,t,s)=>t in e?zo(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,V=(e,t)=>{for(var s in t||(t={}))Wo.call(t,s)&&_t(e,s,t[s]);if(Ht)for(var s of Ht(t))qo.call(t,s)&&_t(e,s,t[s]);return e},ge=(e,t)=>Ho(e,Jo(t));var L=(e,t,s)=>(_t(e,typeof t!="symbol"?t+"":t,s),s);import{aQ as $e,o as d,f as g,aR as it,aS as at,h as a,G as q,aT as ue,u as k,W as O,T as j,Z as h,aU as Qo,U as G,r as I,aV as ct,aW as no,aX as D,aY as Zo,aZ as Re,v as lt,ac as Y,X as m,an as se,ai as U,$ as M,V as T,t as ie,a2 as Xo,q as re,H as ot,az as es,aA as ts,a_ as Ye,a$ as os,_ as ne,P as nt,b0 as ro,A as ss,R as X,S as ae,b1 as ns,b2 as rs,b3 as io,a3 as Pt,aa as ao,p as le,b4 as is,m as je,b5 as jt,am as Nt,aP as as,b6 as Ve,b7 as cs,b8 as ls,b9 as Ne,k as It,ba as mt,bb as ds,n as co,l as us,d as hs,a0 as lo,Y as ps,L as Jt,y as fs,Q as _s,bc as ke,bd as uo,as as Rt,be as ms,bf as ye,bg as Wt,aw as ho,av as po,I as gs,bh as vs,bi as fo,bj as ys,bk as As,bl as Cs,bm as Es,bn as ks,bo as qt,aM as ws,bp as Ns}from"./vendor.b27f3889.js";import{E as pe,a as Is,b as bs,c as Ds,d as Ss,e as xe,f as ze,g as xt,h as Lt,i as He,j as dt,k as Tt,l as Ot,m as Ps,n as js,o as _o,p as Rs,q as xs,_ as Ls,v as ut,r as mo,s as go,t as Qt,u as vo,w as yo,x as Ts,y as Os,z as Ms,A as Ao,B as Co,C as Bs,D as $s,F as Fs}from"./element-plus.85f938a9.js";const Ks=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function s(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerpolicy&&(r.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?r.credentials="include":n.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(n){if(n.ep)return;n.ep=!0;const r=s(n);fetch(n.href,r)}};Ks();const Vs=$e({id:"app.store",state:()=>({isShowLoading:!1}),actions:{showLoading(){this.isShowLoading=!0},hideLoading(){this.isShowLoading=!1}}});var z=(e,t)=>{const s=e.__vccOpts||e;for(const[o,n]of t)s[o]=n;return s};const Us={},Gs=e=>(it("data-v-2dbca8a7"),e=e(),at(),e),Ys={class:"vertical-center splash"},zs=Gs(()=>a("div",{class:"w-full text-center text-light"},[a("svg",{class:"spin",style:{width:"70px"},xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 100 100"},[a("path",{id:"p",fill:"#006bff",d:"M94.1 58.8c.6-2.8.9-5.8.9-8.8s-.3-6-.9-8.8l-11.7-.4c-.7-2.6-1.7-5-3-7.3l8-8.5c-3.3-4.9-7.5-9.2-12.5-12.5l-8.5 8c-2.3-1.3-4.7-2.3-7.3-3l-.3-11.6C56 5.3 53 5 50 5s-6 .3-8.8.9l-.4 11.7c-2.6.7-5 1.7-7.3 3l-8.5-8c-4.9 3.3-9.2 7.5-12.5 12.5l8 8.5c-1.3 2.3-2.3 4.7-3 7.3l-11.6.3C5.3 44 5 47 5 50s.3 6 .9 8.8l11.7.4c.7 2.6 1.7 5 3 7.3l-8 8.5c3.3 4.9 7.5 9.2 12.5 12.5l8.5-8c2.3 1.3 4.7 2.3 7.3 3l.4 11.7c2.7.5 5.7.8 8.7.8s6-.3 8.8-.9l.4-11.7c2.6-.7 5-1.7 7.3-3l8.5 8c4.9-3.3 9.2-7.5 12.5-12.5l-8-8.5c1.3-2.3 2.3-4.7 3-7.3l11.6-.3zM50 66.9c-9.3 0-16.9-7.6-16.9-16.9S40.7 33.1 50 33.1 66.9 40.7 66.9 50 59.3 66.9 50 66.9z"})])],-1)),Hs=[zs];function Js(e,t){return d(),g("div",Ys,Hs)}var Ws=z(Us,[["render",Js],["__scopeId","data-v-2dbca8a7"]]);const qs=q({setup(e){const t=Vs(),{isShowLoading:s}=ue(t);return(o,n)=>(d(),g(G,null,[k(s)?(d(),O(Ws,{key:0})):j("",!0),h(k(Qo))],64))}}),Qs="/",Ue="/login",Mt="/register",Bt="/main",de={path:"/404"},$t="document",Eo="/editor/:project_id",Ft="preview.project",Kt=`${Ft}.verification`,Ge="preview.document",rt=`${Ge}.verification`,De="document.api.edit",Se="document.api.detail";var Je="/assets/logo.1c8e1405.svg";function Zs(e,t){t=V({isCatch:!0,isShowMessage:!0},t);const s=I(!1),{isCatch:o,isShowMessage:n,msg:r}=t;async function i(c){s.value=!0;try{const l=await e(c)||{};return n&&(r||l.msg)&&pe.success(r||l.msg),l}catch(l){if(o)return{};throw l}finally{s.value=!1}}return[s,i]}const Xs="/api",en=1e3*10,Jl=15;var Te=(e=>(e[e.OK=0]="OK",e[e.FAIL=-1]="FAIL",e[e.NO_LOGIN=-2]="NO_LOGIN",e[e.NO_PARENT_DIR=-102]="NO_PARENT_DIR",e[e.NO_EXIST_TEAM=-100]="NO_EXIST_TEAM",e[e.INVALID_PREVIEW_SECRET=-103]="INVALID_PREVIEW_SECRET",e[e.NOT_FOUND=-404]="NOT_FOUND",e))(Te||{});const Ie={DIR:0,DOC:1,HTTP:1,OTHER:2,MARKDOWN:3},Wl={API:{text:"\u63A5\u53E3\u6587\u6863",key:"api.doc",value:1},DB:{text:"\u6570\u636E\u5E93\u6587\u6863",key:"db.doc",value:2}},Oe={WAIT:"wait",FINISH:"finish",FAIL:"fail"},W={ADMIN:"admin",MANAGER:"manage",DEVELOPER:"write",READER:"read",NONE:"none"},gt={MANAGER:0,DEVELOPER:1,READER:2},tn=[{text:"\u56E2\u961F\u7BA1\u7406\u5458",value:999,key:W.ADMIN},{text:"\u7BA1\u7406\u8005",value:gt.MANAGER,key:W.MANAGER},{text:"\u7EF4\u62A4\u8005",value:gt.DEVELOPER,key:W.DEVELOPER},{text:"\u9605\u8BFB\u8005",value:gt.READER,key:W.READER}],ql=tn.filter(e=>[W.DEVELOPER,W.READER].indexOf(e.key)!==-1),Ql="/static/icon-project.png",Ae={PRIVATE:"private",PUBLIC:"public"},Zt=[{text:"\u79C1\u6709",value:0,key:Ae.PRIVATE},{text:"\u516C\u5F00",value:1,key:Ae.PUBLIC}],Me={ADMIN:0,MANAGER:1,NORMAL:2},on=[{text:"\u7BA1\u7406\u5458",value:Me.MANAGER},{text:"\u666E\u901A\u6210\u5458",value:Me.NORMAL}];[Me.ADMIN,...on];const ko={baseURL:Xs,headers:{Accept:"application/json, text/plain, */*"}};ct.defaults.timeout=en;var E=ct.create(ko);const bt=ct.create(ko),sn=(e={})=>E.post("/email_login",V({},e)),nn=(e={})=>E.post("/email_register",V({},e)),rn=()=>E.post("/logout"),Zl=(e={})=>E.post("/user/change_avatar",e),an=(e={})=>E.post("/user/change_profile",V({},e)),cn=()=>E.get("/user/profile").then(e=>{if(e.data){const{name:t,avatar:s}=e.data;s||(e.data.lastName=no(t||"\u65E0"))}return e}),Xl=()=>Zs((e={})=>E.post("/user/change_password",V({},e))),be=$e({id:"user",state:()=>({token:D.get(D.KEYS.TOKEN)||null,userInfo:D.get(D.KEYS.USER_INFO)||{}}),getters:{isLogin:e=>!!e.token,isAdmin:e=>e.userInfo.authority===Me.ADMIN,isManager:e=>e.userInfo.authority===Me.MANAGER,isNormal:e=>e.userInfo.authority===Me.NORMAL,lastName:e=>no(e.userInfo.name)},actions:{updateToken(e){D.set(D.KEYS.TOKEN,e),this.token=e},async login(e){try{const t=await sn(e);return await this.getUserInfo(),this.goHome(),t}catch{}},async register(e){try{const t=await nn(e);return this.goHome(),t}catch{}},async logout(){D.removeAll([D.KEYS.TOKEN,D.KEYS.USER_INFO,D.KEYS.ACTIVE_PROJECT_GROUP]);try{await rn()}catch{}finally{this.token=null,this.userInfo={},location.href=Ue}},async getUserInfo(){if(!Zo.exports.isEmpty(this.userInfo))return this.userInfo;try{const{data:e}=await cn()||{};return D.set(D.KEYS.USER_INFO,e),this.userInfo=e,this.userInfo}catch{}return{}},goHome(e){Ce.replace(e||Bt)},async updateUserInfo(e){await an(e),this.$patch({userInfo:{name:e.name,email:e.email,avatar:e.avatar}}),D.set(D.KEYS.USER_INFO,this.userInfo)}}}),ln={class:"h-14"},dn={class:"shadow bg-white fixed top-0 w-full z-50"},un={class:"viewport relative flex items-center justify-between h-14"},hn={class:"flex-1 flex items-center"},pn=a("img",{class:"h-10 w-auto",src:Je,alt:"ApiCat"},null,-1),fn=a("span",{class:"logo-text logo-apicat"},"ApiCat",-1),_n={class:"ml-6"},mn={class:"flex items-center"},gn={class:"ml-3 relative"},vn={class:"el-dropdown-link"},yn={type:"button",class:"flex items-center rounded-full","aria-expanded":"false","aria-haspopup":"true"},An=["src"],Cn={key:1},En={class:"flex flex-col divide-y text-sm justify-center"},kn={class:"px-6 py-2"},wn=["title"],Nn=["title"],In={class:"ml-1"},bn=a("i",{class:"iconfont iconIconPopoverExit"},null,-1),Dn=a("span",{class:"ml-1"},"\u9000\u51FA\u767B\u5F55",-1),Sn=[bn,Dn],Pn=q({setup(e){const t={modifiers:[{name:"offset",options:{offset:[-24,10]}}]},s=I([{name:"user.profile",title:"\u4E2A\u4EBA\u4FE1\u606F",icon:"iconIconPopoverUser"}]),o=[{name:"projects",title:"\u9879\u76EE",active:"project"},{name:"members",title:"\u6210\u5458"}],n=be(),{currentRoute:r}=Re(),{userInfo:i,lastName:c}=ue(n),l=async()=>{await n.logout()},f=y=>["px-3",{"text-blue-600":(r.value.name||"").startsWith(y.active||y.name)}];return lt(async()=>{await n.getUserInfo()}),(y,p)=>{const A=Y("router-link"),C=Is,u=xe,_=bs,v=Ds;return d(),g("header",ln,[a("div",dn,[a("div",un,[a("div",hn,[h(A,{class:"inline-flex items-center",to:"/main"},{default:m(()=>[pn,fn]),_:1}),a("div",_n,[(d(),g(G,null,se(o,N=>h(A,{to:{name:N.name},key:N.name,class:T(f(N))},{default:m(()=>[U(M(N.title),1)]),_:2},1032,["to","class"])),64))])]),a("div",mn,[a("div",gn,[h(v,{placement:"bottom-end",trigger:"click","popper-class":"nav-dropdown","popper-options":t},{dropdown:m(()=>[h(_,null,{default:m(()=>[a("div",En,[a("div",kn,[a("p",{class:"text-base font-bold text-gray-600 truncate",title:k(i).name},M(k(i).name),9,wn),a("p",{class:"text-gray-500 truncate",title:k(i).email},M(k(i).email),9,Nn)]),(d(!0),g(G,null,se(s.value,N=>(d(),O(A,{key:N.name,class:"flex items-center px-6 py-3 hover:text-gray-700",to:{name:N.name}},{default:m(()=>[a("i",{class:T("iconfont "+N.icon)},null,2),a("span",In,M(N.title),1)]),_:2},1032,["to"]))),128)),a("a",{class:"flex items-center px-6 py-3 hover:text-gray-700",href:"javascript:void(0)",onClick:l},Sn)])]),_:1})]),default:m(()=>[a("span",vn,[a("button",yn,[h(C,null,{default:m(()=>[k(i).avatar?(d(),g("img",{key:0,src:k(i).avatar},null,8,An)):(d(),g("span",Cn,M(k(c)),1))]),_:1}),h(u,{class:"el-icon--right"},{default:m(()=>[h(k(Ss))]),_:1})])])]),_:1})])])])])])}}}),jn={class:"viewport px-8 py-4"},Rn=q({setup(e){return(t,s)=>{const o=Y("router-view");return d(),g(G,null,[h(Pn),a("main",jn,[h(o)])],64)}}}),xn="modulepreload",Xt={},Ln="/",H=function(t,s){return!s||s.length===0?t():Promise.all(s.map(o=>{if(o=`${Ln}${o}`,o in Xt)return;Xt[o]=!0;const n=o.endsWith(".css"),r=n?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${o}"]${r}`))return;const i=document.createElement("link");if(i.rel=n?"stylesheet":xn,n||(i.as="script",i.crossOrigin=""),i.href=o,document.head.appendChild(i),n)return new Promise((c,l)=>{i.addEventListener("load",c),i.addEventListener("error",()=>l(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>t())};const ve=e=>(it("data-v-47f509cc"),e=e(),at(),e),Tn={class:"h-14"},On={class:"shadow bg-white fixed top-0 w-full z-50"},Mn={class:"viewport relative items-center justify-between h-14 lg:flex hidden"},Bn={class:"flex-1 flex items-center"},$n=ve(()=>a("div",{class:"flex-shrink-0 flex"},[a("a",{class:"inline-flex items-center",href:"/"},[a("img",{class:"h-10 w-auto",src:Je,alt:"ApiCat"}),a("span",{class:"logo-text logo-apicat"},"ApiCat")])],-1)),Fn={key:0,class:"ml-6 hidden lg:block"},Kn=ve(()=>a("div",{class:"flex text-gray-600"},[a("a",{href:"https://apicat.net",target:"_blank",class:"px-3 py-2 rounded-md text-sm"},"\u9996\u9875"),a("a",{href:"https://apicat.net/app/31eb8ec8c295c8c4130ee50304d55ab5",target:"_blank",class:"px-3 py-2 rounded-md text-sm"},"\u6587\u6863"),a("a",{href:"https://github.com/NatosoftCN/ApiCat_Open",target:"_blank",class:"px-3 py-2 rounded-md text-sm"},"Github")],-1)),Vn=[Kn],Un={key:0},Gn=U("\u767B\u5F55"),Yn=U("\u6CE8\u518C"),zn={class:"lg:hidden"},Hn={class:"flex items-center justify-between h-14 px-4 relative"},Jn=ve(()=>a("img",{class:"h-10 w-auto",src:Je,alt:"ApiCat"},null,-1)),Wn=ve(()=>a("span",{class:"logo-text logo-apicat"},"ApiCat",-1)),qn=ve(()=>a("svg",{viewBox:"0 0 24 24",width:"1em",height:"1em",style:{"font-size":"24px"},fill:"currentColor"},[a("path",{d:"M21 7H3V5H21V7Z","fill-rule":"evenodd","clip-rule":"evenodd",fill:"currentColor"}),a("path",{d:"M21 13H3V11H21V13Z","fill-rule":"evenodd","clip-rule":"evenodd",fill:"currentColor"}),a("path",{d:"M21 19H3V17H21V19Z","fill-rule":"evenodd","clip-rule":"evenodd",fill:"currentColor"})],-1)),Qn=[qn],Zn={key:0,class:"bg-white fixed top-0 left-0 w-full max-h-screen flex flex-col z-10"},Xn={class:"flex items-center justify-between h-14 px-4"},er=ve(()=>a("img",{class:"h-10 w-auto",src:Je,alt:"ApiCat"},null,-1)),tr=ve(()=>a("span",{class:"logo-text logo-apicat"},"ApiCat",-1)),or=ve(()=>a("svg",{viewBox:"0 0 24 24",width:"1em",height:"1em",style:{"font-size":"24px"},fill:"currentColor"},[a("path",{d:"M12.0001 13.4141L17.6568 19.0708L19.0711 17.6566L13.4143 11.9998L19.0711 6.34304L17.6569 4.92883L12.0001 10.5856L6.34314 4.92871L4.92893 6.34292L10.5859 11.9998L4.92896 17.6567L6.34317 19.071L12.0001 13.4141Z","fill-rule":"evenodd","clip-rule":"evenodd",fill:"currentColor"})],-1)),sr=[or],nr={class:"flex-1 overflow-y-auto"},rr=ve(()=>a("div",{class:"px-4 text-base font-medium"},[a("a",{class:"px-3 py-2 mb-1 rounded-lg block",href:"/"},"\u9996\u9875"),a("a",{class:"px-3 py-2 mb-1 rounded-lg block",href:"#"},"\u6587\u6863"),a("a",{class:"px-3 py-2 mb-1 rounded-lg block",href:"#"},"GitHub")],-1)),ir={class:"px-5"},ar=U("\u767B\u5F55"),cr=U("\u6CE8\u518C"),lr=q({props:{isShowNav:{type:Boolean,default:!0}},setup(e){const t=I(!1);return ie(t,()=>{document.body.classList.toggle("overflow-hidden")}),(s,o)=>{const n=ze,r=Y("router-link");return d(),g("header",Tn,[a("div",On,[a("div",Mn,[a("div",Bn,[$n,e.isShowNav?(d(),g("div",Fn,Vn)):j("",!0)]),e.isShowNav?(d(),g("div",Un,[h(r,{to:k(Ue),class:"mr-4"},{default:m(()=>[h(n,null,{default:m(()=>[Gn]),_:1})]),_:1},8,["to"]),h(r,{to:k(Mt)},{default:m(()=>[h(n,{type:"primary"},{default:m(()=>[Yn]),_:1})]),_:1},8,["to"])])):j("",!0)]),a("div",zn,[a("div",Hn,[h(r,{class:"inline-flex items-center",to:"/"},{default:m(()=>[Jn,Wn]),_:1}),a("div",{class:"cursor-pointer",onClick:o[0]||(o[0]=i=>t.value=!t.value)},Qn),h(Xo,{name:"slide-fade"},{default:m(()=>[t.value?(d(),g("div",Zn,[a("div",Xn,[h(r,{class:"inline-flex items-center",to:"/"},{default:m(()=>[er,tr]),_:1}),a("div",{class:"cursor-pointer",onClick:o[1]||(o[1]=i=>t.value=!t.value)},sr)]),a("div",nr,[rr,a("div",ir,[h(r,{to:"/login"},{default:m(()=>[h(n,{class:"w-full"},{default:m(()=>[ar]),_:1})]),_:1}),h(r,{to:"/"},{default:m(()=>[h(n,{type:"primary",class:"w-full my-5"},{default:m(()=>[cr]),_:1})]),_:1})])])])):j("",!0)]),_:1}),t.value?(d(),g("div",{key:0,class:"fixed top-0 left-0 w-screen h-screen bg-opacity-40 bg-gray-900",onClick:o[2]||(o[2]=i=>t.value=!t.value)})):j("",!0)])])])])}}});var dr=z(lr,[["__scopeId","data-v-47f509cc"]]);const wo=q({setup(e){const t=I(!0);return re("switchNavState",o=>{t.value=o}),(o,n)=>{const r=Y("router-view");return d(),g(G,null,[h(dr,{"is-show-nav":t.value},null,8,["is-show-nav"]),h(r)],64)}}}),ur=()=>H(()=>import("./Index.72603d4f.js"),["assets/Index.72603d4f.js","assets/Index.46d30f47.css","assets/vendor.b27f3889.js"]),hr=()=>H(()=>import("./Login.39e817fa.js"),["assets/Login.39e817fa.js","assets/element-plus.85f938a9.js","assets/element-plus.7d952092.css","assets/vendor.b27f3889.js"]),pr=()=>H(()=>import("./Register.2772fa90.js"),["assets/Register.2772fa90.js","assets/element-plus.85f938a9.js","assets/element-plus.7d952092.css","assets/vendor.b27f3889.js"]),fr=()=>H(()=>import("./NotFound.6a7c6103.js"),["assets/NotFound.6a7c6103.js","assets/NotFound.3339f423.css","assets/vendor.b27f3889.js","assets/element-plus.85f938a9.js","assets/element-plus.7d952092.css"]),_r={path:Qs,name:"index",component:wo,meta:{ignoreAuth:!0},children:[{path:"",name:"index.feature",component:ur}]},mr={path:Ue,name:"login",meta:{ignoreAuth:!0},component:hr},gr={path:Mt,name:"register",meta:{ignoreAuth:!0},component:pr},vr={path:"/:path(.*)*",name:"error",component:wo,meta:{ignoreAuth:!0},children:[{path:"/:path(.*)*",name:"error.not.found",component:fr}]},yr={class:"flex flex-col border divide-y bg-white"},Ar=q({props:{menus:{type:Array,default:()=>[]}},setup(e){return(t,s)=>{const o=Y("router-link");return d(),g("div",yr,[(d(!0),g(G,null,se(e.menus,n=>(d(),O(o,{key:n.name,to:{name:n.name},class:"relative h-12 pl-6 flex items-center text-neutral-600 hover:text-neutral-900"},{default:m(()=>[a("span",null,M(n.meta.title),1)]),_:2},1032,["to"]))),128))])}}}),Cr={},Er={class:"flex justify-between flex-col lg:flex-row"},kr={class:"sidebar-nav flex-none lg:w-64 mb-4 lg:mb-0"},wr={class:"flex-auto lg:ml-4 overflow-hidden"};function Nr(e,t){const s=Ar,o=Y("RouterView");return d(),g("div",Er,[a("aside",kr,[ot(e.$slots,"default",{},()=>[h(s,es(ts(e.$attrs)),null,16)])]),a("div",wr,[h(o)])])}var No=z(Cr,[["render",Nr]]);const Ir=q({setup(e){const t=I(Io);return(s,o)=>(d(),O(No,{menus:t.value},null,8,["menus"]))}}),br=()=>H(()=>import("./UserProfile.821a5394.js"),["assets/UserProfile.821a5394.js","assets/ImagePreview.143296e3.js","assets/ImagePreview.e9afec23.css","assets/element-plus.85f938a9.js","assets/element-plus.7d952092.css","assets/vendor.b27f3889.js"]),Dr=()=>H(()=>import("./ModifyPassword.187676b0.js"),["assets/ModifyPassword.187676b0.js","assets/element-plus.85f938a9.js","assets/element-plus.7d952092.css","assets/vendor.b27f3889.js"]),Io=[{path:"profile",name:"user.profile",meta:{title:"\u4E2A\u4EBA\u4FE1\u606F"},component:br},{path:"password",name:"user.password",meta:{title:"\u4FEE\u6539\u5BC6\u7801"},component:Dr}];var Sr={path:"/user",name:"user",redirect:{name:"user.profile"},component:Ir,children:Io};const Pr=()=>H(()=>import("./MemberList.9fbba316.js"),["assets/MemberList.9fbba316.js","assets/element-plus.85f938a9.js","assets/element-plus.7d952092.css","assets/vendor.b27f3889.js","assets/usePage.a5962d78.js"]);var jr={path:"/members",name:"members",component:Pr};const ed=(e={})=>E.post("/project/create",e),td=(e={})=>E.post("/project/icon",e),od=e=>E.post("/project/remove",{project_id:e}),sd=e=>E.post("/project/quit",{project_id:e}),nd=(e={})=>E.post("/project/add_member",e),rd=e=>E.get("/project/members",{params:e}),id=(e,t)=>E.post("/project/remove_member",{project_id:e,user_id:t}),ad=(e,t)=>E.post("/project/transfer",{project_id:e,user_id:t}),cd=(e={})=>E.post("/project/change_member_authority",e),Rr=(e={})=>E.post("/project/setting",e),xr=(e,t)=>E.post("/project/share",{project_id:e,share:t}),Lr=e=>E.post("/project/reset_share_secretkey",{project_id:e}),ld=(e={})=>E.post("/doc/restore_api_doc",e),dd=e=>E.get("/projects",{params:{group_id:e==0?"":e}}),Tr=e=>E.post("/project_group/create",e),Or=()=>E.get("/project_groups"),Mr=e=>E.post("/project_group/remove",{id:e}),Br=e=>E.post("/project_group/rename",e),$r=e=>E.post("/project_group/change_order",{ids:e}),Fr=(e,t)=>E.get("/project",{params:{project_id:e,token:t}}),Kr=e=>E.get("/project/status",{params:{project_id:e}}),ud=e=>E.post("/project/change_group",e),hd=e=>E.get("/doc/trash",{params:{project_id:e}}),pd=e=>E.get("/project/without_members",{params:{project_id:e}}),eo=e=>window.origin+Ye(Eo)({project_id:e}),to={id:0,name:"\u6240\u6709\u9879\u76EE"},bo=$e({id:"projects",state:()=>({projectGroupList:[],activeGroup:D.get(D.KEYS.ACTIVE_PROJECT_GROUP)||to}),getters:{},actions:{async getProjectGroupList(){const{data:e=[]}=await Or()||{};this.projectGroupList=e},switchProjectGroup(e=to){D.set(D.KEYS.ACTIVE_PROJECT_GROUP,e),this.activeGroup=e},async addProjectGroup(e){const t=await Tr(e);return t&&this.projectGroupList.push(t.data),t},async renameProjectGroup(e){const t=await Br(e);if(t){const s=this.projectGroupList.find(o=>o.id==e.id);s.name=e.name}return t},async deleteProjectGroup(e){const t=await Mr(e.id);return this.projectGroupList=this.projectGroupList.filter(s=>s.id!==e.id),this.activeGroup.id===e.id&&this.switchProjectGroup(),t},async sortProjectGroup(e,t){const s=this.projectGroupList.splice(e,1)[0];this.projectGroupList.splice(t,0,s),await $r(this.projectGroupList.map(o=>o.id))}}}),Vr={data(){return{title:"",isShow:!1,isLoading:!1,isEdit:!1,form:{name:""},categoryInfo:null,rules:{name:{required:!0,message:"\u8BF7\u8F93\u5165\u5206\u7EC4\u540D\u79F0",trigger:"blur"}}}},watch:{isShow:function(){this.isShow&&(this.title=`${this.isEdit?"\u7F16\u8F91":"\u6DFB\u52A0"}\u5206\u7EC4`),!this.isShow&&this.reset()}},methods:ge(V({},os(bo,["addProjectGroup","renameProjectGroup"])),{show(e){this.isEdit=!!e,e?(this.categoryInfo=e,this.form=V({},e)):this.form.name="",this.isShow=!0,this.focus()},hide(){this.isShow=!1},onCloseBtnClick(){this.isShow=!1,this.reset()},reset(){this.$refs.teamForm.resetFields()},handleSubmit(e){this.$refs[e].validate(t=>t&&this.submit())},submit(){this.isLoading=!0,(this.isEdit?this.renameProjectGroup:this.addProjectGroup)(this.form).then(t=>{this.$Message.success(t.msg||`${this.isEdit?"\u7F16\u8F91":"\u6DFB\u52A0"}\u5206\u7EC4\u6210\u529F!`),this.onCloseBtnClick()}).finally(()=>{this.isLoading=!1}).catch(t=>{})},focus(){setTimeout(()=>this.$refs.input.focus(),200)}})},Ur=U(" \u53D6\u6D88 "),Gr=U(" \u786E\u5B9A ");function Yr(e,t,s,o,n,r){const i=dt,c=xt,l=Lt,f=ze,y=He;return d(),O(y,{modelValue:n.isShow,"onUpdate:modelValue":t[4]||(t[4]=p=>n.isShow=p),width:340,"close-on-click-modal":!1,title:n.title,"append-to-body":"","custom-class":"show-footer-line"},{footer:m(()=>[h(f,{onClick:t[2]||(t[2]=p=>r.onCloseBtnClick())},{default:m(()=>[Ur]),_:1}),h(f,{loading:n.isLoading,type:"primary",onClick:t[3]||(t[3]=p=>r.handleSubmit("teamForm"))},{default:m(()=>[Gr]),_:1},8,["loading"])]),default:m(()=>[h(l,{ref:"teamForm",model:n.form,rules:n.rules,"label-position":"top",style:{"margin-bottom":"-19px"},onSubmit:t[1]||(t[1]=ne(p=>r.handleSubmit("teamForm"),["prevent"]))},{default:m(()=>[h(c,{label:"\u5206\u7EC4\u540D\u79F0",prop:"name",class:"hide_required"},{default:m(()=>[h(i,{type:"text",ref:"input",modelValue:n.form.name,"onUpdate:modelValue":t[0]||(t[0]=p=>n.form.name=p),placeholder:"\u8BF7\u8F93\u5165\u5206\u7EC4\u540D\u79F0",maxlength:255},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}var zr=z(Vr,[["render",Yr]]);const Do=(e=Tt)=>({title:t,message:s,content:o,cb:n,onOk:r})=>(n=n||r,s=s||o,e({title:t,message:s,showCancelButton:!0,confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",beforeClose:function(i,c,l){i==="confirm"?(c.confirmButtonLoading=!0,Promise.resolve(n(l)).then(()=>l()).catch(f=>f).finally(()=>{c.confirmButtonLoading=!1})):l()}})),So=Do();var Hr={install:function(e){const t=e.config.globalProperties.$msgbox||Tt;e.config.globalProperties.$asyncMsgBox=Do(t)}};function Jr(e,t){function s(){nt(async()=>{if(e=k(e),!e)return;(await H(()=>import("./sortable.esm.85cd8ec3.js"),[])).default.create(e,V({animation:200,delay:400,delayOnTouchOnly:!0},t))})}return{initSortable:s}}const Po=e=>(it("data-v-a97b0cbc"),e=e(),at(),e),Wr={class:"flex flex-col border divide-y bg-white"},qr=Po(()=>a("span",{class:"ml-1"},"\u6240\u6709\u9879\u76EE",-1)),Qr=["onClick"],Zr=["title"],Xr=Po(()=>a("span",{class:"ml-1"},"\u6DFB\u52A0\u5206\u7EC4",-1)),ei=U("\u91CD\u547D\u540D "),ti=U("\u5220\u9664 "),oi=q({setup(e){const t=bo(),{activeGroup:s,projectGroupList:o}=ue(t),n=I(null),r=I(!1),i=I(),c=I();let l=null;const f=v=>[{active:s.value.id===v}],y=()=>{var v;(v=n.value)==null||v.show()},p=v=>{t.switchProjectGroup(v)},A=(v,N)=>{l=N,i.value=v.currentTarget,r.value=!0},C=()=>{var v;l&&((v=n.value)==null||v.show(l))},u=()=>{l&&So({title:"\u5220\u9664\u63D0\u793A",content:`\u786E\u5B9A\u5220\u9664${l.name}\u5206\u7EC4\uFF1F`,onOk:()=>t.deleteProjectGroup(l).then(v=>{pe.success(v.msg||"\u5220\u9664\u6210\u529F\uFF01")})})};ro(i,v=>{var F,$;const S=v.target.parentNode,B=S.parentNode;((F=S==null?void 0:S.classList)==null?void 0:F.contains("el-icon__more"))||(($=B==null?void 0:B.classList)==null?void 0:$.contains("el-icon__more"))||(r.value=!1)});const{initSortable:_}=Jr(c,{draggable:".ac-group-nav__item",onEnd(v){t.sortProjectGroup(v.oldIndex,v.newIndex)}});return lt(async()=>{await t.getProjectGroupList(),_()}),ss(()=>{l=null}),(v,N)=>{const S=xe,B=Ot;return d(),g(G,null,[h(No,null,{default:m(()=>[a("div",Wr,[a("a",{class:T(["relative h-12 pl-6 flex items-center text-neutral-600 hover:text-neutral-900",f(0)]),href:"javascript:void(0);",onClick:N[0]||(N[0]=F=>p())},[h(S,null,{default:m(()=>[h(k(Ps))]),_:1}),qr],2),X(a("div",{class:"divide-y ac-group-nav",ref_key:"sortableList",ref:c},[(d(!0),g(G,null,se(k(o),F=>(d(),g("a",{key:F.name,class:T(["relative flex pr-4 items-center justify-between text-neutral-600 hover:text-neutral-900 ac-group-nav__item",f(F.id)]),href:"javascript:void(0);"},[a("section",{class:"overflow-hidden flex items-center flex-1 h-12 pl-6",onClick:$=>p(F)},[h(S,null,{default:m(()=>[h(k(js))]),_:1}),a("span",{class:"ml-1 truncate",title:F.name},M(F.name),9,Zr)],8,Qr),h(S,{onClick:$=>A($,F),class:"ml-1 el-icon__more"},{default:m(()=>[h(k(_o))]),_:2},1032,["onClick"])],2))),128))],512),[[ae,k(o).length]]),a("a",{class:"relative h-12 pl-6 flex items-center text-neutral-600 hover:text-neutral-900",href:"javascript:void(0);",onClick:y},[h(S,null,{default:m(()=>[h(k(Rs))]),_:1}),Xr])])]),_:1}),h(zr,{ref_key:"addProjectCategoryModal",ref:n},null,512),h(B,{"popper-class":"ac-popper-menu",width:"auto",visible:r.value,"onUpdate:visible":N[1]||(N[1]=F=>r.value=F),"virtual-ref":i.value,"virtual-triggering":""},{default:m(()=>[a("ul",null,[a("li",{class:"ac-popper-menu__item",onClick:C},[h(S,{class:"mr-1"},{default:m(()=>[h(k(xs))]),_:1}),ei]),a("li",{class:"ac-popper-menu__item",onClick:u},[h(S,{class:"mr-1"},{default:m(()=>[h(k(Ls))]),_:1}),ti])])]),_:1},8,["visible","virtual-ref"])],64)}}});var si=z(oi,[["__scopeId","data-v-a97b0cbc"]]);const ni=()=>H(()=>import("./Projects.fe65a8d7.js"),["assets/Projects.fe65a8d7.js","assets/Projects.15a75533.css","assets/element-plus.85f938a9.js","assets/element-plus.7d952092.css","assets/vendor.b27f3889.js","assets/ImagePreview.143296e3.js","assets/ImagePreview.e9afec23.css"]),ri={path:"",name:"projects.index",meta:{title:"\u9879\u76EE\u5217\u8868"},component:ni},ii=[ri];var ai={path:"/home",name:"projects",redirect:{name:"projects.index"},component:si,children:ii};const ci=()=>H(()=>import("./ProjectNav.a2ba44a3.js"),["assets/ProjectNav.a2ba44a3.js","assets/vendor.b27f3889.js","assets/element-plus.85f938a9.js","assets/element-plus.7d952092.css"]),li=()=>H(()=>import("./ProjectSetting.823aa47e.js"),["assets/ProjectSetting.823aa47e.js","assets/ImagePreview.143296e3.js","assets/ImagePreview.e9afec23.css","assets/element-plus.85f938a9.js","assets/element-plus.7d952092.css","assets/vendor.b27f3889.js"]),di=()=>H(()=>import("./ProjectMembers.515c95de.js"),["assets/ProjectMembers.515c95de.js","assets/element-plus.85f938a9.js","assets/element-plus.7d952092.css","assets/vendor.b27f3889.js","assets/usePage.a5962d78.js"]),ui=()=>H(()=>import("./ProjectParam.b4319efe.js"),["assets/ProjectParam.b4319efe.js","assets/element-plus.85f938a9.js","assets/element-plus.7d952092.css","assets/vendor.b27f3889.js","assets/params.92cf209e.js"]),hi=()=>H(()=>import("./ProjectTrash.1b907e19.js"),["assets/ProjectTrash.1b907e19.js","assets/element-plus.85f938a9.js","assets/element-plus.7d952092.css","assets/vendor.b27f3889.js"]),jo=[{path:"setting",name:"project.setting",component:li,meta:{title:"\u9879\u76EE\u8BBE\u7F6E",role:[W.MANAGER]}},{path:"members",name:"project.members",component:di,meta:{title:"\u9879\u76EE\u6210\u5458",role:[W.MANAGER,W.DEVELOPER,W.READER]}},{path:"params",name:"project.params",component:ui,meta:{title:"\u516C\u5171\u53C2\u6570",role:[W.MANAGER,W.DEVELOPER]}},{path:"trash",name:"project.trash",component:hi,meta:{title:"\u56DE\u6536\u7AD9",role:[W.MANAGER,W.DEVELOPER]}}],oo=ns(jo);var pi={path:"/project/:project_id",name:"project",component:ci,redirect:{name:"project.setting"},children:jo};const fi={data(){return{isShow:!1,isLoading:!1,isPoll:!1,title:"\u5BFC\u51FA\u9879\u76EE",params:{},exportList:[],jobParams:{id:null},currentConfig:null,timer:null}},watch:{isShow:function(){this.isShow||(this.clearTimer(),this.isLoading=!1)}},methods:{hide(){this.isShow=!1},show(e,t){this.clearTimer(),this.isShow=!0,this.exportList=t||[],this.params=e||{}},onItemClick(e){this.currentConfig=e||null,this.getImportJobId(this.buildParams(e))},getImportJobId(e){if(this.jobParams.id=null,!this.currentConfig||!this.currentConfig.action)return this.isLoading=!1,Promise.resolve();this.currentConfig.action(e).then(t=>{this.jobParams.id=t.data||null,this.isPoll=!0,this.getExecResult()}).catch(()=>{this.isLoading=!1})},clearTimer(){this.isLoading=!1,this.isPoll=!1},async exec(){if(!this.currentConfig||!this.currentConfig.getJobResult)return this.clearTimer(),Promise.resolve();this.isLoading=!0;try{const{data:e}=await this.currentConfig.getJobResult(this.params.project_id,this.jobParams.id);let t=e.description||"";if(e.result===Oe.FAIL&&this.isShow){this.isLoading=!1,this.$Message.error(t||"\u5BFC\u51FA\u5931\u8D25\uFF01"),this.clearTimer();return}if(e.result===Oe.WAIT&&this.isShow)return;e.result===Oe.FINISH&&this.isShow&&(this.$Message.success(t||"\u5BFC\u51FA\u5B8C\u6210\uFF01"),this.isLoading=!1,this.clearTimer(),this.hide(),e.url&&rs(e.url))}catch{this.clearTimer()}},async getExecResult(){for(;this.isPoll;)await this.exec(this.params),await io(2e3)},buildParams(e){return this.params.type=e.type,this.params}},unmounted(){this.clearTimer()}},_i={class:"ac-project-export","element-loading-text":"\u5BFC\u5165\u4E2D\uFF0C\u8BF7\u52FF\u5173\u95ED\u7A97\u53E3\uFF01"},mi=["onClick"],gi=["src","alt"],vi={class:"mt-1.5"};function yi(e,t,s,o,n,r){const i=He,c=ut;return d(),O(i,{modelValue:n.isShow,"onUpdate:modelValue":t[0]||(t[0]=l=>n.isShow=l),width:"fit-content","close-on-click-modal":!1,"append-to-body":"",title:n.title},{default:m(()=>[X((d(),g("div",_i,[(d(!0),g(G,null,se(n.exportList,l=>(d(),g("div",{class:"ac-project-export-item",key:l.type},[a("div",{class:"ac-project-export-inner",onClick:f=>r.onItemClick(l)},[a("img",{src:l.icon,alt:l.text},null,8,gi),a("p",vi,M(l.text),1)],8,mi)]))),128))])),[[c,n.isLoading]])]),_:1},8,["modelValue","title"])}var Ai=z(fi,[["render",yi],["__scopeId","data-v-159cc67b"]]),Ro="/assets/logo-apicat@2x.ca5d403d.png",Ci="/assets/logo-markdown@2x.084fed6d.png",xo="/assets/logo-postman@2x.3bda39f9.png";const fd=e=>E.get("/api_url/list",{params:{project_id:e}}),_d=(e,t)=>E.post("/api_url/remove",{project_id:e,url_id:t}),md=(e,t,s="json")=>{const o=D.get(D.KEYS.SECRET_PROJECT_TOKEN+e||"",!0);return E.get("/api_doc",{params:{project_id:e,doc_id:t,format:s,token:o}})},Ei=(e,t)=>{const s=D.get(D.KEYS.SECRET_PROJECT_TOKEN+e||"",!0);return E.get("/api_doc/search",{params:{project_id:e,keywords:t,token:s}})},ki=(e={})=>E.post("/api_doc/create",V({},e)),wi=(e={})=>E.post("/api_doc/http_template",V({},e)),gd=(e={})=>(typeof e.content=="object"&&(e.content=JSON.stringify(e.content)),E.post("/api_doc/update",e)),Ni=(e={})=>E.post("/api_doc/copy",e),Ii=(e={})=>E.post("/api_doc/rename",e),bi=(e={})=>E.post("/api_doc/remove",e),Di=(e={})=>E.post("/api_doc/share",V({},e)),Si=(e={})=>E.post("/api_doc/share_detail",V({},e)),Pi=(e={})=>E.post("/api_doc/share_secretkey",V({},e)),vt=e=>E.post("/api_doc/import",e),yt=(e,t)=>E.get("/api_doc/import_result",{params:{project_id:e,job_id:t}}),ji=[{text:"ApiCat",icon:Ro,type:"apicat",action:vt,getJobResult:yt,maxSize:2,accept:".json"},{text:"Markdown",icon:Ci,type:"markdown",action:vt,getJobResult:yt,maxSize:.5,accept:".md"},{text:"Postman(v2.1)",icon:xo,type:"postman",action:vt,getJobResult:yt,maxSize:2,accept:".json"}],Ri={watch:{shareData(){this.shareData.docId!==-1&&this.getShareDetail()}},setup(){const{currentRoute:e}=Re(),t=Pt({project_id:parseInt(e.value.params.project_id,10),document:null,isShow:!1,isShowDetail:!1,isLoading:!1,isLoadingResetPwd:!1,shareUrl:"",isShare:!1,password:"",copyText:"",copyTextEl:I(),shareData:{docId:-1}});return V({},ao(t))},methods:{onShareStatusSwitch(e){this.document!==null&&(this.isLoading=!0,Di({project_id:this.project_id,doc_id:this.shareData.docId,share:e}).then(({data:t})=>{e?(this.updateLinkAndPassword(t.link,t.secret_key),this.document.secret_key=t.secret_key):(this.document.secret_key="",this.isShare=!1)}).catch(t=>{this.isShare=!this.isShare}).finally(()=>{this.isLoading=!1}))},copy(){this.copyTextEl.select(),document.execCommand("copy")&&(this.copyText="\u590D\u5236\u6210\u529F",setTimeout(()=>{this.copyText=this.document.visibility===1?"\u590D\u5236\u94FE\u63A5":"\u590D\u5236\u94FE\u63A5\u548C\u5BC6\u7801"},2e3))},show(e){this.shareData=e||{docId:-1},this.isShow=!0},setDocument(e={}){return this.document=e,this.copyText=e.visibility===1?"\u590D\u5236\u94FE\u63A5":"\u590D\u5236\u94FE\u63A5\u548C\u5BC6\u7801",this.isShare=e.visibility===0&&!!e.secret_key,this.updateLinkAndPassword(e.link,e.secret_key),this},updateLinkAndPassword(e,t){this.shareUrl=e||this.shareUrl,this.password=t||this.password,this.updateCopyText()},onResetPasswordBtnClick(){this.isLoadingResetPwd=!0,Pi({project_id:this.project_id,doc_id:this.shareData.docId}).then(({data:e})=>this.updateLinkAndPassword(null,e)).finally(()=>{this.isLoadingResetPwd=!1})},updateCopyText(){this.copyTextEl.value=this.document.visibility===1?this.shareUrl:[`\u94FE\u63A5\uFF1A${this.shareUrl}`,`\u5BC6\u7801\uFF1A${this.password}`].join(`
`)},getShareDetail(){this.isShowDetail=!0,Si({project_id:this.project_id,doc_id:this.shareData.docId}).then(({data:e})=>{this.setDocument(e)}).finally(()=>{this.isShowDetail=!1})}}},xi={class:"-m-4"},Li={key:0},Ti={key:1},Oi=a("div",{class:"flex-1"},[a("h4",null,"\u5F00\u542F\u5206\u4EAB"),a("div",{class:"ivu-list-item-meta-description"},"\u5F00\u542F\u5206\u4EAB\u540E\uFF0C\u83B7\u5F97\u94FE\u63A5\u7684\u4EBA\u53EF\u4EE5\u8BBF\u95EE\u9879\u76EE\u5185\u5BB9\u3002")],-1),Mi=U("\u91CD\u7F6E\u5BC6\u7801"),Bi={ref:"copyTextEl",style:{position:"fixed",left:"-9999px"}};function $i(e,t,s,o,n,r){const i=ze,c=dt,l=xt,f=Lt,y=mo,p=go,A=He,C=ut;return d(),O(A,{modelValue:e.isShow,"onUpdate:modelValue":t[4]||(t[4]=u=>e.isShow=u),title:"\u5206\u4EAB\u6587\u6863","custom-class":"vertical-center-modal",width:540,"append-to-body":""},{default:m(()=>[X((d(),g("div",xi,[e.document&&e.document.visibility===1?(d(),g("div",Li,[h(f,{"label-position":"top",class:"px-6 py-3"},{default:m(()=>[h(l,{label:""},{default:m(()=>[h(c,{readonly:"",modelValue:e.shareUrl,"onUpdate:modelValue":t[0]||(t[0]=u=>e.shareUrl=u)},{append:m(()=>[h(i,{type:"primary",onClick:r.copy},{default:m(()=>[U(M(e.copyText),1)]),_:1},8,["onClick"])]),_:1},8,["modelValue"])]),_:1})]),_:1})])):j("",!0),e.document&&e.document.visibility===0?(d(),g("div",Ti,[a("div",{class:T(["px-6 flex items-center",{"py-3":!e.isShare,"pt-3":e.isShare}])},[Oi,h(y,{loading:e.isLoading,modelValue:e.isShare,"onUpdate:modelValue":t[1]||(t[1]=u=>e.isShare=u),onChange:r.onShareStatusSwitch,"inline-prompt":"","active-text":"\u5F00","inactive-text":"\u5173"},null,8,["loading","modelValue","onChange"])],2),e.isShare?(d(),O(p,{key:0})):j("",!0),e.isShare?(d(),O(f,{key:1,"label-position":"top",class:"px-6"},{default:m(()=>[h(l,{label:"\u6587\u6863\u94FE\u63A5"},{default:m(()=>[h(c,{readonly:"",modelValue:e.shareUrl,"onUpdate:modelValue":t[2]||(t[2]=u=>e.shareUrl=u)},{append:m(()=>[h(i,{type:"primary",onClick:r.copy},{default:m(()=>[U(M(e.copyText),1)]),_:1},8,["onClick"])]),_:1},8,["modelValue"])]),_:1}),h(l,{label:"\u5BC6\u7801"},{default:m(()=>[h(l,{prop:"date",class:"mr-1"},{default:m(()=>[h(c,{readonly:"",modelValue:e.password,"onUpdate:modelValue":t[3]||(t[3]=u=>e.password=u)},null,8,["modelValue"])]),_:1}),h(i,{loading:e.isLoadingResetPwd,onClick:r.onResetPasswordBtnClick},{default:m(()=>[Mi]),_:1},8,["loading","onClick"])]),_:1})]),_:1})):j("",!0)])):j("",!0)])),[[C,e.isShowDetail]]),a("textarea",Bi,null,512)]),_:1},8,["modelValue"])}var Fi=z(Ri,[["render",$i]]);const Ki={setup(){const e=Pt({project:null,dom:null,isShow:!1,isLoading:!1,isLoadingResetPwd:!1,shareUrl:"",isShare:!1,password:"",copyText:"",copyTextEl:I()});return V({PROJECT_VISIBLE_TYPES:Ae},ao(e))},methods:{onShareStatusSwitch(e){this.project!==null&&(this.isLoading=!0,xr(this.project.id,Number(e)).then(({msg:t,data:s})=>{s=s||{},this.$Message.success(t||"\u64CD\u4F5C\u6210\u529F"),this.updateLinkAndPassword(eo(this.project.id),s.secret_key),e?this.project.secret_key=s.secret_key:delete this.project.secret_key}).catch(t=>{this.isShare=!this.isShare}).finally(()=>{this.isLoading=!1}))},copy(){this.copyTextEl.select(),document.execCommand("copy")&&(this.copyText="\u590D\u5236\u6210\u529F",setTimeout(()=>{this.copyText=this.project.visibility===Ae.PUBLIC?"\u590D\u5236\u94FE\u63A5":"\u590D\u5236\u94FE\u63A5\u548C\u5BC6\u7801"},2e3))},show(e={}){this.isShow=!0,this.project=e,this.copyText=e.visibility===Ae.PUBLIC?"\u590D\u5236\u94FE\u63A5":"\u590D\u5236\u94FE\u63A5\u548C\u5BC6\u7801",e.visibility===Ae.PRIVATE&&e.secret_key?this.isShare=!0:this.isShare=!1,this.updateLinkAndPassword(eo(e.id),e.secret_key)},updateLinkAndPassword(e,t){this.shareUrl=e||this.shareUrl,this.password=t||this.password,this.updateCopyText()},onResetPasswordBtnClick(){this.isLoadingResetPwd=!0,Lr(this.project.id).then(({data:e})=>{this.project.secret_key=e,this.updateLinkAndPassword(null,e)}).finally(()=>{this.isLoadingResetPwd=!1})},updateCopyText(){var e=[this.project.name?`\u300A${this.project.name}\u300B`:"",`\u94FE\u63A5\uFF1A${this.shareUrl}`];this.project.visibility!==Ae.PUBLIC&&e.push(`\u5BC6\u7801\uFF1A${this.password}`),this.$nextTick(()=>{this.copyTextEl.value=e.join(`
`)})}}},Vi={key:0,class:"-m-4"},Ui={key:1,class:"-m-4"},Gi=a("div",{class:"flex-1"},[a("h4",null,"\u5F00\u542F\u5206\u4EAB"),a("div",{class:"ivu-list-item-meta-description"},"\u5F00\u542F\u5206\u4EAB\u540E\uFF0C\u83B7\u5F97\u94FE\u63A5\u7684\u4EBA\u53EF\u4EE5\u8BBF\u95EE\u9879\u76EE\u5185\u5BB9\u3002")],-1),Yi=U("\u91CD\u7F6E\u5BC6\u7801"),zi={ref:"copyTextEl",style:{position:"fixed",left:"-9999px"}};function Hi(e,t,s,o,n,r){const i=ze,c=dt,l=xt,f=Lt,y=mo,p=go,A=He;return d(),O(A,{modelValue:e.isShow,"onUpdate:modelValue":t[4]||(t[4]=C=>e.isShow=C),width:540,"close-on-click-modal":!1,title:"\u5206\u4EAB\u9879\u76EE","append-to-body":""},{default:m(()=>[e.project&&e.project.visibility===o.PROJECT_VISIBLE_TYPES.PUBLIC?(d(),g("div",Vi,[h(f,{"label-position":"top",class:"px-6 py-3"},{default:m(()=>[h(l,{label:""},{default:m(()=>[h(c,{readonly:"",modelValue:e.shareUrl,"onUpdate:modelValue":t[0]||(t[0]=C=>e.shareUrl=C)},{append:m(()=>[h(i,{type:"primary",onClick:r.copy},{default:m(()=>[U(M(e.copyText),1)]),_:1},8,["onClick"])]),_:1},8,["modelValue"])]),_:1})]),_:1})])):j("",!0),e.project&&e.project.visibility===o.PROJECT_VISIBLE_TYPES.PRIVATE?(d(),g("div",Ui,[a("div",{class:T(["px-6 flex items-center",{"py-3":!e.isShare,"pt-3":e.isShare}])},[Gi,h(y,{loading:e.isLoading,modelValue:e.isShare,"onUpdate:modelValue":t[1]||(t[1]=C=>e.isShare=C),onChange:r.onShareStatusSwitch,"inline-prompt":"","active-text":"\u5F00","inactive-text":"\u5173"},null,8,["loading","modelValue","onChange"])],2),e.isShare?(d(),O(p,{key:0})):j("",!0),e.isShare?(d(),O(f,{key:1,"label-position":"top",class:"px-6"},{default:m(()=>[h(l,{label:"\u9879\u76EE\u94FE\u63A5"},{default:m(()=>[h(c,{readonly:"",modelValue:e.shareUrl,"onUpdate:modelValue":t[2]||(t[2]=C=>e.shareUrl=C)},{append:m(()=>[h(i,{type:"primary",onClick:r.copy},{default:m(()=>[U(M(e.copyText),1)]),_:1},8,["onClick"])]),_:1},8,["modelValue"])]),_:1}),h(l,{label:"\u5BC6\u7801"},{default:m(()=>[h(l,{prop:"date",class:"mr-1"},{default:m(()=>[h(c,{readonly:"",modelValue:e.password,"onUpdate:modelValue":t[3]||(t[3]=C=>e.password=C)},null,8,["modelValue"])]),_:1}),h(i,{loading:e.isLoadingResetPwd,onClick:r.onResetPasswordBtnClick},{default:m(()=>[Yi]),_:1},8,["loading","onClick"])]),_:1})]),_:1})):j("",!0)])):j("",!0),a("textarea",zi,null,512)]),_:1},8,["modelValue"])}var Ji=z(Ki,[["render",Hi]]);const fe=$e({id:"project",state:()=>({projectInfo:null,projectAuthInfo:{}}),getters:{isManager:e=>e.projectAuthInfo&&e.projectAuthInfo.authority===W.MANAGER,isDeveloper:e=>e.projectAuthInfo&&e.projectAuthInfo.authority===W.DEVELOPER,isReader:e=>e.projectAuthInfo&&e.projectAuthInfo.authority===W.READER,isGuest:e=>e.projectAuthInfo&&e.projectAuthInfo.authority===W.NONE,isPrivate:e=>e.projectAuthInfo&&e.projectAuthInfo.visibility===Ae.PRIVATE},actions:{async getProjectDetail(e){var o;const t=D.get(D.KEYS.SECRET_PROJECT_TOKEN+e||"",!0),{data:s}=await Fr(e,t);return this.projectInfo=ge(V({},s||{}),{visible:(o=Zt.find(n=>n.key===s.visibility))==null?void 0:o.value}),this.projectInfo},async getProjectAuth(e){const{data:t}=await Kr(e);return this.projectAuthInfo=t||{},this.projectAuthInfo.id=e,this.projectAuthInfo.in_this=this.projectAuthInfo.authority!==W.NONE,this.projectAuthInfo},async updateProjectInfo(e){var s;const t=await Rr(e);return this.projectInfo=ge(V(V({},this.projectInfo),e),{visibility:(s=Zt.find(o=>o.value===e.visible))==null?void 0:s.key}),t},clearProjectInfo(){this.projectInfo=null}}});var Wi="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAJiElEQVR4Xu2de4xU5RnGn+/Msgu7zMzusgGJlUiCCZcELbFJi7GJtrShtgs21RJMi4tim0aqmF5iayMtsTQkbbdYtNTSKtYorpWGmOItqESwaKDEFhURpFsKre7szsyZ3dlhZ87bnDNd3MvMzvnO9ZvZ9/zH8j7v937P8+NcdoYZARcHEcWSur4OhBUA5gNoIyLhomXVSJ996eDjq69fvrpqBi4zqOOwkkn9RhL0ABHNqHYTnMz/SNczmNXWWvUQOAKgL5W6gwidToyrFY0JgHlUOwTSAPTp+jUw6EUi0molTCf7GAag2iGQAsC8vidT+lECLXZiWi1pRgJQzRBIAZBOp5fmDTpQS0E63ctYAKoVAikA+lKpjUS416lptaQrBUA1QiAHQDK9g0BraylIp3spB0C1QSALwJMEusGpabWkmwiAaoKAAXBIZSUAqgUCBsBHAKoBAgbAZwBUh4ABCAAAlSFgAAICQFUIGIAAAVARAgYgYABUg4ABCAEAlSBgAEICQBUIGIAQAVABAgYgZADChoABUACAMCFgABQBICwIGACFAAgDAgZAMQCChoABcAjAY7ufRT6fd6iuLAvq3cYMQOUsSlb8+blXkErrDtX2ZEFAwADYy2Jc1etHj+HtE+87VNuX+Q0BA2A/i1GVybSOPc/vBxE57GBf5icEDID9HMZVHjryd7xz8p8uOtiX+gUBA2A/g3GVhmHghf2H8J8PEy662Jf6AQEDYN//kpUmBG8cPYbjp7qr8nLAALgEYFhu3hO8e6obZ//bg/6BbNU8IjIAHgEwtk2mP4v+7KBP3YEF8y6Vyq7cIFJN+pJp/o8hEpH6CQEDIBFEmKV+QcAAhJmq5Np+QMAASIYQdrnXEDAAYSfqYH0vIWAAHASggsQrCBgAFdJ0OIMXEDAADs1XReYWAgZAlSRdzOEGAgbAhfEqSZ1CwAColKLLWZxAwAC4NF01uSwEDIBqCXowjwwEDIAHhqvYwi4EDICK6Xk0kx0IGACPzFa1TSUIGABVk/NwrokgYAA8NFrlVuUgYABUTs3j2UpBwAB4bLLq7cZCwAConpgP842EgAHwweBqaDkMAQNQDWn5NKMJwZyLL5J6R3e5UaSa8NvCfUrUQdvW5rhUdgyAA5NVljAAKqcTwGwMQAAmq7wEA6ByOgHMxgAEYLLKSzAAKqcTwGwMQAAmq7yE5wAkOlZ83iD6IYiWAGhSefNVOVusGWLeQogVqyCaW11vwVMAejra15BBD7ueihtUdqBxOrTv/9Q1BJ4BQLfd1pjInTtHQKzy9FzhhQNiyVJoa77lqpVnAPSuab+qAHrV1TQslnMg1ozIpl/LacZUewZA4ub2GwyiJ11Nw2JpByK/+qO0ZqSAAXBlX/hiBiD8DEKdgAEI1f7wF2cAws8g1AkYgFDtD39xBiD8DEKdgAEI1f7wF2cAws8g1AkYgFDtD3/xmgWg/spPYerVy0o6TNkBFBIfoHD2DHKH9gNjvnUruv5uiLopo7VEKPQlUDh3BoWz/0L+vXdAg9mS/UvqS1Tmz5zGQNfOUCmoWQCmLb8eTV/tqGhuobcHmR1bMXTs6IXaGdu7IBoaJtRauoe3YejNw+Pq7OhN0dDxfyC1+QcVZ/SzYFIAMLB3N8x/9dYhAK1xOiJz5qJ+wWLrR0ZGR/Ke9TCSvdafhwPMnz6J3JG/FmX19Yi0zYQ2czbq5l4GIYpvhzd7D+z6w6iMSulLhWj0fIDcwZf8zLdi70kBQO9da2H09owzo+GqaxFdd6f18/6nHkX2ma5RAAzufwGZ398/TmcC0PT1b2LK3Musr2dJ/eQ7yL9/YtwZpJy+YioBFkxqAEyfWx98Atq0Rgy+9goy239uCwDrjBCNo2XLdks7dOpdC4LhY/gMwADYJ1l4/XLwyHuAcmcANEzFjK07IRqmInf4Nej3b7YNgFnYuHI1GleusjSJ228CZYrf4MkA2A9+uDIUABqu/iyit3y7eC3fswsDTz8mFWD9FZ9A7M4fWZrkpu8if/L4KH3ujYPof6r8Xb7RlwDO5+Td8lAxKS4B6a33wUinLtgmmqKou+RSTFv2RWjxFlChgJQZ4On3pACIXDwHLfcV31Gj//aXF27o7D4FpH7x45JPER7mW7HVpABgIhfMm7iBrkeQ/cvT0tdw84mgdct2S2c+Eg6+/NwogCq5zwB85JCvlwDKDwEjvlqXsv0o9HyIwtluZPfuRuHf3aOysnsNn7LwcsS/t8nSprbcg6G33hx9BjmwD5mdvynPwfnzABmVOPH17yfFGaDsTWAZa+0CMPUz12H6175hdRm5hl29r8nabM4AlDDKVoCROrRs3obIzNnWL5B6N3QA//8Gb1t6mwH5XcYAOAGgvh5Nq9Zi2rVfKN4APtSJ3IF90vcQfodrpz8DMAEA5q+Bs3t2FSummL8KnoXIrNlo+PQyRFrbrB8PnTxuPUGMPPgMYAe90TW+3gQ6vQeYaBvm08Pgvr3WE8TYVwUZgBoFwHwF0Hwp2HxJOPf6q8ifeLvkThkABQCQH2FyKmr2HmByxim/awZA3rOaUjAANRWn/GYYAHnPakrBANRUnPKbYQDkPaspBQNQU3HKb0YZAHpubv8yEf1JfguscOyAEIh0PupYbgq9+4SQjhULDcM45moaFks5IC76GLS7fyalGVvsGQC0caPWc/rIYRBd4WoiFtt2QLvuKxCfW2m7vlShZwCYzRPrvrSIhsReIrrE1VQsruzAoo8jcusGQNMq105Q4SkAFgTrb4qRnl4DaEsAKvlJoWLe/E/S9BhD4iQ665NCF0AsvtKJepzGcwDsTMVfGWPHpWBqGIBgfFZ2FQZA2WiCGYwBCMZnZVdhAJSNJpjBGIBgfFZ2FQZA2WiCGYwBCMZnZVdhAJSNJpjBGIBgfFZ2FQZA2WiCGYwBCMZnZVdhAJSNJpjBwgJgB4HWBrNFXmUCBzKtzfGoFw4VP3XR5tGX0u8lMjbaLOcyvxwQ4q3WeGyRF+2lAEin00vzBh3wYmHu4dwBIbTOlnh0g/MOHymlACAiLZnS/0ag4me98hG4A0IIo04Ti6PRqCfv45QCwNxtn65fA4NeNGEIfPe8IITAtpZ4/HavrJAGwIIglbqDCJ1eDcF97DkgIPY1x6PLhRDn7SkqVzkCwGybTOo3kqAHiGhG5WW4wo0D5mkfoAebY7G7vAzfnMkxAKa4lyiu6fo6IrQDmA+gjYhc9XRjVI1pMxCiW0A8X6fhd15d88d69D+MM3rbPGNofwAAAABJRU5ErkJggg==";const At=(e={})=>E.post("/api_doc/export",e),Ct=(e,t)=>E.get("/api_doc/export_result",{params:{project_id:e,job_id:t}}),Lo=[{text:"ApiCat",icon:Ro,type:"apicat",action:At,getJobResult:Ct},{text:"PDF",icon:Wi,type:"pdf",action:At,getJobResult:Ct},{text:"Postman(v2.1)",icon:xo,type:"postman",action:At,getJobResult:Ct}],To=Lo,qi={class:"ac-project-info ac-project-info--hover"},Qi={class:"ac-project-info__img"},Zi=["src","alt"],Xi=["onClick"],ea={key:1,class:"ac-project-info__img"},ta=["src","alt"],oa=["title"],sa=q({setup(e){const{push:t,currentRoute:s}=Re(),o=fe(),{projectInfo:n,isManager:r,isPrivate:i,isDeveloper:c}=ue(o),l=I(),f=le("projectExportModal"),y=_=>{if(_.href){t(_.href.replace("{project_id}",s.value.params.project_id));return}},p=()=>{var _;f.value.title="\u5BFC\u51FA\u9879\u76EE",(_=f.value)==null||_.show({project_id:n.value.id},Lo)},A=()=>{var _;(_=l.value)==null||_.show(n.value)},C=[{text:"\u9879\u76EE\u8BBE\u7F6E",icon:"iconIconPopoverSetting",href:"/project/{project_id}/setting"},{text:"\u516C\u5171\u53C2\u6570",icon:"iconIconPopoverConfig",href:"/project/{project_id}/params"},{text:"\u6210\u5458\u7BA1\u7406",icon:"iconIconPopoverUser",href:"/project/{project_id}/members"},{text:"\u5206\u4EAB\u9879\u76EE",icon:"iconshare2",onClick:()=>A()},{text:"\u5BFC\u51FA\u9879\u76EE",icon:"iconIconPopoverUpload",onClick:()=>p()},{text:"\u56DE\u6536\u7AD9",icon:"icontrash",href:"/project/{project_id}/trash"}],u=I(C);return ie(n,()=>{n.value&&!r.value&&(u.value=C.filter(_=>_.icon!=="iconIconPopoverSetting"))},{immediate:!0}),(_,v)=>{const N=xe,S=Y("router-link"),B=Ot,F=yo,$=Ji;return d(),g(G,null,[a("div",qi,[k(r)||k(c)?(d(),O(B,{key:0,placement:"bottom","popper-class":"ac-popper-menu ac-popper-menu--large",width:"250px"},{reference:m(()=>[a("div",Qi,[a("img",{src:k(n).icon,alt:k(n).name},null,8,Zi),h(S,{to:{name:"projects"}},{default:m(()=>[h(N,{class:"ac-project-info__back"},{default:m(()=>[h(k(Qt))]),_:1})]),_:1})])]),default:m(()=>[a("ul",null,[(d(!0),g(G,null,se(u.value,Q=>(d(),g("li",{key:Q.icon,class:T(["ac-popper-menu__item",{"border-t":Q.divided}]),onClick:_e=>Q.onClick?Q.onClick(Q):y(Q)},[a("i",{class:T(["icon iconfont mr-1",Q.icon])},null,2),U(M(Q.text),1)],10,Xi))),128))])]),_:1})):(d(),g("div",ea,[a("img",{src:k(n).icon,alt:k(n).name},null,8,ta),h(S,{to:{name:"projects"}},{default:m(()=>[h(N,{class:"ac-project-info__back"},{default:m(()=>[h(k(Qt))]),_:1})]),_:1})])),a("div",{class:"ac-project-info__title",title:k(n).name},[U(M(k(n).name)+" ",1),k(i)?(d(),O(F,{key:0,effect:"dark",content:"\u79C1\u6709\u9879\u76EE",placement:"bottom"},{default:m(()=>[h(N,{class:"ac-project-info__icon"},{default:m(()=>[h(k(vo))]),_:1})]),_:1})):j("",!0)],8,oa)]),h($,{ref_key:"projectShareModal",ref:l},null,512)],64)}}}),na={class:"ac-project-info"},ra={class:"ac-project-info__img"},ia={href:"/"},aa=["src","alt"],ca=["title"],la=q({setup(e){const t=fe(),{projectInfo:s,isPrivate:o}=ue(t);return(n,r)=>{const i=xe,c=yo;return d(),g("div",na,[a("div",ra,[a("a",ia,[a("img",{src:k(s).icon,alt:k(s).name},null,8,aa)])]),a("div",{class:"ac-project-info__title",title:k(s).name},[U(M(k(s).name)+" ",1),k(o)?(d(),O(c,{key:0,effect:"dark",content:"\u79C1\u6709\u9879\u76EE",placement:"bottom"},{default:m(()=>[h(i,{class:"ac-project-info__icon"},{default:m(()=>[h(k(vo))]),_:1})]),_:1})):j("",!0)],8,ca)])}}}),da="is.show.document.title",ua="doc.save.ing",ha="doc.save.done",pa="doc.save.error";var Ze=is();const fa={class:"ac-header-operate"},_a={class:"ac-header-operate__main"},ma={key:1},ga={key:0,class:"ac-header-operate__btns"},va=q({props:{title:{type:String,default:""}},setup(e){const t=le("documentShareModal"),s=le("projectExportModal"),{currentRoute:o,push:n}=Re(),r=fe(),{isGuest:i}=ue(r),c=I(!1),l=I(!1),f=je(()=>["ac-header-operate__title animate__animated1 animate__faster1",{hidden:!l.value}]),y=je(()=>o.value.name===De),p=()=>{const{params:v}=o.value,N=v.project_id,S=parseInt(v.node_id,10);return{project_id:N,node_id:S}},A=()=>{const{project_id:v,node_id:N}=p();if(y.value){n({name:Se,params:{project_id:v,node_id:N}});return}n({name:De,params:{project_id:v,node_id:N}})},C=()=>{var N;const{node_id:v}=p();(N=t.value)==null||N.show({docId:v,nodeId:v})},u=()=>{const{project_id:v,node_id:N}=p();s.value.title="\u5BFC\u51FA\u6587\u6863",s.value.show({project_id:v,doc_id:N},To)},_=()=>{c.value=!1};return Ze.on(da,v=>{l.value=v}),Ze.on(ua,()=>{c.value=!0}),Ze.on(ha,_),Ze.on(pa,_),(v,N)=>{const S=ze;return d(),g("div",fa,[a("div",_a,[k(y)?(d(),g("p",ma,[a("i",{class:T(["iconfont",c.value?"iconcloud-upload":"iconcloud"])},null,2),U(" "+M(c.value?"\u4FDD\u5B58\u4E2D...":"\u5DF2\u4FDD\u5B58\u5728\u4E91\u7AEF"),1)])):(d(),g("p",{key:0,class:T(k(f))},M(e.title),3))]),k(i)?j("",!0):(d(),g("div",ga,[h(S,{type:"primary",onClick:A},{default:m(()=>[U(M(k(y)?"\u9884\u89C8":"\u7F16\u8F91"),1)]),_:1}),a("i",{class:"iconfont iconshare2",onClick:C}),a("i",{class:"iconfont iconIconPopoverUpload",onClick:u})]))])}}}),ya={emits:["on-menu-item-click"],name:"NewMenus",props:{node:{type:Object,default:()=>({})}},setup(){return{menus:Mo}},methods:{onPopperItemClick(e){jt(this,"on-menu-item-click",e)}}},Aa={class:"ac-popper-menu"},Ca=["onClick"],Ea=["src"];function ka(e,t,s,o,n,r){return d(),g("ul",Aa,[(d(!0),g(G,null,se(o.menus,i=>(d(),g(G,{key:i.value},[s.node.level<5||s.node.level===5&&i.value!=="newCatetory"?(d(),g("li",{key:0,class:T(["ac-popper-menu__item",{"border-t":i.divided}]),onClick:ne(c=>r.onPopperItemClick(i),["stop"])},[i.icon?(d(),g("span",{key:0,class:T(["icon iconfont ac-popper-menu__icon",i.icon])},null,2)):j("",!0),i.img?(d(),g("img",{key:1,class:"ac-popper-menu__icon",src:i.img,alt:""},null,8,Ea)):j("",!0),U(M(i.text),1)],10,Ca)):j("",!0)],64))),128))])}var wa=z(ya,[["render",ka]]);const Na={name:"DirOperateMenus",data(){return{menus:Ba}},methods:{onPopperItemClick(e){jt(this,"on-menu-item-click",e)}}},Ia={class:"ac-popper-menu ac-popper-menu--thin"},ba=["onClick"];function Da(e,t,s,o,n,r){return d(),g("ul",Ia,[(d(!0),g(G,null,se(n.menus,i=>(d(),g("li",{class:T(["ac-popper-menu__item",{"border-t":i.divided}]),key:i.value,onClick:ne(c=>r.onPopperItemClick(i),["stop"])},M(i.text),11,ba))),128))])}var Sa=z(Na,[["render",Da]]);const Pa={emits:["on-menu-item-click"],name:"DocOperateMenus",props:{node:{type:Object,default:()=>({})},source:{type:Object,default:()=>({})},isDetailPage:{type:Boolean,default:!1}},data(){return{menus:Dt}},methods:{onPopperItemClick(e){jt(this,"on-menu-item-click",e)}}},ja={class:"ac-popper-menu ac-popper-menu--thin"},Ra=["onClick"],xa=["onClick"],La=["onClick"];function Ta(e,t,s,o,n,r){return d(),g("ul",ja,[(d(!0),g(G,null,se(n.menus,i=>(d(),g(G,null,[(i.value==="delete"||i.value==="export"||i.value==="share"||i.value==="copy")&&s.isDetailPage&&s.source.isCurrent?(d(),g("li",{class:T(["ac-popper-menu__item",{"border-t":i.divided}]),key:i.value,onClick:ne(c=>r.onPopperItemClick(i),["stop"])},M(i.text),11,Ra)):j("",!0),i.value==="delete"&&!s.isDetailPage&&s.source.isCurrent?(d(),g("li",{class:T(["ac-popper-menu__item",{"border-t":i.divided}]),key:i.value,onClick:ne(c=>r.onPopperItemClick(i),["stop"])},M(i.text),11,xa)):j("",!0),s.source.isCurrent?j("",!0):(d(),g("li",{class:T(["ac-popper-menu__item",{"border-t":i.divided}]),key:i.value,onClick:ne(c=>r.onPopperItemClick(i),["stop"])},M(i.text),11,La))],64))),256))])}var Oa=z(Pa,[["render",Ta]]),Oo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAUGVYSWZNTQAqAAAACAACARIAAwAAAAEAAQAAh2kABAAAAAEAAAAmAAAAAAADoAEAAwAAAAEAAQAAoAIABAAAAAEAAAAgoAMABAAAAAEAAAAgAAAAAL5bTO0AAAIwaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA1LjQuMCI+CiAgIDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+CiAgICAgIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICAgICAgICAgIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIgogICAgICAgICAgICB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyI+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgICAgIDxleGlmOkNvbG9yU3BhY2U+MTwvZXhpZjpDb2xvclNwYWNlPgogICAgICAgICA8ZXhpZjpQaXhlbFhEaW1lbnNpb24+MzI8L2V4aWY6UGl4ZWxYRGltZW5zaW9uPgogICAgICAgICA8ZXhpZjpQaXhlbFlEaW1lbnNpb24+MzI8L2V4aWY6UGl4ZWxZRGltZW5zaW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4K9GTeTwAAAW9JREFUWAntVLtKQ0EQvWsUi0AKtRFESaWlP2Nl/AMLK62sbExhlz+I8XusxE6sfRRBCxuv50guXJKZfS8IZuBw787ZmTk7+6iq/25GacA5/IcKZ3O/gxwBj7ZJbW6lPWj9xxRn+AZwARxw4GNaB+5mwWN8nx2J9sEfAVz9N7AFfAFDwNmJVUyyGYs/2CaA6874D3xvgEuAItgJpwhtCxAbZS+IugJegXXAuR25BaBmFSSihIAgEaUESCJO6Zw31yGcn28bb4O8FiY0i+QVXbAcAp6QlddvDdhdqOBw5BDAE38G9JVaO/DznRAthwAmpghCsk/J2fia/WnGoV++pEk5UjtQQwARbb7qO9EVHIG+ApJWadPgK4DXrIj5CihSnEmXApYdCOpAXdfm9vitp51Icpyj8ZI/6CU0xvA9mEqJ6BtMNqeDicbK/qAOyCnSvK4O7KWl/4225nAJOMkgwJpC24J7a1QcWSJnnJI/FfUDsbg5OtwYRrcAAAAASUVORK5CYII=",Ma="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABZUlEQVRYR+3XMUvEMBTA8X9uvkHE2wQRBMHJQScdHO4rCCL4DTp4izgoOLh4KBxSP4HgZ3AQXHRzcBJXXVxEHE8FI4EuXtt7LyGhg3ZsXvJ+eU3T1NDwZRrOTx1gB1gMwL0BOfCo7VsHuNAOUBH3ARxpERLgHHgSMPPAOuBm/w1MAWqEBDgEHgTAMtADnoETYN8HERuwC3R8ECkArmBqRCqAGpESMIpwizQbXU8xAV/AS8WCbQOTxf3NFAD32g2AlmLvSAJweR1itgYwXewTrjkZYNzkF4C9lI9AqnwEQGaXsFxJmX61G7rk5g6IAljBcuMJWCU3t3EALvO2nfACDMx7ER+hAl6ZS8ERAD07xyfHpaENQ3KzIfgiADK7huW6MtGZkY51EQAHts0r3RKgxZBTc5m+Ao2vgX/AX66A5lgu1WcG2Ar9GkqD+7arzwOhv2bjQPdAX3sk851ZcLy0jQYPrO34A6sFhSHFThBJAAAAAElFTkSuQmCC";const Mo=[{text:"\u65B0\u5EFA\u6587\u6863",value:"createDoc",img:Oo,onClick:"createDoc"},{text:"\u65B0\u5EFA HTTP API \u6587\u6863",value:"createHttpDoc",img:Ma,onClick:"createHttpDoc"},{text:"\u5BFC\u5165\u6587\u4EF6",value:"importFile",icon:"iconimport",onClick:"onImportBtnClick",divided:!0},{text:"\u65B0\u5EFA\u5206\u7C7B",value:"newCatetory",type:"newCatetory",icon:"iconIconPopoverTree",onClick:"onCreateDirBtnClick",divided:!0}],Dt=[{text:"\u590D\u5236",value:"copy",onClick:"onCopyBtnClick"},{text:"\u91CD\u547D\u540D",value:"rename",onClick:"onRenameBtnClick"},{text:"\u5206\u4EAB",value:"share",onClick:"onShareBtnClick"},{text:"\u5BFC\u51FA",value:"export",onClick:"onExportBtnClick"},{text:"\u5220\u9664",value:"delete",onClick:"onDeleteBtnClick"}],Ba=[Dt[1],Dt[4]],$a="DIR_NEW_TYPE",Fa="DIR_OPERATE_TYPE",Ka="DOC_OPERATE_TYPE";function Et(e,t){const s=document.createElement("div"),o=Nt(e);return as(o,s),Object.keys(t).forEach(n=>{o.component.props[n]=t[n]}),o}var Va={[$a]:{render(e){return Et(wa,e)}},[Fa]:{render(e){return Et(Sa,e)}},[Ka]:{render(e){return Et(Oa,e)}}},kt={onPopperItemClick:Ve,onPopperHide:Ve,popper:cs(document.body,{appendTo:()=>document.body,trigger:"manual",placement:"bottom",interactive:!0,theme:"light",zIndex:10}),show(e,t,s,o){const n=Va[e];!n||(this.$vm=n.render(s),ls(this.$vm.component.proxy,"on-menu-item-click",r=>{this.onPopperItemClick(V({menu:r},s)),this.hide()}),this.popper.setProps({appendTo:()=>o||document.body,getReferenceClientRect:()=>t.getBoundingClientRect(),content:this.$vm.el,onHide:()=>{this.onPopperHide()}}),this.popper.show())},hide(){this.popper.hide()}};const Ua=(e={})=>E.post("/dir/create",e),Ga=(e={})=>E.post("/dir/remove",e),Ya=(e={})=>E.post("/dir/rename",e),za=(e={})=>E.post("/api_tree/sort",e),Ha=(e,t)=>E.get("/api_tree",{params:{project_id:e,token:t}}),vd=e=>E.get("/dir/list",{params:{project_id:e}}),Xe=(e={},t=Ie.DOC)=>ge(V({},e),{type:e.type===void 0?t:e.type,isEditable:!1,isCurrent:!1,isLeaf:(e.type===void 0?t:e.type)===Ie.DOC}),Bo=$e({id:"document",state:()=>({apiDocTree:[]}),getters:{},actions:{async getApiDocTree(e){if(!e)return[];try{const t=D.get(D.KEYS.SECRET_PROJECT_TOKEN+e||"",!0),{data:s}=await Ha(e,t);this.apiDocTree=Ne(o=>(o.isLeaf=o.type===Ie.DOC,o.isEditable=!1,o.isCurrent=!1,o),s||[],{subKey:"sub_nodes"})}catch{}return this.apiDocTree}}}),Ja="el",Wa="is-",we=(e,t,s,o,n)=>{let r=`${e}-${t}`;return s&&(r+=`-${s}`),o&&(r+=`__${o}`),n&&(r+=`--${n}`),r},We=e=>{const t=je(()=>Ja);return{namespace:t,b:(u="")=>we(k(t),e,u,"",""),e:u=>u?we(k(t),e,"",u,""):"",m:u=>u?we(k(t),e,"","",u):"",be:(u,_)=>u&&_?we(k(t),e,u,_,""):"",em:(u,_)=>u&&_?we(k(t),e,"",u,_):"",bm:(u,_)=>u&&_?we(k(t),e,u,"",_):"",bem:(u,_,v)=>u&&_&&v?we(k(t),e,u,_,v):"",is:(u,..._)=>{const v=_.length>=1?_[0]:!0;return u&&v?`${Wa}${u}`:""},cssVar:u=>{const _={};for(const v in u)_[`--${t.value}-${v}`]=u[v];return _},cssVarName:u=>`--${t.value}-${u}`,cssVarBlock:u=>{const _={};for(const v in u)_[`--${t.value}-${e}-${v}`]=u[v];return _},cssVarBlockName:u=>`--${t.value}-${e}-${u}`}},qa=(e,t,s,o=!1)=>{e&&t&&s&&(e==null||e.addEventListener(t,s,o))},Qa=(e,t,s,o=!1)=>{e&&t&&s&&(e==null||e.removeEventListener(t,s,o))},Be="$treeNodeId",so=function(e,t){!t||t[Be]||Object.defineProperty(t,Be,{value:e.id,enumerable:!1,configurable:!1,writable:!1})},Vt=function(e,t){return e?t[e]:t[Be]},St=e=>{let t=!0,s=!0,o=!0;for(let n=0,r=e.length;n<r;n++){const i=e[n];(i.checked!==!0||i.indeterminate)&&(t=!1,i.disabled||(o=!1)),(i.checked!==!1||i.indeterminate)&&(s=!1)}return{all:t,none:s,allWithoutDisable:o,half:!t&&!s}},st=function(e){if(e.childNodes.length===0)return;const{all:t,none:s,half:o}=St(e.childNodes);t?(e.checked=!0,e.indeterminate=!1):o?(e.checked=!1,e.indeterminate=!0):s&&(e.checked=!1,e.indeterminate=!1);const n=e.parent;!n||n.level===0||e.store.checkStrictly||st(n)},et=function(e,t){const s=e.store.props,o=e.data||{},n=s[t];if(typeof n=="function")return n(o,e);if(typeof n=="string")return o[n];if(typeof n=="undefined"){const r=o[t];return r===void 0?"":r}};let Za=0;class Pe{constructor(t){L(this,"id");L(this,"text");L(this,"checked");L(this,"indeterminate");L(this,"data");L(this,"expanded");L(this,"parent");L(this,"visible");L(this,"isCurrent");L(this,"store");L(this,"isLeafByUser");L(this,"isLeaf");L(this,"canFocus");L(this,"level");L(this,"loaded");L(this,"childNodes");L(this,"loading");this.id=Za++,this.text=void 0,this.checked=!1,this.indeterminate=!1,this.data=void 0,this.expanded=!1,this.parent=void 0,this.visible=!0,this.isCurrent=!1,this.canFocus=!1;for(const s in t)It(t,s)&&(this[s]=t[s]);this.level=0,this.loaded=!1,this.childNodes=[],this.loading=!1,this.parent&&(this.level=this.parent.level+1)}initialize(){const t=this.store;if(!t)throw new Error("[Node]store is required!");t.registerNode(this);const s=t.props;if(s&&typeof s.isLeaf!="undefined"){const r=et(this,"isLeaf");typeof r=="boolean"&&(this.isLeafByUser=r)}if(t.lazy!==!0&&this.data?(this.setData(this.data),t.defaultExpandAll&&(this.expanded=!0,this.canFocus=!0)):this.level>0&&t.lazy&&t.defaultExpandAll&&this.expand(),Array.isArray(this.data)||so(this,this.data),!this.data)return;const o=t.defaultExpandedKeys,n=t.key;n&&o&&o.includes(this.key)&&this.expand(void 0,t.autoExpandParent),n&&t.currentNodeKey!==void 0&&this.key===t.currentNodeKey&&(t.currentNode=this,t.currentNode.isCurrent=!0),t.lazy&&t._initDefaultCheckedNode(this),this.updateLeafState(),this.parent&&(this.level===1||this.parent.expanded===!0)&&(this.canFocus=!0)}setData(t){Array.isArray(t)||so(this,t),this.data=t,this.childNodes=[];let s;this.level===0&&Array.isArray(this.data)?s=this.data:s=et(this,"children")||[];for(let o=0,n=s.length;o<n;o++)this.insertChild({data:s[o]})}get label(){return et(this,"label")}get key(){const t=this.store.key;return this.data?this.data[t]:null}get disabled(){return et(this,"disabled")}get nextSibling(){const t=this.parent;if(t){const s=t.childNodes.indexOf(this);if(s>-1)return t.childNodes[s+1]}return null}get previousSibling(){const t=this.parent;if(t){const s=t.childNodes.indexOf(this);if(s>-1)return s>0?t.childNodes[s-1]:null}return null}contains(t,s=!0){return(this.childNodes||[]).some(o=>o===t||s&&o.contains(t))}remove(){const t=this.parent;t&&t.removeChild(this)}insertChild(t,s,o){if(!t)throw new Error("InsertChild error: child is required.");if(!(t instanceof Pe)){if(!o){const n=this.getChildren(!0);n.includes(t.data)||(typeof s=="undefined"||s<0?n.push(t.data):n.splice(s,0,t.data))}Object.assign(t,{parent:this,store:this.store}),t=Pt(new Pe(t)),t instanceof Pe&&t.initialize()}t.level=this.level+1,typeof s=="undefined"||s<0?this.childNodes.push(t):this.childNodes.splice(s,0,t),this.updateLeafState()}insertBefore(t,s){let o;s&&(o=this.childNodes.indexOf(s)),this.insertChild(t,o)}insertAfter(t,s){let o;s&&(o=this.childNodes.indexOf(s),o!==-1&&(o+=1)),this.insertChild(t,o)}removeChild(t){const s=this.getChildren()||[],o=s.indexOf(t.data);o>-1&&s.splice(o,1);const n=this.childNodes.indexOf(t);n>-1&&(this.store&&this.store.deregisterNode(t),t.parent=null,this.childNodes.splice(n,1)),this.updateLeafState()}removeChildByData(t){let s=null;for(let o=0;o<this.childNodes.length;o++)if(this.childNodes[o].data===t){s=this.childNodes[o];break}s&&this.removeChild(s)}expand(t,s){const o=()=>{if(s){let n=this.parent;for(;n.level>0;)n.expanded=!0,n=n.parent}this.expanded=!0,t&&t(),this.childNodes.forEach(n=>{n.canFocus=!0})};this.shouldLoadData()?this.loadData(n=>{Array.isArray(n)&&(this.checked?this.setChecked(!0,!0):this.store.checkStrictly||st(this),o())}):o()}doCreateChildren(t,s={}){t.forEach(o=>{this.insertChild(Object.assign({data:o},s),void 0,!0)})}collapse(){this.expanded=!1,this.childNodes.forEach(t=>{t.canFocus=!1})}shouldLoadData(){return this.store.lazy===!0&&this.store.load&&!this.loaded}updateLeafState(){if(typeof this.isLeafByUser!="undefined"){this.isLeaf=this.isLeafByUser;return}this.isLeaf=!1}setChecked(t,s,o,n){if(this.indeterminate=t==="half",this.checked=t===!0,this.store.checkStrictly)return;if(!(this.shouldLoadData()&&!this.store.checkDescendants)){const{all:i,allWithoutDisable:c}=St(this.childNodes);!this.isLeaf&&!i&&c&&(this.checked=!1,t=!1);const l=()=>{if(s){const f=this.childNodes;for(let A=0,C=f.length;A<C;A++){const u=f[A];n=n||t!==!1;const _=u.disabled?u.checked:n;u.setChecked(_,s,!0,n)}const{half:y,all:p}=St(f);p||(this.checked=p,this.indeterminate=y)}};if(this.shouldLoadData()){this.loadData(()=>{l(),st(this)},{checked:t!==!1});return}else l()}const r=this.parent;!r||r.level===0||o||st(r)}getChildren(t=!1){if(this.level===0)return this.data;const s=this.data;if(!s)return null;const o=this.store.props;let n="children";return o&&(n=o.children||"children"),s[n]===void 0&&(s[n]=null),t&&!s[n]&&(s[n]=[]),s[n]}updateChildren(){const t=this.getChildren()||[],s=this.childNodes.map(r=>r.data),o={},n=[];t.forEach((r,i)=>{const c=r[Be];!!c&&s.findIndex(f=>f[Be]===c)>=0?o[c]={index:i,data:r}:n.push({index:i,data:r})}),this.store.lazy||s.forEach(r=>{o[r[Be]]||this.removeChildByData(r)}),n.forEach(({index:r,data:i})=>{this.insertChild({data:i},r)}),this.updateLeafState()}loadData(t,s={}){if(this.store.lazy===!0&&this.store.load&&!this.loaded&&(!this.loading||Object.keys(s).length)){this.loading=!0;const o=n=>{this.loaded=!0,this.loading=!1,this.childNodes=[],this.doCreateChildren(n,s),this.updateLeafState(),t&&t.call(this,n)};this.store.load(this,o)}else t&&t.call(this)}}class Xa{constructor(t){L(this,"currentNode");L(this,"currentNodeKey");L(this,"nodesMap");L(this,"root");L(this,"data");L(this,"lazy");L(this,"load");L(this,"filterNodeMethod");L(this,"key");L(this,"defaultCheckedKeys");L(this,"checkStrictly");L(this,"defaultExpandedKeys");L(this,"autoExpandParent");L(this,"defaultExpandAll");L(this,"checkDescendants");L(this,"props");this.currentNode=null,this.currentNodeKey=null;for(const s in t)It(t,s)&&(this[s]=t[s]);this.nodesMap={}}initialize(){this.root=new Pe({data:this.data,store:this}),this.root.initialize(),this.lazy&&this.load?this.load(this.root,s=>{this.root.doCreateChildren(s),this._initDefaultCheckedNodes()}):this._initDefaultCheckedNodes()}filter(t){const s=this.filterNodeMethod,o=this.lazy,n=function(r){const i=r.root?r.root.childNodes:r.childNodes;if(i.forEach(c=>{c.visible=s.call(c,t,c.data,c),n(c)}),!r.visible&&i.length){let c=!0;c=!i.some(l=>l.visible),r.root?r.root.visible=c===!1:r.visible=c===!1}!t||r.visible&&!r.isLeaf&&!o&&r.expand()};n(this)}setData(t){t!==this.root.data?(this.root.setData(t),this._initDefaultCheckedNodes()):this.root.updateChildren()}getNode(t){if(t instanceof Pe)return t;const s=typeof t!="object"?t:Vt(this.key,t);return this.nodesMap[s]||null}insertBefore(t,s){const o=this.getNode(s);o.parent.insertBefore({data:t},o)}insertAfter(t,s){const o=this.getNode(s);o.parent.insertAfter({data:t},o)}remove(t){const s=this.getNode(t);s&&s.parent&&(s===this.currentNode&&(this.currentNode=null),s.parent.removeChild(s))}append(t,s){const o=s?this.getNode(s):this.root;o&&o.insertChild({data:t})}_initDefaultCheckedNodes(){const t=this.defaultCheckedKeys||[],s=this.nodesMap;t.forEach(o=>{const n=s[o];n&&n.setChecked(!0,!this.checkStrictly)})}_initDefaultCheckedNode(t){(this.defaultCheckedKeys||[]).includes(t.key)&&t.setChecked(!0,!this.checkStrictly)}setDefaultCheckedKey(t){t!==this.defaultCheckedKeys&&(this.defaultCheckedKeys=t,this._initDefaultCheckedNodes())}registerNode(t){const s=this.key;!t||!t.data||(s?t.key!==void 0&&(this.nodesMap[t.key]=t):this.nodesMap[t.id]=t)}deregisterNode(t){!this.key||!t||!t.data||(t.childNodes.forEach(o=>{this.deregisterNode(o)}),delete this.nodesMap[t.key])}getCheckedNodes(t=!1,s=!1){const o=[],n=function(r){(r.root?r.root.childNodes:r.childNodes).forEach(c=>{(c.checked||s&&c.indeterminate)&&(!t||t&&c.isLeaf)&&o.push(c.data),n(c)})};return n(this),o}getCheckedKeys(t=!1){return this.getCheckedNodes(t).map(s=>(s||{})[this.key])}getHalfCheckedNodes(){const t=[],s=function(o){(o.root?o.root.childNodes:o.childNodes).forEach(r=>{r.indeterminate&&t.push(r.data),s(r)})};return s(this),t}getHalfCheckedKeys(){return this.getHalfCheckedNodes().map(t=>(t||{})[this.key])}_getAllNodes(){const t=[],s=this.nodesMap;for(const o in s)It(s,o)&&t.push(s[o]);return t}updateChildren(t,s){const o=this.nodesMap[t];if(!o)return;const n=o.childNodes;for(let r=n.length-1;r>=0;r--){const i=n[r];this.remove(i.data)}for(let r=0,i=s.length;r<i;r++){const c=s[r];this.append(c,o.data)}}_setCheckedKeys(t,s=!1,o){const n=this._getAllNodes().sort((c,l)=>l.level-c.level),r=Object.create(null),i=Object.keys(o);n.forEach(c=>c.setChecked(!1,!1));for(let c=0,l=n.length;c<l;c++){const f=n[c],y=f.data[t].toString();if(!i.includes(y)){f.checked&&!r[y]&&f.setChecked(!1,!1);continue}let A=f.parent;for(;A&&A.level>0;)r[A.data[t]]=!0,A=A.parent;if(f.isLeaf||this.checkStrictly){f.setChecked(!0,!1);continue}if(f.setChecked(!0,!0),s){f.setChecked(!1,!1);const C=function(u){u.childNodes.forEach(v=>{v.isLeaf||v.setChecked(!1,!1),C(v)})};C(f)}}}setCheckedNodes(t,s=!1){const o=this.key,n={};t.forEach(r=>{const i=r||{};n[i[o]]=!0}),this._setCheckedKeys(o,s,n)}setCheckedKeys(t,s=!1){this.defaultCheckedKeys=t;const o=this.key,n={};t.forEach(r=>{n[r]=!0}),this._setCheckedKeys(o,s,n)}setDefaultExpandedKeys(t){t=t||[],this.defaultExpandedKeys=t,t.forEach(s=>{const o=this.getNode(s);o&&o.expand(void 0,this.autoExpandParent)})}setChecked(t,s,o){const n=this.getNode(t);n&&n.setChecked(!!s,o)}getCurrentNode(){return this.currentNode}setCurrentNode(t){const s=this.currentNode;s&&(s.isCurrent=!1),this.currentNode=t,this.currentNode.isCurrent=!0}setUserCurrentNode(t,s=!0){const o=t[this.key],n=this.nodesMap[o];this.setCurrentNode(n),s&&this.currentNode.level>1&&this.currentNode.parent.expand(null,!0)}setCurrentNodeKey(t,s=!0){if(t==null){this.currentNode&&(this.currentNode.isCurrent=!1),this.currentNode=null;return}const o=this.getNode(t);o&&(this.setCurrentNode(o),s&&this.currentNode.level>1&&this.currentNode.parent.expand(null,!0))}}const ec=q({name:"AcTreeNodeContent",props:{node:{type:Object,required:!0},renderContent:Function},setup(e){const t=We("tree"),s=le("NodeInstance"),o=le("RootTree");return()=>{const n=e.node,{data:r,store:i}=n;return e.renderContent?e.renderContent(Nt,{_self:s,node:n,data:r,store:i}):o.ctx.slots.default?o.ctx.slots.default({node:n,data:r}):Nt("span",{class:t.be("node","label")},[n.label])}}});function $o(e){const t=le("TreeNodeMap",void 0),s={treeNodeExpand:o=>{e.node!==o&&e.node.collapse()},children:[]};return t&&t.children.push(s),re("TreeNodeMap",s),{broadcastExpanded:o=>{if(!!e.accordion)for(const n of s.children)n.treeNodeExpand(o)}}}const Fo=Symbol("dragEvents");function tc({props:e,ctx:t,el$:s,dropIndicator$:o,store:n}){const r=We("tree"),i=I({showDropIndicator:!1,draggingNode:null,dropNode:null,allowDrop:!0,dropType:null});return re(Fo,{treeNodeDragStart:({event:y,treeNode:p})=>{if(typeof e.allowDrag=="function"&&!e.allowDrag(p.node))return y.preventDefault(),!1;y.dataTransfer.effectAllowed="move";try{y.dataTransfer.setData("text/plain","")}catch{}i.value.draggingNode=p,t.emit("node-drag-start",p.node,y)},treeNodeDragOver:({event:y,treeNode:p})=>{const A=p,C=i.value.dropNode;C&&C!==A&&mt(C.$el,r.is("drop-inner"));const u=i.value.draggingNode;if(!u||!A)return;let _=!0,v=!0,N=!0,S=!0;typeof e.allowDrop=="function"&&(_=e.allowDrop(u.node,A.node,"prev"),S=v=e.allowDrop(u.node,A.node,"inner"),N=e.allowDrop(u.node,A.node,"next")),y.dataTransfer.dropEffect=v||_||N?"move":"none",(_||v||N)&&C!==A&&(C&&t.emit("node-drag-leave",u.node,C.node,y),t.emit("node-drag-enter",u.node,A.node,y)),(_||v||N)&&(i.value.dropNode=A),A.node.nextSibling===u.node&&(N=!1),A.node.previousSibling===u.node&&(_=!1),A.node.contains(u.node,!1)&&(v=!1),(u.node===A.node||u.node.contains(A.node))&&(_=!1,v=!1,N=!1);const B=A.$el.getBoundingClientRect(),F=s.value.getBoundingClientRect();let $;const Q=_?v?.25:N?.45:1:-1,_e=N?v?.75:_?.55:0:1;let Z=-9999;const b=y.clientY-B.top;b<B.height*Q?$="before":b>B.height*_e?$="after":v?$="inner":$="none";const K=A.$el.querySelector(`.${r.be("node","expand-icon")}`).getBoundingClientRect(),J=o.value;$==="before"?Z=K.top-F.top:$==="after"&&(Z=K.bottom-F.top),J.style.top=`${Z}px`,J.style.left=`${K.right-F.left}px`,$==="inner"?ds(A.$el,r.is("drop-inner")):mt(A.$el,r.is("drop-inner")),i.value.showDropIndicator=$==="before"||$==="after",i.value.allowDrop=i.value.showDropIndicator||S,i.value.dropType=$,t.emit("node-drag-over",u.node,A.node,y)},treeNodeDragEnd:y=>{const{draggingNode:p,dropType:A,dropNode:C}=i.value;if(y.preventDefault(),y.dataTransfer.dropEffect="move",p&&C){const u={data:p.node.data};A!=="none"&&p.node.remove(),A==="before"?C.node.parent.insertBefore(u,C.node):A==="after"?C.node.parent.insertAfter(u,C.node):A==="inner"&&C.node.insertChild(u),A!=="none"&&n.value.registerNode(u),mt(C.$el,r.is("drop-inner")),t.emit("node-drag-end",p.node,C.node,A,y),A!=="none"&&t.emit("node-drop",p.node,C.node,A,y)}p&&!C&&t.emit("node-drag-end",p.node,null,A,y),i.value.showDropIndicator=!1,i.value.draggingNode=null,i.value.dropNode=null,i.value.allowDrop=!0}}),{dragState:i}}const oc=q({name:"AcTreeNode",components:{NodeContent:ec,Loading:Ts},props:{node:{type:Pe,default:()=>({})},props:{type:Object,default:()=>({})},accordion:Boolean,renderContent:Function,renderAfterExpand:Boolean,showCheckbox:{type:Boolean,default:!1}},emits:["node-expand"],setup(e,t){const s=We("tree"),{broadcastExpanded:o}=$o(e),n=le("RootTree"),r=I(!1),i=I(!1),c=I(!1),l=I(!1),f=I(null),y=le(Fo),p=co();re("NodeInstance",p),e.node.expanded&&(r.value=!0,i.value=!0);const A=n.props.children||"children";ie(()=>{const b=e.node.data[A];return b&&[...b]},()=>{e.node.updateChildren()}),ie(()=>e.node.indeterminate,b=>{_(e.node.checked,b)}),ie(()=>e.node.checked,b=>{_(b,e.node.indeterminate)}),ie(()=>e.node.expanded,b=>{nt(()=>r.value=b),b&&(i.value=!0)});const C=b=>Vt(n.props.nodeKey,b.data),u=b=>{const K=e.props.class;if(!K)return{};let J;if(us(K)){const{data:Fe}=b;J=K(Fe,b)}else J=K;return hs(J)?{[J]:!0}:J},_=(b,K)=>{(c.value!==b||l.value!==K)&&n.ctx.emit("check-change",e.node.data,b,K),c.value=b,l.value=K},v=b=>{const K=n.store.value;K.setCurrentNode(e.node),n.ctx.emit("current-change",K.currentNode?K.currentNode.data:null,K.currentNode),n.currentNode.value=e.node,n.props.expandOnClickNode&&S(),n.props.checkOnClickNode&&!e.node.disabled&&B(null,{target:{checked:!e.node.checked}}),n.ctx.emit("node-click",e.node.data,e.node,p,b)},N=b=>{n.instance.vnode.props.onNodeContextmenu&&(b.stopPropagation(),b.preventDefault()),n.ctx.emit("node-contextmenu",b,e.node.data,e.node,p)},S=()=>{e.node.isLeaf||(r.value?(n.ctx.emit("node-collapse",e.node.data,e.node,p),e.node.collapse()):(e.node.expand(),t.emit("node-expand",e.node.data,e.node,p)))},B=(b,K)=>{e.node.setChecked(K.target.checked,!n.props.checkStrictly),nt(()=>{const J=n.store.value;n.ctx.emit("check",e.node.data,{checkedNodes:J.getCheckedNodes(),checkedKeys:J.getCheckedKeys(),halfCheckedNodes:J.getHalfCheckedNodes(),halfCheckedKeys:J.getHalfCheckedKeys()})})};return{ns:s,node$:f,tree:n,expanded:r,childNodeRendered:i,oldChecked:c,oldIndeterminate:l,getNodeKey:C,getNodeClass:u,handleSelectChange:_,handleClick:v,handleContextMenu:N,handleExpandIconClick:S,handleCheckChange:B,handleChildNodeExpand:(b,K,J)=>{o(K),n.ctx.emit("node-expand",b,K,J)},handleDragStart:b=>{!n.props.draggable||y.treeNodeDragStart({event:b,treeNode:e})},handleDragOver:b=>{b.preventDefault(),n.props.draggable&&y.treeNodeDragOver({event:b,treeNode:{$el:f.value,node:e.node}})},handleDrop:b=>{b.preventDefault()},handleDragEnd:b=>{!n.props.draggable||y.treeNodeDragEnd(b)},CaretRight:Os}}}),sc=["aria-expanded","aria-disabled","aria-checked","draggable","data-key"],nc=["aria-expanded"];function rc(e,t,s,o,n,r){const i=xe,c=Ms,l=Y("loading"),f=Y("node-content"),y=Y("ac-tree-node");return X((d(),g("div",{ref:"node$",class:T([e.ns.b("node"),e.ns.is("expanded",e.expanded),e.ns.is("current",e.node.isCurrent),e.ns.is("hidden",!e.node.visible),e.ns.is("focusable",!e.node.disabled),e.ns.is("checked",!e.node.disabled&&e.node.checked),e.getNodeClass(e.node)]),role:"treeitem",tabindex:"-1","aria-expanded":e.expanded,"aria-disabled":e.node.disabled,"aria-checked":e.node.checked,draggable:e.tree.props.draggable,"data-key":e.getNodeKey(e.node),onClick:t[1]||(t[1]=ne((...p)=>e.handleClick&&e.handleClick(...p),["stop"])),onContextmenu:t[2]||(t[2]=(...p)=>e.handleContextMenu&&e.handleContextMenu(...p)),onDragstart:t[3]||(t[3]=ne((...p)=>e.handleDragStart&&e.handleDragStart(...p),["stop"])),onDragover:t[4]||(t[4]=ne((...p)=>e.handleDragOver&&e.handleDragOver(...p),["stop"])),onDragend:t[5]||(t[5]=ne((...p)=>e.handleDragEnd&&e.handleDragEnd(...p),["stop"])),onDrop:t[6]||(t[6]=ne((...p)=>e.handleDrop&&e.handleDrop(...p),["stop"]))},[a("div",{class:T(e.ns.be("node","content")),style:lo({paddingLeft:(e.node.level-1)*e.tree.props.indent+"px"})},[e.tree.props.icon||e.CaretRight?(d(),O(i,{key:0,class:T([e.ns.be("node","expand-icon"),e.ns.is("leaf",e.node.isLeaf),{expanded:!e.node.isLeaf&&e.expanded}]),onClick:ne(e.handleExpandIconClick,["stop"])},{default:m(()=>[(d(),O(ps(e.tree.props.icon||e.CaretRight)))]),_:1},8,["class","onClick"])):j("",!0),e.showCheckbox?(d(),O(c,{key:1,"model-value":e.node.checked,indeterminate:e.node.indeterminate,disabled:!!e.node.disabled,onClick:t[0]||(t[0]=ne(()=>{},["stop"])),onChange:e.handleCheckChange},null,8,["model-value","indeterminate","disabled","onChange"])):j("",!0),e.node.loading?(d(),O(i,{key:2,class:T([e.ns.be("node","loading-icon"),e.ns.is("loading")])},{default:m(()=>[h(l)]),_:1},8,["class"])):j("",!0),h(f,{node:e.node,"render-content":e.renderContent},null,8,["node","render-content"])],6),!e.renderAfterExpand||e.childNodeRendered?X((d(),g("div",{key:0,class:T(e.ns.be("node","children")),role:"group","aria-expanded":e.expanded},[(d(!0),g(G,null,se(e.node.childNodes,p=>(d(),O(y,{key:e.getNodeKey(p),"render-content":e.renderContent,"render-after-expand":e.renderAfterExpand,"show-checkbox":e.showCheckbox,node:p,accordion:e.accordion,props:e.props,onNodeExpand:e.handleChildNodeExpand},null,8,["render-content","render-after-expand","show-checkbox","node","accordion","props","onNodeExpand"]))),128))],10,nc)),[[ae,e.expanded]]):j("",!0)],42,sc)),[[ae,e.node.visible]])}var ic=z(oc,[["render",rc]]);function ac({el$:e},t){const s=We("tree"),o=Jt([]),n=Jt([]);lt(()=>{i(),qa(e.value,"keydown",r)}),fs(()=>{Qa(e.value,"keydown",r)}),_s(()=>{o.value=Array.from(e.value.querySelectorAll("[role=treeitem]")),n.value=Array.from(e.value.querySelectorAll("input[type=checkbox]"))}),ie(n,c=>{c.forEach(l=>{l.setAttribute("tabindex","-1")})});const r=c=>{const l=c.target;if(!l.className.includes(s.b("node")))return;const f=c.code;o.value=Array.from(e.value.querySelectorAll(`.${s.is("focusable")}[role=treeitem]`));const y=o.value.indexOf(l);let p;if([ke.up,ke.down].includes(f)){if(c.preventDefault(),f===ke.up){p=y===-1?0:y!==0?y-1:o.value.length-1;const C=p;for(;!t.value.getNode(o.value[p].dataset.key).canFocus;){if(p--,p===C){p=-1;break}p<0&&(p=o.value.length-1)}}else{p=y===-1?0:y<o.value.length-1?y+1:0;const C=p;for(;!t.value.getNode(o.value[p].dataset.key).canFocus;){if(p++,p===C){p=-1;break}p>=o.value.length&&(p=0)}}p!==-1&&o.value[p].focus()}[ke.left,ke.right].includes(f)&&(c.preventDefault(),l.click());const A=l.querySelector('[type="checkbox"]');[ke.enter,ke.space].includes(f)&&A&&(c.preventDefault(),A.click())},i=()=>{var l;o.value=Array.from(e.value.querySelectorAll(`.${s.is("focusable")}[role=treeitem]`)),n.value=Array.from(e.value.querySelectorAll("input[type=checkbox]"));const c=e.value.querySelectorAll(`.${s.is("checked")}[role=treeitem]`);if(c.length){c[0].setAttribute("tabindex","0");return}(l=o.value[0])==null||l.setAttribute("tabindex","0")}}const cc=q({name:"AcTree",components:{AcTreeNode:ic},props:{data:{type:Array,default:()=>[]},emptyText:{type:String},renderAfterExpand:{type:Boolean,default:!0},nodeKey:String,checkStrictly:Boolean,defaultExpandAll:Boolean,expandOnClickNode:{type:Boolean,default:!0},checkOnClickNode:Boolean,checkDescendants:{type:Boolean,default:!1},autoExpandParent:{type:Boolean,default:!0},defaultCheckedKeys:Array,defaultExpandedKeys:Array,currentNodeKey:[String,Number],renderContent:Function,showCheckbox:{type:Boolean,default:!1},draggable:{type:Boolean,default:!1},allowDrag:Function,allowDrop:Function,props:{type:Object,default:()=>({children:"children",label:"label",disabled:"disabled"})},lazy:{type:Boolean,default:!1},highlightCurrent:Boolean,load:Function,filterNodeMethod:Function,accordion:Boolean,indent:{type:Number,default:18},icon:[String,Object]},emits:["check-change","current-change","node-click","node-contextmenu","node-collapse","node-expand","check","node-drag-start","node-drag-end","node-drop","node-drag-leave","node-drag-enter","node-drag-over"],setup(e,t){const s=We("tree"),o=I(new Xa({key:e.nodeKey,data:e.data,lazy:e.lazy,props:e.props,load:e.load,currentNodeKey:e.currentNodeKey,checkStrictly:e.checkStrictly,checkDescendants:e.checkDescendants,defaultCheckedKeys:e.defaultCheckedKeys,defaultExpandedKeys:e.defaultExpandedKeys,autoExpandParent:e.autoExpandParent,defaultExpandAll:e.defaultExpandAll,filterNodeMethod:e.filterNodeMethod}));o.value.initialize();const n=I(o.value.root),r=I(null),i=I(null),c=I(null),{broadcastExpanded:l}=$o(e),{dragState:f}=tc({props:e,ctx:t,el$:i,dropIndicator$:c,store:o});ac({el$:i},o);const y=je(()=>{const{childNodes:w}=n.value;return!w||w.length===0||w.every(({visible:R})=>!R)});ie(()=>e.defaultCheckedKeys,w=>{o.value.setDefaultCheckedKey(w)}),ie(()=>e.defaultExpandedKeys,w=>{o.value.setDefaultExpandedKeys(w)}),ie(()=>e.data,w=>{o.value.setData(w)},{deep:!0}),ie(()=>e.checkStrictly,w=>{o.value.checkStrictly=w});const p=w=>{if(!e.filterNodeMethod)throw new Error("[Tree] filterNodeMethod is required when filter");o.value.filter(w)},A=w=>Vt(e.nodeKey,w.data),C=w=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in getNodePath");const R=o.value.getNode(w);if(!R)return[];const me=[R.data];let Ee=R.parent;for(;Ee&&Ee!==n.value;)me.push(Ee.data),Ee=Ee.parent;return me.reverse()},u=(w,R)=>o.value.getCheckedNodes(w,R),_=w=>o.value.getCheckedKeys(w),v=()=>{const w=o.value.getCurrentNode();return w?w.data:null},N=()=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in getCurrentKey");const w=v();return w?w[e.nodeKey]:null},S=(w,R)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCheckedNodes");o.value.setCheckedNodes(w,R)},B=(w,R)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCheckedKeys");o.value.setCheckedKeys(w,R)},F=(w,R,me)=>{o.value.setChecked(w,R,me)},$=()=>o.value.getHalfCheckedNodes(),Q=()=>o.value.getHalfCheckedKeys(),_e=(w,R=!0)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCurrentNode");o.value.setUserCurrentNode(w,R)},Z=(w,R=!0)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCurrentKey");o.value.setCurrentNodeKey(w,R)},b=w=>o.value.getNode(w),K=w=>{o.value.remove(w)},J=(w,R)=>{o.value.append(w,R)},Fe=(w,R)=>{o.value.insertBefore(w,R)},ht=(w,R)=>{o.value.insertAfter(w,R)},pt=(w,R,me)=>{l(R),t.emit("node-expand",w,R,me)},ft=(w,R)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in updateKeyChild");o.value.updateChildren(w,R)};return re("RootTree",{ctx:t,props:e,store:o,root:n,currentNode:r,instance:co()}),{ns:s,store:o,root:n,currentNode:r,dragState:f,el$:i,dropIndicator$:c,isEmpty:y,filter:p,getNodeKey:A,getNodePath:C,getCheckedNodes:u,getCheckedKeys:_,getCurrentNode:v,getCurrentKey:N,setCheckedNodes:S,setCheckedKeys:B,setChecked:F,getHalfCheckedNodes:$,getHalfCheckedKeys:Q,setCurrentNode:_e,setCurrentKey:Z,getNode:b,remove:K,append:J,insertBefore:Fe,insertAfter:ht,handleNodeExpand:pt,updateKeyChildren:ft}}});function lc(e,t,s,o,n,r){var c;const i=Y("ac-tree-node");return d(),g("div",{ref:"el$",class:T([e.ns.b(),e.ns.is("dragging",!!e.dragState.draggingNode),e.ns.is("drop-not-allow",!e.dragState.allowDrop),e.ns.is("drop-inner",e.dragState.dropType==="inner"),{[e.ns.m("highlight-current")]:e.highlightCurrent}]),role:"tree"},[(d(!0),g(G,null,se(e.root.childNodes,l=>(d(),O(i,{key:e.getNodeKey(l),node:l,props:e.props,accordion:e.accordion,"render-after-expand":e.renderAfterExpand,"show-checkbox":e.showCheckbox,"render-content":e.renderContent,onNodeExpand:e.handleNodeExpand},null,8,["node","props","accordion","render-after-expand","show-checkbox","render-content","onNodeExpand"]))),128)),e.isEmpty?(d(),g("div",{key:0,class:T(e.ns.e("empty-block"))},[a("span",{class:T(e.ns.e("empty-text"))},M((c=e.emptyText)!=null?c:"\u6682\u65E0\u6570\u636E"),3)],2)):j("",!0),X(a("div",{ref:"dropIndicator$",class:T(e.ns.e("drop-indicator"))},null,2),[[ae,e.dragState.showDropIndicator]])],2)}var dc=z(cc,[["render",lc]]);const uc={props:{status:{type:String,default:()=>"success",validate(e){return["success","error"].indexOf(e)!==-1}},title:{type:String,default:()=>""},subTitle:{type:String,default:()=>""},styles:{type:Object,default:()=>({})}}},hc={class:"result"},pc={class:"result-title"},fc={class:"mt-1 result-subtitle"};function _c(e,t,s,o,n,r){return d(),g("div",hc,[a("div",{class:"result-icon",style:lo(s.styles)},[ot(e.$slots,"icon",{},void 0,!0)],4),ot(e.$slots,"title",{},()=>[a("p",pc,M(s.title),1)],!0),a("p",fc,[ot(e.$slots,"subTitle",{},()=>[U(M(s.subTitle),1)],!0)])])}var mc=z(uc,[["render",_c],["__scopeId","data-v-a27469de"]]),Ko="/assets/icon-no-result.4a7ec4ce.png";const Vo=e=>(it("data-v-23a918b8"),e=e(),at(),e),gc={class:"search-result scroll-content text-left"},vc=["onClick"],yc={class:"truncate px-2 hover:bg-gray-100"},Ac=Vo(()=>a("img",{src:Ko},null,-1)),Cc=Vo(()=>a("span",null,"\u672A\u627E\u5230\u641C\u7D22\u7ED3\u679C\uFF01",-1)),Ec=q({setup(e,{expose:t}){const{params:s}=uo(),{push:o}=Re(),{apiDocTree:n}=ue(Bo()),r=I(!1),i=I(!1),c=I(!1),l=I(""),f=I([]),y=I(),p=I(),A=I(),C=I();ro(y,()=>{r.value=!1,_()},{ignore:[C]});const u=Rt(()=>{const S=k(l);S.length<2||(i.value=!0,c.value=!0,Ei(s.project_id,S).then(B=>{f.value=B.data||[]}).catch(B=>{}).finally(()=>{c.value=!1}))},200),_=()=>{f.value=[],l.value="",i.value=!1},v=S=>{let B=null;Ne($=>{if($.id===parseInt(S.node_id,10))return B=$,!1},n.value||[],{subKey:"sub_nodes"});const F=Xc({project_id:s.project_id,node_id:S.node_id});B?o({path:F}):location.href=F};return t({show:S=>{C.value=S,r.value=!0,A.value.focus()}}),(S,B)=>{const F=dt,$=mc,Q=Ot,_e=ut;return d(),O(Q,{visible:r.value,"onUpdate:visible":B[1]||(B[1]=Z=>r.value=Z),ref_key:"popoverRef",ref:p,placement:"bottom-end","virtual-ref":C.value,"virtual-triggering":"",width:"auto"},{default:m(()=>[a("div",{ref_key:"searchDomRef",ref:y,class:"search-poptip"},[h(F,{ref_key:"searchInput",ref:A,"suffix-icon":k(Ao),placeholder:"\u5173\u952E\u5B57 \u56DE\u8F66\u641C\u7D22",modelValue:l.value,"onUpdate:modelValue":B[0]||(B[0]=Z=>l.value=Z),onChange:k(u),clearable:""},null,8,["suffix-icon","modelValue","onChange"]),X((d(),g("div",gc,[(d(!0),g(G,null,se(f.value,(Z,b)=>(d(),g("span",{class:"cursor-pointer",key:Z.doc_id+"_"+b,onClick:K=>v(Z)},[a("h4",yc,M(Z.title),1)],8,vc))),128)),X(h($,null,{icon:m(()=>[Ac]),title:m(()=>[Cc]),_:1},512),[[ae,i.value&&!c.value&&!f.value.length]])])),[[ae,i.value],[_e,c.value]])],512)]),_:1},8,["visible","virtual-ref"])}}});var kc=z(Ec,[["__scopeId","data-v-23a918b8"]]);let Ke=null;const qe=()=>{Ke&&Ke.visible.value||(Ke=Co.service({lock:!0,background:"rgba(255, 255, 255, 1)"}))},oe=()=>{Ke&&Ke.close()};var wc=q({components:{AcTree:dc,Plus:Bs,Search:Ao,MoreFilled:_o,SearchDocumentPopover:kc},setup(){const e=le("documentShareModal"),t=le("documentImportModal"),s=le("projectExportModal"),o=uo(),n=Re(),{currentRoute:r}=n,{params:i}=o,{project_id:c}=i,l=Bo(),{apiDocTree:f}=ue(l),y=fe(),{isManager:p,isDeveloper:A}=ue(y),C=Mo,u=I(null),_=I(null),v=I(null),N=I(null),S=I(null);let B=1;const F=null,$=je(()=>r.value.name===Se);ie(()=>o.params.node_id,()=>R());const Q=(x,P,ee)=>{if(ee.target.tagName!=="INPUT"){if(P.isLeaf){_e(P);return}x.expanded=!x.expanded}},_e=x=>{const{node_id:P}=r.value.params;$.value&&x.id===parseInt(P,10)||(R(x.id),n.push({name:Se,params:ge(V({},i),{node_id:x.id})}))},Z=(x,P,ee,te)=>{x.stopPropagation(),u.value=ee.id,kt.show(te,x.target,{node:P,source:ee,isDetailPage:$.value},S.value)},b=x=>{var P;Z(x,(P=v.value)==null?void 0:P.root,f.value,"DIR_NEW_TYPE")},K=ms(function(x){let P=0;return Ne(ee=>{ee.isLeaf||P++},[x],{subKey:"sub_nodes"}),P}),J=(x,P,ee)=>{const{data:te}=P,{data:he}=x;return te.isLeaf&&ee==="inner"?!1:!he.isLeaf&&!te.isLeaf?K(he)+P.level<=5:!0},Fe=x=>x.isLeaf?"is-doc":"is-dir",ht=x=>x.type===Ie.DOC,pt=async()=>{var x;await nt(),_.value&&(Wt(_.value,{scrollMode:"if-needed"}),_.value.focus(),_.value.setSelectionRange(0,(x=_.value)==null?void 0:x.value.length))},ft=x=>{x.target&&x.target.blur()},w=Rt(function(x,P){if(P.isEditable=!1,!x.target.value&&P._oldName){P.title=P._oldName;return}const ee=P.type===Ie.DIR,te=ee?Ya:Ii,he={project_id:c,title:P.title};he[ee?"node_id":"doc_id"]=P.id,te(he).then(()=>{delete P._oldName}).catch(()=>{P._oldName&&(P.title=P._oldName)})},200),R=x=>{var Gt,Yt;Ne(zt=>{if(zt.isCurrent)return zt.isCurrent=!1,!1},f.value,{subKey:"sub_nodes"});const{node_id:P}=r.value.params,te=parseInt(x||P,10),he=(Gt=v.value)==null?void 0:Gt.getNode(te);he&&(he.data.isCurrent=!0,(Yt=v.value)==null||Yt.setCurrentKey(te));const Le=document.querySelector("#tree_node_"+te);Le&&Wt(Le,{scrollMode:"if-needed"})},me=()=>{if(!v.value)return;let x=!1;if(Ne(P=>{if(P.isCurrent)return x=!0,!1},f.value,{subKey:"sub_nodes"}),!x){let P=null;Ne(he=>{let Le=v.value.getNode(he.id);if(Le&&Le.data.isLeaf)return P=Le,!1},f.value,{subKey:"sub_nodes"});let ee={project_id:c};P&&(ee.node_id=P.key,R(P.key));const te=S.value;te==null||te.scrollTo(0,0),n.replace({name:Se,params:ee})}},Ee=async()=>{qe(),await l.getApiDocTree(c),oe()},Yo=x=>{var P;(P=N.value)==null||P.show(x.currentTarget)};return lt(async()=>{await Ee(),r.value.params.node_id?R():me()}),{isManager:p,isDeveloper:A,router:n,index:B,oldDraggingNodeInfo:F,project_id:c,apiDocTree:f,renameInput:_,dir:S,activeMoreNodeId:u,treeIns:v,newMenus:C,documentShareModal:e,createDocIcon:Oo,handleTreeNodeClick:Q,onRootMoreIconClick:b,onMoreIconClick:Z,onSearchIconClick:Yo,allowDrop:J,customNodeClass:Fe,customNodeLeaf:ht,onEnterKeyUp:ft,setUnEditable:w,inputFocus:pt,activeNode:R,reactiveNode:me,documentImportModal:t,projectExportModal:s,searchDocumentPopoverRef:N}},mounted(){kt.onPopperItemClick=({menu:e,node:t,source:s})=>this.onPopperItemClick(e,t,s),kt.onPopperHide=()=>{this.activeMoreNodeId=null}},methods:{onPopperItemClick(e,t,s){const o=this[e.onClick];o&&o(t||this.treeIns.root,s||{sub_nodes:this.apiDocTree,id:0},e)},onRenameBtnClick(e,t){t._oldName=t.title,t.isEditable=!0,this.inputFocus()},onDeleteBtnClick(e,t){let s=!t.isLeaf;So({title:"\u5220\u9664\u63D0\u793A",content:h("div",{class:"break-all"},[U("\u786E\u5B9A\u5220\u9664\u300C"),t.title,U("\u300D"),s?"\u5206\u7C7B":"\u6587\u4EF6",U("\u5417\uFF1F")]),onOk:()=>{const o=t.type===Ie.DIR,n=o?Ga:bi;let r={project_id:this.project_id};return r[o?"node_id":"doc_id"]=t.id,n(r).then(i=>{pe.success(i.msg||"\u5220\u9664\u6210\u529F\uFF01"),this.treeIns.remove(e),this.reactiveNode()})}})},onCreateDirBtnClick(e,t){let s={project_id:this.project_id,name:"\u65B0\u5EFA\u5206\u7C7B"+this.index++};t.id&&(s.parent_id=t.id,s.pid=t.id),ye.start(),Ua(s).then(o=>{const n=Xe(o.data,Ie.DIR);!e.parent&&e.level===0?t.unshift(n):!t.sub_nodes||!t.sub_nodes.length?this.treeIns.append(n,e):this.treeIns.insertBefore(n,t.sub_nodes[0]),this.$nextTick(()=>{const r=this.treeIns.getNode(t);r&&(r.expanded=!0);const i=this.treeIns.getNode(o.data);i.data.isEditable=!0,setTimeout(()=>this.inputFocus(),100)})}).finally(()=>{ye.done()})},createDoc(e,t){let s={project_id:this.project_id,parent_id:e.key,pid:e.key};ye.start(),ki(s).then(({data:o})=>{this.treeIns.append(Xe(o),e),this.$nextTick(()=>{this.treeIns.setCurrentKey(o.id);const n=this.treeIns.getNode(t);n&&(n.expanded=!0),this.router.push({name:De,params:{project_id:this.project_id,node_id:o.id},query:{isNew:!0}}),this.activeNode(o.id)})}).finally(()=>{ye.done()})},onMoveNodeStart(e){const t=e.parent;this.oldDraggingNodeInfo={oldPid:t.id===0?null:t.key,oldChildIds:t.childNodes.filter(s=>s.id!==e.id).map(s=>s.key)}},onMoveNode(e,t,s){if(!this.oldDraggingNodeInfo)return;const{oldPid:o,oldChildIds:n}=this.oldDraggingNodeInfo;let r=o===t.parent.id&&s!=="inner";const i=this.treeIns.getNode(e.data).parent,c=i.id===0?null:i.key,l=i.childNodes.map(y=>y.key),f={oldPid:r?c:o,oldChildIds:r?l:n,newPid:c,newChildIds:l};this.oldDraggingNodeInfo=null,za({new_pid:f.newPid||0,new_node_ids:f.newChildIds,old_pid:f.oldPid||0,old_node_ids:f.oldChildIds,project_id:this.project_id})},onCopyBtnClick(e,t){ye.start(),Ni({project_id:this.project_id,doc_id:t.id}).then(({data:s})=>{this.treeIns.insertAfter(Xe(s),e),this.router.push({name:De,params:{project_id:this.project_id,node_id:s.id}})}).finally(()=>{ye.done()})},onShareBtnClick(e,t){this.documentShareModal.show({docId:t.id,nodeId:t.id})},onImportBtnClick(e,t){this.documentImportModal.show({project_id:this.project_id,parent_id:t.id?t.id:0},ji)},onExportBtnClick(e,t){this.projectExportModal.title="\u5BFC\u51FA\u6587\u6863",this.projectExportModal.show({project_id:this.project_id,doc_id:t.id},To)},updateTreeNode(e,t={title:""}){let s=this.treeIns.getNode(e);s&&s.data.title&&(s.data.title=t.title||s.title)},createHttpDoc(e,t){let s={project_id:this.project_id,parent_id:e.key,pid:e.key};ye.start(),wi(s).then(({data:o})=>{this.treeIns.append(Xe(o),e),this.$nextTick(()=>{const n=this.treeIns.getNode(t);n&&(n.expanded=!0),this.router.push({name:De,params:{project_id:this.project_id,node_id:o.id},query:{isNew:!0}})})}).finally(()=>{ye.done()})}}});const Nc={class:"h-full flex flex-col"},Ic={class:"ac-doc-catalog"},bc=a("h3",{class:"text-base font-medium"},"\u76EE\u5F55",-1),Dc={class:"overflow-x-scroll scroll-content flex-auto",ref:"dir"},Sc=a("div",{class:"el-tree-node__bg"},null,-1),Pc=["onClick"],jc=["id"],Rc=["src"],xc=["title"],Lc=["id","onUpdate:modelValue","maxlength","onBlur"],Tc=a("span",{class:"mx-1"},null,-1);function Oc(e,t,s,o,n,r){const i=Y("Search"),c=xe,l=Y("Plus"),f=Y("plus"),y=Y("more-filled"),p=Y("ac-tree"),A=Y("SearchDocumentPopover");return d(),g(G,null,[a("div",Nc,[a("div",Ic,[bc,a("div",null,[h(c,{class:T(["cursor-pointer text-zinc-500",{"mr-5":e.isManager||e.isDeveloper}]),onClick:e.onSearchIconClick},{default:m(()=>[h(i)]),_:1},8,["class","onClick"]),e.isManager||e.isDeveloper?(d(),O(c,{key:0,class:"cursor-pointer text-zinc-500",onClick:e.onRootMoreIconClick},{default:m(()=>[h(l)]),_:1},8,["onClick"])):j("",!0)])]),a("div",Dc,[h(p,{data:e.apiDocTree,class:"bg-transparent","node-key":"id","empty-text":"",draggable:e.isManager||e.isDeveloper,ref:"treeIns","expand-on-click-node":!1,props:{children:"sub_nodes",label:"title",class:e.customNodeClass,isLeaf:e.customNodeLeaf},"allow-drop":e.allowDrop,onNodeDragStart:e.onMoveNodeStart,onNodeDrop:e.onMoveNode},{default:m(({node:C,data:u})=>[Sc,a("div",{class:T(["flex justify-between ac-tree-node",{"is-editable":u.isEditable}])},[a("div",{class:"ac-tree-node__main",onClick:_=>e.handleTreeNodeClick(C,u,_)},[a("div",{class:T(["ac-doc-node",{"is-active":u.isCurrent}]),id:"tree_node_"+u.id},[u.isLeaf?(d(),g("img",{key:0,class:"ac-doc-node__icon",src:e.createDocIcon},null,8,Rc)):j("",!0),X(a("span",{class:"ac-doc-node__label",title:u.title},M(u.title),9,xc),[[ae,!u.isEditable]]),u.isEditable?X((d(),g("input",{key:1,type:"text",ref:"renameInput",class:"ac-doc-node__input el-input el-input__inner",id:"tree_input_"+u.id,"onUpdate:modelValue":_=>u.title=_,onKeyup:t[0]||(t[0]=po((..._)=>e.onEnterKeyUp&&e.onEnterKeyUp(..._),["enter"])),maxlength:u.isLeaf?255:50,onBlur:_=>e.setUnEditable(_,u)},null,40,Lc)),[[ho,u.title]]):j("",!0)],10,jc)],8,Pc),e.isManager||e.isDeveloper?(d(),g("div",{key:0,class:T(["ac-tree-node__more",{active:u.id===e.activeMoreNodeId}])},[X(h(c,{onClick:_=>e.onMoreIconClick(_,C,u,"DIR_NEW_TYPE")},{default:m(()=>[h(f)]),_:2},1032,["onClick"]),[[ae,!u.isLeaf]]),Tc,X(h(c,{onClick:_=>e.onMoreIconClick(_,C,u,"DIR_OPERATE_TYPE")},{default:m(()=>[h(y)]),_:2},1032,["onClick"]),[[ae,!u.isLeaf]]),X(h(c,{onClick:_=>e.onMoreIconClick(_,C,u,"DOC_OPERATE_TYPE")},{default:m(()=>[h(y)]),_:2},1032,["onClick"]),[[ae,u.isLeaf]])],2)):j("",!0)],2)]),_:1},8,["data","draggable","props","allow-drop","onNodeDragStart","onNodeDrop"])],512)]),h(A,{ref:"searchDocumentPopoverRef"},null,512)],64)}var Mc=z(wc,[["render",Oc]]);const Bc=(e={})=>bt.post("/upload_path",e),wt={},yd=e=>new Promise((t,s)=>{const o={complete:!1,width:0,height:0,src:e};if(!e){s(o);return}if(wt[e]){t(V({},wt[e]));return}const n=new Image;n.onload=()=>{o.width=n.width,o.height=n.height,o.complete=!0,wt[e]=V({},o),t(o)},n.onerror=()=>{s(o)},n.src=e});function ce(){this.chunkSize=1024*1024,this.threadsQuantity=2,this.timeout=1e3*10,this.file=null,this.aborted=!1,this.uploadedSize=0,this.progressCache={},this.activeConnections={},this.taskConfig={}}ce.prototype.setOptions=function(e={}){this.chunkSize=e.chunkSize||this.chunkSize,this.threadsQuantity=e.threadsQuantity||this.threadsQuantity};ce.prototype.setupFile=function(e){!e||(this.file=e)};ce.prototype.start=function(){if(!this.file)throw new Error("Can't start uploading: file have not chosen");const e=Math.ceil(this.file.size/this.chunkSize);this.chunksQueue=new Array(e).fill().map((o,n)=>n).reverse();const t=new XMLHttpRequest;t.timeout=this.timeout,t.open("post","/api/upload_init"),t.setRequestHeader("Content-Type","application/json;charset=UTF-8"),t.setRequestHeader("Accept","application/json, text/plain, */*");let s=D.get(D.KEYS.TOKEN)||"";s&&t.setRequestHeader("Authorization",s),t.withCredentials=!0,t.onreadystatechange=()=>{if(t.readyState===XMLHttpRequest.DONE&&t.status===200){const{status:o,msg:n,data:r}=JSON.parse(t.responseText);if(o!==0){this.complete(new Error(n||"\u4E0A\u4F20\u521D\u59CB\u5316\u5931\u8D25\uFF01"));return}this.fileId=r.file_id,this.sendNext()}},t.onerror=o=>{this.complete(o)},t.ontimeout=o=>{this.complete(o)},t.send(JSON.stringify({name:this.file.name,chunks:e,fileSize:Math.ceil(this.file.size/1024)}))};ce.prototype.sendNext=function(){const e=Object.keys(this.activeConnections).length;let t=!1;if(Object.keys(this.taskConfig).forEach(r=>{this.taskConfig[r].retryCount>=3&&(t=!0)}),t){this.complete(new Error("\u4E0A\u4F20\u5931\u8D25\uFF01"));return}if(e>=this.threadsQuantity)return;if(!this.chunksQueue.length){e||this.getResult();return}const s=this.chunksQueue.pop(),o=s*this.chunkSize,n=this.file.slice(o,o+this.chunkSize);this.sendChunk(n,s).then(()=>this.sendNext()).catch(r=>{this.chunksQueue.push(s);let i=this.taskConfig[s];i&&i.retryCount<=3?this.sendNext():this.complete(r)}),this.sendNext()};ce.prototype.complete=function(e){const t=e&&e.message||e;if(e&&!this.aborted){this.end(t);return}this.end(t)};ce.prototype.sendChunk=function(e,t){return this.upload(t,e)};ce.prototype.handleProgress=function(e,t){(t.type==="progress"||t.type==="error"||t.type==="abort")&&(this.progressCache[e]=t.loaded),t.type==="loadend"&&(this.uploadedSize+=this.progressCache[e]||0,delete this.progressCache[e]);const s=Object.keys(this.progressCache).reduce((n,r)=>n+=this.progressCache[r],0),o=Math.min(this.uploadedSize+s,this.file.size);this.onProgress&&this.onProgress({loaded:o,total:this.file.size})};ce.prototype.upload=function(e,t){return new Promise((s,o)=>{let n=this.taskConfig[e]=this.taskConfig[e]||{retryCount:0};const r=this.activeConnections[e]=new XMLHttpRequest;r.timeout=this.timeout;const i=this.handleProgress.bind(this,e);r.upload.addEventListener("progress",i),r.addEventListener("error",i),r.addEventListener("abort",i),r.addEventListener("loadend",i),r.open("post","/api/upload_save"),r.setRequestHeader("Accept","application/json, text/plain, */*");let c=D.get(D.KEYS.TOKEN)||"";c&&r.setRequestHeader("Authorization",c),r.onreadystatechange=()=>{if(delete this.activeConnections[e],r.readyState===XMLHttpRequest.DONE&&r.status===200){const f=JSON.parse(r.responseText);if(f.status!==0){o(new Error(f.msg||"\u4E0A\u4F20\u5931\u8D25\uFF01")),n.retryCount++;return}f.status===0&&s(f)}r.readyState===XMLHttpRequest.DONE&&r.status!==200&&(o(new Error("\u4E0A\u4F20\u5931\u8D25\uFF01")),n.retryCount++)},r.onerror=f=>{o(f),delete this.activeConnections[e]},r.onabort=()=>{o(new Error("\u53D6\u6D88\u4E0A\u4F20\uFF01")),delete this.activeConnections[e]},r.ontimeout=f=>{o(f),delete this.activeConnections[e]};let l=new FormData;l.append("file_id",this.fileId),l.append("chunk_id",e),l.append("file",t),r.send(l)})};ce.prototype.on=function(e,t){typeof t!="function"&&(t=Ve),this[e]=t};ce.prototype.abort=function(){Object.keys(this.activeConnections).forEach(e=>{this.activeConnections[e].abort()}),this.aborted=!0};ce.prototype.getResult=function(){Bc({file_id:this.fileId}).then(e=>this.end(null,e)).catch(e=>this.complete(e))};const $c=function(){const e=new ce;return{options:function(t){return e.setOptions(t),this},send:function(t){return e.setupFile(t),this},continue:function(){e.sendNext()},onProgress:function(t){return e.on("onProgress",t||Ve),this},end:function(t){return e.on("end",t||Ve),e.start(),this},abort:function(){e.abort()}}};const Fc={props:{maxSize:{type:Number,default:1},multiple:{type:Boolean,default:!1}},data(){return{isShow:!1,isLoading:!1,isPoll:!1,title:"\u5BFC\u5165\u6587\u6863",params:{},jobParams:{id:null},importList:[],currentConfig:null,timer:null}},methods:{projectItemClass(e){return["ac-project-export-item","ac-project-export-file",{disabled:e.disabled}]},hide(){this.isShow=!1},show(e,t){this.clearTimer(),this.isShow=!0,this.importList=t||[],this.params=e||{}},onFileChange(e,t){this.currentConfig=t||{},this.validFile(e)&&this.upload()},validFile(e){const t=e.target.files;if(!t)return!1;let s=Array.prototype.slice.call(t);if(this.multiple||(s=s.slice(0,1)),s.length===0)return!1;let o=s[0];e.target.value=null;let{maxSize:n}=this.currentConfig;return n=n||this.maxSize,o.size>n*1024*1024?(this.$Message.error(`\u6587\u4EF6\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC7${n}MB`),!1):(this.currentConfig.file=o,!0)},upload(){if(!this.currentConfig||!this.currentConfig.file)return this.$Message.error("\u672A\u9009\u62E9\u6587\u4EF6\uFF01");this.isLoading=!0,$c().options().send(this.currentConfig.file).end((e,t)=>{if(e){this.isLoading=!1,this.$Message.error(e instanceof Error?e.message:e);return}this.currentConfig.fileUrl=t.data,this.getImportJobId(this.buildParams())})},getImportJobId(e){if(!this.currentConfig||!this.currentConfig.action)return this.isLoading=!1,Promise.resolve();this.currentConfig.action(e).then(t=>{this.jobParams.id=t.data||null,this.isPoll=!0,this.getExecResult()}).catch(()=>{this.isLoading=!1})},clearTimer(){this.currentConfig=null,this.isLoading=!1,this.isPoll=!1},async exec(){if(!this.currentConfig||!this.currentConfig.getJobResult||!this.jobParams.id)return this.clearTimer(),Promise.resolve();try{const{data:e,msg:t}=await this.currentConfig.getJobResult(this.params.project_id,this.jobParams.id);if(e.result===Oe.FAIL){this.$Message.error(t||"\u5BFC\u5165\u5931\u8D25\uFF01"),this.clearTimer();return}if(e.result===Oe.WAIT)return;e.result===Oe.FINISH&&(this.$Message.success(t||"\u5BFC\u5165\u5B8C\u6210\uFF01"),this.clearTimer(),this.hide(),location.reload())}catch{this.clearTimer()}},async getExecResult(){for(;this.isPoll;)await this.exec(),await io(2e3)},buildParams(){return this.currentConfig?ge(V({},this.params),{filename:this.currentConfig.file?this.currentConfig.file.name:"\u672A\u547D\u540D",file:this.currentConfig.fileUrl,type:this.currentConfig.type}):{}}}},Kc={class:"ac-project-export","element-loading-text":"\u5BFC\u5165\u4E2D\uFF0C\u8BF7\u52FF\u5173\u95ED\u7A97\u53E3\uFF01"},Vc={class:"ac-project-export-inner"},Uc=["src","alt"],Gc={class:"mt-1.5"},Yc=["onChange","accept"];function zc(e,t,s,o,n,r){const i=He,c=ut;return d(),O(i,{modelValue:n.isShow,"onUpdate:modelValue":t[0]||(t[0]=l=>n.isShow=l),width:"fit-content","custom-class":"vertical-center-modal","close-on-click-modal":!1,title:n.title,"append-to-body":""},{default:m(()=>[X((d(),g("div",Kc,[(d(!0),g(G,null,se(n.importList,l=>(d(),g("div",{class:T(r.projectItemClass(l)),key:l.type},[a("div",Vc,[a("img",{src:l.icon,alt:l.text},null,8,Uc),a("p",Gc,M(l.text),1),a("input",{type:"file",onChange:f=>r.onFileChange(f,l),accept:l.accept},null,40,Yc)])],2))),128))])),[[c,n.isLoading]])]),_:1},8,["modelValue","title"])}var Hc=z(Fc,[["render",zc],["__scopeId","data-v-786673b5"]]);const Jc={class:"ac-doc-layout__left"},Wc={class:"ac-doc-layout__right scroll-content"},qc=q({setup(e){const{currentRoute:t}=Re(),s=fe(),{isGuest:o,isReader:n,isManager:r,isDeveloper:i,projectInfo:c}=ue(s),l=I(),f=I(),y=I(),p=I(),A=I(""),C=je(()=>["ac-doc-layout",{readonly:o.value||n.value}]),u=je(()=>!isNaN(parseInt(t.value.params.node_id,10)));return re("documentShareModal",y),re("projectExportModal",l),re("documentImportModal",f),re("updateTreeNode",(_,v)=>p.value&&p.value.updateTreeNode(_,v)),re("setDocumentTitle",_=>{A.value=_}),(_,v)=>{const N=Y("router-view"),S=Ai;return d(),g(G,null,[k(c)?(d(),g("main",{key:0,class:T(k(C))},[k(o)?(d(),O(la,{key:0})):(d(),O(sa,{key:1})),k(u)?(d(),g(G,{key:2},[k(r)||k(i)?(d(),O(va,{key:0,title:A.value},null,8,["title"])):j("",!0)],64)):j("",!0),a("div",Jc,[h(Mc,{ref_key:"directoryTree",ref:p},null,512)]),a("div",Wc,[h(N)])],2)):j("",!0),h(S,{ref_key:"projectExportModal",ref:l},null,512),h(Hc,{ref_key:"documentImportModal",ref:f},null,512),h(Fi,{ref_key:"documentShareModal",ref:y},null,512)],64)}}}),Qc=()=>H(()=>import("./DocumentDetail.79d9e63e.js"),["assets/DocumentDetail.79d9e63e.js","assets/element-plus.85f938a9.js","assets/element-plus.7d952092.css","assets/vendor.b27f3889.js","assets/useHighlight.f5a24202.js"]),Zc=()=>H(()=>import("./DocumentEditor.d092f01d.js"),["assets/DocumentEditor.d092f01d.js","assets/element-plus.85f938a9.js","assets/element-plus.7d952092.css","assets/vendor.b27f3889.js","assets/params.92cf209e.js"]),Uo="/editor/:project_id/doc/:node_id?",Go="/editor/:project_id/doc/:node_id/edit",Xc=Ye(Uo);Ye(Go);var el={path:Eo,name:$t,component:qc,redirect:{name:Se},children:[{path:Uo,name:Se,meta:{ignoreAuth:!0},component:Qc},{path:Go,name:De,component:Zc}]};const tl=q({setup(e){return(t,s)=>{const o=xe,n=$s;return d(),O(n,gs(t.$attrs,{class:"ac-backtop"}),{default:m(()=>[h(o,null,{default:m(()=>[h(k(Fs))]),_:1})]),_:1},16)}}});var ol=z(tl,[["__scopeId","data-v-de5b7756"]]);const Ad=e=>E.post("/api_doc/secretkey_check",e),sl=e=>E.get("/api_doc/has_shared",{params:{doc_id:e}}),nl=(e,t)=>E.get("/api_doc",{params:{doc_id:e,token:t,format:"html"}}),Cd=(e,t)=>E.get("/api_doc",{params:{project_id:e,doc_id:t,deleted:1,format:"html"}}),rl=e=>E.get("/preview/project",{params:{project_id:e}}),Ed=e=>E.post("/project/secretkey_check",e),il=(e,t,s)=>E.get("/preview/search",{params:{project_id:t,keywords:s,token:e}}),al={name:"ProjectSearch",data(){return{data:[],isLoading:!1,isNoData:!1,isShowSearchResult:!1,form:{token:D.get(D.KEYS.SECRET_PROJECT_TOKEN+this.$route.params.project_id||"",!0),project_id:this.$route.params.project_id,keywords:""}}},methods:{onClickSearchResult(e){let t=!1;Ne(s=>{if(s.id===(e.node_id||e.doc_id))return t=!0,!1},[]),t?this.$router.push(e.link):location.href=e.href},onStop(e){e.stopPropagation()},onSearchDocument:Rt(function(){!vs(fo(this.form.keywords))&&this.form.keywords.length>=2&&(this.isLoading=!0,this.data=[],this.isShowSearchResult=!0,il(this.form.token,this.form.project_id,this.form.keywords).then(e=>{this.data=(e.data||[]).map(t=>(t.link={name:"preview.project.document",params:{project_id:this.form.project_id,node_id:t.node_id||t.doc_id}},t.href=`/app/${this.form.project_id}/${t.node_id||t.doc_id}`,t)),this.isNoData=!this.data.length}).finally(()=>{this.isLoading=!1}))},300)},created(){document.body.addEventListener("click",e=>{this.data=[],this.form.keywords="",this.isShowSearchResult=!1})}},cl={class:"search-popper-input"},ll=a("i",{class:"icon iconfont iconsousuo"},null,-1),dl={style:{padding:"10px","text-align":"center"}},ul={key:0},hl=["onClick","title"],pl={key:1,class:"result p-2"},fl=a("div",{class:"result-icon"},[a("img",{src:Ko,alt:""})],-1),_l=a("span",null,"\u672A\u627E\u5230\u641C\u7D22\u7ED3\u679C\uFF01",-1),ml=[fl,_l];function gl(e,t,s,o,n,r){return d(),g("div",{class:"search-popper",onClick:t[3]||(t[3]=(...i)=>r.onStop&&r.onStop(...i))},[a("div",cl,[X(a("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=i=>n.form.keywords=i),placeholder:"\u641C\u7D22",maxlength:"255",onKeyup:t[1]||(t[1]=po((...i)=>r.onSearchDocument&&r.onSearchDocument(...i),["enter"]))},null,544),[[ho,n.form.keywords]]),ll]),X(a("div",{class:"search-popper-result scroll-content",onClick:t[2]||(t[2]=(...i)=>r.onStop&&r.onStop(...i))},[X(a("div",dl,"\u641C\u7D22\u4E2D...",512),[[ae,n.isLoading]]),n.data.length?(d(),g("ul",ul,[(d(!0),g(G,null,se(n.data,i=>(d(),g("li",{key:i.node_id},[a("a",{href:"javascript:void(0);",onClick:c=>r.onClickSearchResult(i),title:i.title},M(i.title),9,hl)]))),128))])):j("",!0),n.isNoData?(d(),g("div",pl,ml)):j("",!0)],512),[[ae,n.isShowSearchResult]])])}var vl=z(al,[["render",gl]]);const yl={name:"PreviewHeader",props:{isShowSearch:{type:Boolean,default:!0}},components:{ProjectSearch:vl}},Al={class:"header header-fixed"},Cl=ys('<a class="logo" href="/"><img src="'+Je+'" alt="ApiCat"><span class="logo"><span class="logo-text logo-apicat">ApiCat</span></span></a><ul class="header-nav"></ul>',2);function El(e,t,s,o,n,r){const i=Y("project-search");return d(),g("header",Al,[Cl,s.isShowSearch?(d(),O(i,{key:0})):j("",!0)])}var kl=z(yl,[["render",El]]);const Ut=q({setup(e){const t=I(!0),s=I(!0),o=r=>{t.value=r},n=r=>{s.value=r};return re("showSearchInput",o),re("showHeader",n),(r,i)=>{const c=Y("router-view"),l=ol;return d(),g(G,null,[s.value?(d(),O(kl,{key:0,"is-show-search":t.value},null,8,["is-show-search"])):j("",!0),h(c),h(l,{bottom:100,right:100})],64)}}}),wl=()=>H(()=>import("./ProjectVerification.b7c80b52.js"),["assets/ProjectVerification.b7c80b52.js","assets/element-plus.85f938a9.js","assets/element-plus.7d952092.css","assets/vendor.b27f3889.js","assets/img_join.8db8ddd5.js"]),Nl=()=>H(()=>import("./DocumentPreview.5909064c.js"),["assets/DocumentPreview.5909064c.js","assets/AcEditorDocument.f6dad31e.js","assets/vendor.b27f3889.js","assets/useHighlight.f5a24202.js","assets/element-plus.85f938a9.js","assets/element-plus.7d952092.css"]),Il=()=>H(()=>import("./DocumentVerification.042b4fc2.js"),["assets/DocumentVerification.042b4fc2.js","assets/element-plus.85f938a9.js","assets/element-plus.7d952092.css","assets/vendor.b27f3889.js","assets/img_join.8db8ddd5.js"]),bl=()=>H(()=>import("./TrashDocumentPreview.9cfacedd.js"),["assets/TrashDocumentPreview.9cfacedd.js","assets/element-plus.85f938a9.js","assets/element-plus.7d952092.css","assets/vendor.b27f3889.js","assets/AcEditorDocument.f6dad31e.js","assets/useHighlight.f5a24202.js"]);Ye("/app/:project_id");const kd=Ye("/doc/:project_id/trash_api_preview/:doc_id"),Dl={path:"/doc",name:Ge,component:Ut,meta:{ignoreAuth:!0},children:[{path:"/doc/:doc_id",name:`${Ge}.detail`,component:Nl,meta:{ignoreAuth:!0}},{path:"/doc/:doc_id/verification",name:rt,component:Il,meta:{ignoreAuth:!0}}]},Sl={path:"/app",name:Ft,component:Ut,meta:{ignoreAuth:!0},children:[{path:"/app/:project_id/verification",name:Kt,component:wl,meta:{ignoreAuth:!0}}]},Pl={path:"/doc/:project_id/trash_api_preview/:doc_id",name:"preview.trash",component:Ut,children:[{path:"",name:"preview.trash.document",component:bl}]};function jl(e){e.beforeEach(async(t,s,o)=>{const r=be().isLogin;if(t.meta.ignoreAuth){if(r&&(t.path===Ue||t.path===Mt)){o(Bt);return}o();return}if(!r){o({path:Ue,replace:!0});return}o()})}const Rl=e=>{e.beforeEach(async(t,s,o)=>{const n=fe();if(!t.matched.find(i=>i.name===$t))return o();const r=parseInt(t.params.project_id,10);if(n.projectAuthInfo&&n.projectAuthInfo.id===r)return o();try{qe();const i=await n.getProjectAuth(r);if(!i||!i.id)return oe(),o(de)}catch{return oe(),o(de)}return o()})},xl=e=>{e.beforeEach(async(t,s,o)=>{const n=fe();if(!t.matched.find(i=>i.name===$t))return o();const r=parseInt(t.params.project_id,10);if(n.projectInfo&&n.projectInfo.id===r)return o();try{qe(),await n.getProjectDetail(r),oe()}catch{return oe(),o(de)}return o()})};function Ll(e){e.beforeEach(async(t,s,o)=>t.name===De&&fe().isReader?(oe(),o(de)):o())}function Tl(e){e.beforeEach(async(t,s,o)=>{const{name:n,params:r}=t;if(n===Se){const i=fe(),{isLogin:c}=be(),l=!!D.get(D.KEYS.SECRET_PROJECT_TOKEN+r.project_id,!0),{projectAuthInfo:f,isPrivate:y}=ue(i),{has_shared:p,in_this:A}=k(f),C=k(y);if(!C){o();return}if(c&&A){o();return}if(!c&&C&&!p){oe(),o(de);return}if(C&&!p&&c&&!A){oe(),o(de);return}if(C&&!p&&c&&A){o();return}if(C&&p&&!l){oe(),o({name:Kt,params:{project_id:r.project_id}});return}if(C&&p&&l){o();return}return oe(),o(de)}return o()})}function Ol(e){e.beforeEach(async(t,s,o)=>{const n=fe();if(!oo.some(i=>i.name===t.name)||n.projectInfo&&t.params.project_id===String(n.projectInfo.id))return o();let r=null;qe();try{const i=parseInt(t.params.project_id),c=await n.getProjectDetail(i);oo.filter(y=>y.meta.role.indexOf(c.authority)!==-1).some(y=>y.name===t.name)||(r=de),await n.getProjectAuth(i)}catch{r=de}finally{oe()}return r?o(r):o()})}function Ml(e){e.beforeEach(async(t,s,o)=>{const{name:n,params:r}=t,i=!!D.get(D.KEYS.SECRET_DOCUMENT_TOKEN+r.doc_id,!0);if(String(n).startsWith(Ge)){if(!As(r.doc_id))return o(de);qe();const{data:c}=await sl(r.doc_id);return c?n===rt?(oe(),o()):i?o():(oe(),o({name:rt,params:{doc_id:r.doc_id}})):(oe(),o(de))}o()})}const Bl=e=>{jl(e),Rl(e),Ll(e),Tl(e),Ol(e),xl(e),Ml(e)},Ce=Cs({history:Es("/"),routes:[_r,mr,gr,{path:Bt,name:"main",component:Rn,redirect:{name:"projects"},children:[ai,Sr,jr,pi]},el,Sl,Dl,Pl,vr]});var $l=e=>{e.use(pe),e.use(Tt),e.use(Hr),e.use(Co),e.config.globalProperties.$Message=pe};const Fl=function(e){e.mixin({mounted:function(){e.__clipboard__&&e.__clipboard__.destroy(),e.__clipboard__=new ks(".copy_text",{text:function(t){return fo(t.getAttribute("data-text")||t.innerText||"")}}),e.__clipboard__.on("success",()=>{pe.closeAll(),pe.success("\u590D\u5236\u6210\u529F")})}})};var Kl={install:Fl};class Vl{constructor(){this._pendingMap=new Map}gatherKey(t){return[t.url,t.method,JSON.stringify(t.params)].join("_")}add(t){this.remove(t);const s=ct.CancelToken.source();t.cancelToken=t.cancelToken||s.token;const o=this.gatherKey(t);this._pendingMap.set(o,s.cancel)}remove(t){const s=this.gatherKey(t);if(this._pendingMap.has(s)){const o=this._pendingMap.get(s);o&&qt(o)&&o(),this._pendingMap.delete(s)}}removeAll(){this._pendingMap.forEach(t=>t&&qt(t)&&t()),this.clear()}clear(){this._pendingMap.clear()}}const Ul=$e({id:"preview",state:()=>({projectInfo:null,documentInfo:null}),getters:{},actions:{async getProjectInfo(e){const{data:t}=await rl(e);return this.projectInfo=t||null,this.projectInfo},async getDocumentInfo(e){const t=D.get(D.KEYS.SECRET_DOCUMENT_TOKEN+e,!0)||"",{data:s}=await nl(e,t);return this.documentInfo=s||null,this.documentInfo},goVerificationPage(){const e=Ce.currentRoute.value.params.project_id||"",t=Ce.currentRoute.value.params.doc_id||"",s=Ce.currentRoute.value.name||"";if(s.includes(Ft)){D.remove(D.KEYS.SECRET_PROJECT_TOKEN+e,!0),Ce.push({name:Kt,params:{project_id:e}});return}s.includes(Ge)&&(D.remove(D.KEYS.SECRET_DOCUMENT_TOKEN+t,!0),Ce.push({name:rt,params:{document_id:t}}))}}}),tt=new Vl,Gl=()=>{E.interceptors.request.use(e=>{tt.add(e);const t=be().token;return t&&(e.headers=ge(V({},e.headers),{Authorization:t})),e}),E.interceptors.response.use(e=>{tt.remove(e.config);let t="";!e.data&&(e.data={});const s=e.data.status;switch(e.headers.authorization&&be().updateToken(e.headers.authorization),s){case Te.NO_LOGIN:t="\u767B\u5F55\u72B6\u6001\u5DF2\u5931\u6548\uFF0C\u8BF7\u91CD\u65B0\u767B\u5F55",tt.removeAll(),be().logout();break;case Te.INVALID_PREVIEW_SECRET:t=e.data.msg||"\u8BBF\u95EE\u79D8\u94A5\u5DF2\u5931\u6548\u3002",tt.removeAll(),Ul().goVerificationPage();break;case Te.OK:case Te.NO_PARENT_DIR:case Te.NOT_FOUND:break;default:t=e.data.msg||"\u6570\u636E\u5F02\u5E38\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5\uFF01";break}return t?Promise.reject({message:t}):e.data}),E.interceptors.response.use(void 0,e=>{var r,i;let t="";const{code:s,message:o}=e||{},n=(i=(r=e==null?void 0:e.toString)==null?void 0:r.call(e))!=null?i:"";return t=o,s==="ECONNABORTED"&&t.indexOf("timeout")!==-1&&(t="\u8BF7\u6C42\u8D85\u65F6\uFF0C\u8BF7\u91CD\u8BD5"),n!=null&&n.includes("Network Error")&&(t="\u7F51\u7EDC\u5F02\u5E38\uFF0C\u8BF7\u91CD\u8BD5"),pe.closeAll(),t&&pe.error(t),Promise.reject(e)}),bt.interceptors.request.use(e=>{const t=be().token;return t&&(e.headers=ge(V({},e.headers),{Authorization:t})),e}),bt.interceptors.response.use(e=>{let t;switch(!e.data&&(e.data={}),e.data.status){case 0:break;default:t=e.data.msg||"\u6570\u636E\u5F02\u5E38\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5\uFF01";break}return t?Promise.reject(t):e.data},e=>(e.message.indexOf("timeout")!==-1&&pe.error("\u8BF7\u6C42\u8D85\u65F6\uFF0C\u8BF7\u91CD\u8BD5\uFF01"),Promise.reject(e)))};Gl();const Qe=ws(qs);Qe.use(Ns());Qe.use(Ce);Qe.use(Kl);Bl(Ce);$l(Qe);Qe.mount("#app");export{$c as $,E as A,ql as B,ad as C,Ie as D,id as E,cd as F,nd as G,pd as H,ld as I,vd as J,Te as K,Ue as L,hd as M,kd as N,Ze as O,Jl as P,da as Q,Mt as R,No as S,on as T,ji as U,md as V,oe as W,mc as X,ol as Y,H as Z,Je as _,be as a,yd as a0,fd as a1,_d as a2,gd as a3,Se as a4,ua as a5,ha as a6,pa as a7,Ii as a8,Ed as a9,eo as aa,Ul as ab,qe as ac,Ad as ad,Cd as ae,z as b,Me as c,So as d,Ql as e,Wl as f,bo as g,td as h,ed as i,ud as j,W as k,Ai as l,Xl as m,Ji as n,tn as o,Ae as p,od as q,sd as r,Zl as s,Lo as t,Zs as u,dd as v,Xc as w,fe as x,oo as y,rd as z};
