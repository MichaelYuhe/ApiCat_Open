var To=Object.defineProperty,Oo=Object.defineProperties;var Mo=Object.getOwnPropertyDescriptors;var Vt=Object.getOwnPropertySymbols;var $o=Object.prototype.hasOwnProperty,Bo=Object.prototype.propertyIsEnumerable;var ct=(e,t,o)=>t in e?To(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,B=(e,t)=>{for(var o in t||(t={}))$o.call(t,o)&&ct(e,o,t[o]);if(Vt)for(var o of Vt(t))Bo.call(t,o)&&ct(e,o,t[o]);return e},_e=(e,t)=>Oo(e,Mo(t));var x=(e,t,o)=>(ct(e,typeof t!="symbol"?t+"":t,o),o);import{aR as Pe,o as p,e as y,aS as et,aT as tt,f as a,d as Q,aU as ke,u as D,V as G,S as T,Y as d,aV as Fo,T as U,r as I,aW as ot,aX as Ko,aY as $e,x as st,a1 as Z,W as m,an as X,ab as K,_ as F,U as $,v as ie,a0 as Vo,t as le,G as Je,ay as Uo,az as Go,aZ as Yo,Z as te,M as Ze,a_ as Wt,aI as zo,Q as W,R as oe,a$ as Zt,a3 as wt,aj as qt,H as Ho,as as Nt,b0 as Jo,b1 as Qt,av as Xt,am as eo,b2 as Wo,b3 as bt,$ as to,b4 as oo,q as me,ak as gt,aQ as Zo,b5 as Le,b6 as qo,n as It,j as vt,p as so,k as Qo,l as Xo,X as es,K as Ut,z as ts,O as os,b7 as ss,b8 as he,b9 as ns,ba as rs,bb as is,aN as as,bc as cs}from"./vendor.1b70e788.js";import{E as de,a as ls,b as ds,c as us,d as hs,e as xe,f as nt,g as rt,h as Dt,i as St,j as Be,k as Pt,l as xt,m as ps,n as fs,o as no,p as ms,q as _s,_ as gs,v as it,r as ro,s as jt,t as vs,u as ys,w as io,x as As,y as Cs,z as Es,A as ks,B as ao,C as ws,D as Ns,F as bs,G as Is}from"./element-plus.33434d3d.js";const Ds=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function o(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerpolicy&&(r.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?r.credentials="include":n.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(n){if(n.ep)return;n.ep=!0;const r=o(n);fetch(n.href,r)}};Ds();const Ss=Pe({id:"app.store",state:()=>({isShowLoading:!1}),actions:{showLoading(){this.isShowLoading=!0},hideLoading(){this.isShowLoading=!1}}});var H=(e,t)=>{const o=e.__vccOpts||e;for(const[s,n]of t)o[s]=n;return o};const Ps={},xs=e=>(et("data-v-2dbca8a7"),e=e(),tt(),e),js={class:"vertical-center splash"},Rs=xs(()=>a("div",{class:"w-full text-center text-light"},[a("svg",{class:"spin",style:{width:"70px"},xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 100 100"},[a("path",{id:"p",fill:"#006bff",d:"M94.1 58.8c.6-2.8.9-5.8.9-8.8s-.3-6-.9-8.8l-11.7-.4c-.7-2.6-1.7-5-3-7.3l8-8.5c-3.3-4.9-7.5-9.2-12.5-12.5l-8.5 8c-2.3-1.3-4.7-2.3-7.3-3l-.3-11.6C56 5.3 53 5 50 5s-6 .3-8.8.9l-.4 11.7c-2.6.7-5 1.7-7.3 3l-8.5-8c-4.9 3.3-9.2 7.5-12.5 12.5l8 8.5c-1.3 2.3-2.3 4.7-3 7.3l-11.6.3C5.3 44 5 47 5 50s.3 6 .9 8.8l11.7.4c.7 2.6 1.7 5 3 7.3l-8 8.5c3.3 4.9 7.5 9.2 12.5 12.5l8.5-8c2.3 1.3 4.7 2.3 7.3 3l.4 11.7c2.7.5 5.7.8 8.7.8s6-.3 8.8-.9l.4-11.7c2.6-.7 5-1.7 7.3-3l8.5 8c4.9-3.3 9.2-7.5 12.5-12.5l-8-8.5c1.3-2.3 2.3-4.7 3-7.3l11.6-.3zM50 66.9c-9.3 0-16.9-7.6-16.9-16.9S40.7 33.1 50 33.1 66.9 40.7 66.9 50 59.3 66.9 50 66.9z"})])],-1)),Ls=[Rs];function Ts(e,t){return p(),y("div",js,Ls)}var Os=H(Ps,[["render",Ts],["__scopeId","data-v-2dbca8a7"]]);const Ms=Q({setup(e){const t=Ss(),{isShowLoading:o}=ke(t);return(s,n)=>(p(),y(U,null,[D(o)?(p(),G(Os,{key:0})):T("",!0),d(D(Fo))],64))}}),$s="/",Te="/login",Rt="/register",Lt="/main",re={path:"/404"},co="document",Oe="preview.project",qe=`${Oe}.verification`,Me="preview.document",Qe=`${Me}.verification`;var Fe="/assets/logo.1c8e1405.svg";function Bs(e,t){t=B({isCatch:!0,isShowMessage:!0},t);const o=I(!1),{isCatch:s,isShowMessage:n,msg:r}=t;async function i(c){o.value=!0;try{const l=await e(c)||{};return n&&(r||l.msg)&&de.success(r||l.msg),l}catch(l){if(s)return{};throw l}finally{o.value=!1}}return[o,i]}const Fs="/api",Ks=1e3*10,Dl=15;var be=(e=>(e[e.OK=0]="OK",e[e.FAIL=-1]="FAIL",e[e.NO_LOGIN=-2]="NO_LOGIN",e[e.NO_PARENT_DIR=-102]="NO_PARENT_DIR",e[e.NO_EXIST_TEAM=-100]="NO_EXIST_TEAM",e[e.INVALID_PREVIEW_SECRET=-103]="INVALID_PREVIEW_SECRET",e[e.NOT_FOUND=-404]="NOT_FOUND",e))(be||{});const Ie={ADMIN:0,MANAGER:1,NORMAL:2},Vs=[{text:"\u7BA1\u7406\u5458",value:Ie.MANAGER},{text:"\u666E\u901A\u6210\u5458",value:Ie.NORMAL}];[Ie.ADMIN,...Vs];const Ge={ADMIN:"admin",MANAGER:"manager",DEVELOPER:"developer",READER:"reader"},ne={MANAGER:0,DEVELOPER:1,READER:2},Us=[{text:"\u56E2\u961F\u7BA1\u7406\u5458",value:999,key:Ge.ADMIN},{text:"\u7BA1\u7406\u8005",value:0,key:Ge.MANAGER},{text:"\u7EF4\u62A4\u8005",value:1,key:Ge.DEVELOPER},{text:"\u9605\u8BFB\u8005",value:2,key:Ge.READER}],Sl=Us.filter(e=>e.key!=="admin"&&e.key!=="manager"),De={WAIT:"wait",FINISH:"finish",FAIL:"fail"},Gs="--",Pl={TYPES:[{text:"Int",value:1},{text:"Float",value:2},{text:"String",value:3},{text:"Array",value:4},{text:"Object",value:5},{text:"ArrayObject",value:8},{text:"Boolean",value:6},{text:"File",value:7}],valueOf(e){return(this.TYPES.find(t=>t.value===e)||{text:Gs}).text}},xl={API:{text:"\u63A5\u53E3\u6587\u6863",key:"api.doc",value:1},DB:{text:"\u6570\u636E\u5E93\u6587\u6863",key:"db.doc",value:2}},ye={DIR:0,DOC:1,HTTP:1,OTHER:2,MARKDOWN:3},ge={tab:"Tab",enter:"Enter",space:"Space",left:"ArrowLeft",up:"ArrowUp",right:"ArrowRight",down:"ArrowDown",esc:"Escape",delete:"Delete",backspace:"Backspace",numpadEnter:"NumpadEnter",pageUp:"PageUp",pageDown:"PageDown",home:"Home",end:"End"};function Gt(e){return typeof e=="function"}const Ys=e=>e.map(t=>({name:t.name,meta:t.meta})),lo=e=>(e||"").substring(0,1).toUpperCase(),fe=(e,t,o={subKey:"children"})=>{if(!t)return;const{subKey:s}=o;let n=!1;const r=[];for(let i=0;i<t.length;i++){const c=t[i];if(n=e(c,t)===!1,r.push(c),n)break;const l=c[s];if(l&&l.length&&(n=fe(e,l,o)===!1,n))break}return n?!1:r};function jl(e,t){e&&e.classList&&e.classList.toggle(t)}function Rl(e,t){return e&&e.getAttribute(t)}const uo=(e="")=>e.split(" ").filter(t=>!!t.trim()),Ll=(e,t)=>{if(!e||!t)return!1;if(t.includes(" "))throw new Error("className should not contain space.");return e.classList.contains(t)},zs=(e,t)=>{!e||!t.trim()||e.classList.add(...uo(t))},lt=(e,t)=>{!e||!t.trim()||e.classList.remove(...uo(t))};function Tl(e,t){!e||(e.style.display=t?null:"none")}const Ol=e=>Math.floor((Date.now()-new Date(e).getTime())/(1e3*3600*24)),yt=new WeakMap;function Tt(e){let t=yt.get(e);return t||yt.set(e,t=Object.create(null)),t}function ho(e,t,o){if(Array.isArray(t))t.forEach(s=>ho(e,s,o));else{const s=Tt(e);(s[t]||(s[t]=[])).push(o)}return e}function Hs(e,t,o){const s=(...n)=>{po(e,t,s),o.call(e,...n)};return s.fn=o,ho(e,t,s),e}function po(e,t,o){const s=e;if(!t)return yt.set(e,Object.create(null)),s;if(Array.isArray(t))return t.forEach(i=>po(e,i,o)),s;const n=Tt(e),r=n[t];return r?o?(n[t]=r.filter(i=>!(i===o||i.fn===o)),s):(n[t]=void 0,s):s}function Ot(e,t,...o){e&&e.$emit&&e.$emit(t,...o);const s=Tt(e)[t];return s&&s.map(n=>n.apply(e,o)),e}function Ml(e){return/^[A-Z0-9._+-]+@[A-Z0-9.-]+\.[A-Z]{2,63}$/i.test(e)}const Js=()=>!!window.ActiveXObject||"ActiveXObject"in window,Ws=e=>{function t(n){const r=document.getElementById("IframeReportImg");if(!r){const i=document.createElement("iframe");i.setAttribute("id","IframeReportImg"),i.setAttribute("style","display: none;"),i.setAttribute("name","IframeReportImg"),i.setAttribute("onload","downloadImg()"),i.setAttribute("width","0"),i.setAttribute("height","0"),i.setAttribute("src","about:blank"),document.body.appendChild(i)}r.getAttribute("src")!==n?r.setAttribute("src",n):o()}function o(){document.getElementById("IframeReportImg").getAttribute("src")!=="about:blank"&&window.frames.IframeReportImg.document.execCommand("SaveAs")}function s(n){const r=document.createElement("a");r.setAttribute("id","downloadImg"),r.setAttribute("style","display: none;"),r.setAttribute("href",n),document.body.appendChild(r),r.click(),document.body.removeChild(r)}Js()?t(e):s(e)},Re="api.cat",j={KEYS:{TOKEN:`${Re}.token`,USER_INFO:`${Re}.user.info`,ACTIVE_PROJECT_GROUP:`${Re}.active.project.group`,SECRET_DOCUMENT_TOKEN:`${Re}.preview.document.`,SECRET_PROJECT_TOKEN:`${Re}.preview.project.`},get(e,t){if(!this.isLocalStorage())return;const o=this.getStorage(t).getItem(e);if(o)return JSON.parse(o)},set(e,t,o){!this.isLocalStorage()||(t=JSON.stringify(t),this.getStorage(o).setItem(e,t))},remove(e,t){if(!!this.isLocalStorage())return this.getStorage(t).removeItem(e),this},removeAll(e=[]){(e.length?e:Object.keys(this.KEYS)).forEach(t=>this.remove(e.length?t:this.KEYS[t]))},getStorage(e){return e?sessionStorage:localStorage},isLocalStorage(){try{return!!window.localStorage}catch{return!1}}},fo={baseURL:Fs,headers:{Accept:"application/json, text/plain, */*"}};ot.defaults.timeout=Ks;var A=ot.create(fo);const At=ot.create(fo),Zs=(e={})=>A.post("/email_login",B({},e)),qs=(e={})=>A.post("/email_register",B({},e)),Qs=()=>A.post("/logout"),$l=(e={})=>A.post("/user/change_avatar",e),Xs=(e={})=>A.post("/user/change_profile",B({},e)),en=()=>A.get("/user/profile").then(e=>{if(e.data){const{name:t,avatar:o}=e.data;o||(e.data.lastName=lo(t||"\u65E0"))}return e}),Bl=()=>Bs((e={})=>A.post("/user/change_password",B({},e))),Ae=Pe({id:"user",state:()=>({token:j.get(j.KEYS.TOKEN)||null,userInfo:j.get(j.KEYS.USER_INFO)||{}}),getters:{isLogin:e=>!!e.token,isAdmin:e=>e.userInfo.authority===Ie.ADMIN,isManager:e=>e.userInfo.authority===Ie.MANAGER,isNormal:e=>e.userInfo.authority===Ie.NORMAL,lastName:e=>lo(e.userInfo.name)},actions:{updateToken(e){j.set(j.KEYS.TOKEN,e),this.token=e},async login(e){try{const t=await Zs(e);return await this.getUserInfo(),this.goHome(),t}catch{}},async register(e){try{const t=await qs(e);return this.goHome(),t}catch{}},async logout(){j.removeAll([j.KEYS.TOKEN,j.KEYS.USER_INFO,j.KEYS.ACTIVE_PROJECT_GROUP]);try{await Qs()}catch{}finally{this.token=null,this.userInfo={},location.href=Te}},async getUserInfo(){if(!Ko.exports.isEmpty(this.userInfo))return this.userInfo;try{const{data:e}=await en()||{};return j.set(j.KEYS.USER_INFO,e),this.userInfo=e,this.userInfo}catch{}return{}},goHome(e){pe.replace(e||Lt)},async updateUserInfo(e){await Xs(e),this.$patch({userInfo:{name:e.name,email:e.email,avatar:e.avatar}}),j.set(j.KEYS.USER_INFO,this.userInfo)}}}),tn={class:"h-14"},on={class:"shadow bg-white fixed top-0 w-full z-50"},sn={class:"viewport relative flex items-center justify-between h-14"},nn={class:"flex-1 flex items-center"},rn=a("img",{class:"h-10 w-auto",src:Fe,alt:"ApiCat"},null,-1),an=a("span",{class:"logo-text logo-apicat"},"ApiCat",-1),cn={class:"ml-6"},ln={class:"flex items-center"},dn={class:"ml-3 relative"},un={class:"el-dropdown-link"},hn={type:"button",class:"flex items-center rounded-full","aria-expanded":"false","aria-haspopup":"true"},pn=["src"],fn={key:1},mn={class:"flex flex-col divide-y text-sm justify-center"},_n={class:"px-6 py-2"},gn=["title"],vn=["title"],yn={class:"ml-1"},An=a("i",{class:"iconfont iconIconPopoverExit"},null,-1),Cn=a("span",{class:"ml-1"},"\u9000\u51FA\u767B\u5F55",-1),En=[An,Cn],kn=Q({setup(e){const t={modifiers:[{name:"offset",options:{offset:[-24,10]}}]},o=I([{name:"user.profile",title:"\u4E2A\u4EBA\u4FE1\u606F",icon:"iconIconPopoverUser"}]),s=[{name:"projects",title:"\u9879\u76EE",active:"project"},{name:"members",title:"\u6210\u5458"}],n=Ae(),{currentRoute:r}=$e(),{userInfo:i,lastName:c}=ke(n),l=async()=>{await n.logout()},_=C=>["px-3",{"text-blue-600":(r.value.name||"").startsWith(C.active||C.name)}];return st(async()=>{await n.getUserInfo()}),(C,u)=>{const h=Z("router-link"),g=ls,f=xe,w=ds,v=us;return p(),y("header",tn,[a("div",on,[a("div",sn,[a("div",nn,[d(h,{class:"inline-flex items-center",to:"/main"},{default:m(()=>[rn,an]),_:1}),a("div",cn,[(p(),y(U,null,X(s,S=>d(h,{to:{name:S.name},key:S.name,class:$(_(S))},{default:m(()=>[K(F(S.title),1)]),_:2},1032,["to","class"])),64))])]),a("div",ln,[a("div",dn,[d(v,{placement:"bottom-end",trigger:"click","popper-class":"nav-dropdown","popper-options":t},{dropdown:m(()=>[d(w,null,{default:m(()=>[a("div",mn,[a("div",_n,[a("p",{class:"text-base font-bold text-gray-600 truncate",title:D(i).name},F(D(i).name),9,gn),a("p",{class:"text-gray-500 truncate",title:D(i).email},F(D(i).email),9,vn)]),(p(!0),y(U,null,X(o.value,S=>(p(),G(h,{key:S.name,class:"flex items-center px-6 py-3 hover:text-gray-700",to:{name:S.name}},{default:m(()=>[a("i",{class:$("iconfont "+S.icon)},null,2),a("span",yn,F(S.title),1)]),_:2},1032,["to"]))),128)),a("a",{class:"flex items-center px-6 py-3 hover:text-gray-700",href:"javascript:void(0)",onClick:l},En)])]),_:1})]),default:m(()=>[a("span",un,[a("button",hn,[d(g,null,{default:m(()=>[D(i).avatar?(p(),y("img",{key:0,src:D(i).avatar},null,8,pn)):(p(),y("span",fn,F(D(c)),1))]),_:1}),d(f,{class:"el-icon--right"},{default:m(()=>[d(D(hs))]),_:1})])])]),_:1})])])])])])}}}),wn={class:"viewport px-8 py-4"},Nn=Q({setup(e){return(t,o)=>{const s=Z("router-view");return p(),y(U,null,[d(kn),a("main",wn,[d(s)])],64)}}}),bn="modulepreload",Yt={},In="/",Y=function(t,o){return!o||o.length===0?t():Promise.all(o.map(s=>{if(s=`${In}${s}`,s in Yt)return;Yt[s]=!0;const n=s.endsWith(".css"),r=n?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${s}"]${r}`))return;const i=document.createElement("link");if(i.rel=n?"stylesheet":bn,n||(i.as="script",i.crossOrigin=""),i.href=s,document.head.appendChild(i),n)return new Promise((c,l)=>{i.addEventListener("load",c),i.addEventListener("error",()=>l(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>t())};const ue=e=>(et("data-v-47f509cc"),e=e(),tt(),e),Dn={class:"h-14"},Sn={class:"shadow bg-white fixed top-0 w-full z-50"},Pn={class:"viewport relative items-center justify-between h-14 lg:flex hidden"},xn={class:"flex-1 flex items-center"},jn=ue(()=>a("div",{class:"flex-shrink-0 flex"},[a("a",{class:"inline-flex items-center",href:"/"},[a("img",{class:"h-10 w-auto",src:Fe,alt:"ApiCat"}),a("span",{class:"logo-text logo-apicat"},"ApiCat")])],-1)),Rn={key:0,class:"ml-6 hidden lg:block"},Ln=ue(()=>a("div",{class:"flex text-gray-600"},[a("a",{href:"https://apicat.net",target:"_blank",class:"px-3 py-2 rounded-md text-sm"},"\u9996\u9875"),a("a",{href:"https://apicat.net/app/31eb8ec8c295c8c4130ee50304d55ab5",target:"_blank",class:"px-3 py-2 rounded-md text-sm"},"\u6587\u6863"),a("a",{href:"https://github.com/NatosoftCN/ApiCat_Open",target:"_blank",class:"px-3 py-2 rounded-md text-sm"},"Github")],-1)),Tn=[Ln],On={key:0},Mn=K("\u767B\u5F55"),$n=K("\u6CE8\u518C"),Bn={class:"lg:hidden"},Fn={class:"flex items-center justify-between h-14 px-4 relative"},Kn=ue(()=>a("img",{class:"h-10 w-auto",src:Fe,alt:"ApiCat"},null,-1)),Vn=ue(()=>a("span",{class:"logo-text logo-apicat"},"ApiCat",-1)),Un=ue(()=>a("svg",{viewBox:"0 0 24 24",width:"1em",height:"1em",style:{"font-size":"24px"},fill:"currentColor"},[a("path",{d:"M21 7H3V5H21V7Z","fill-rule":"evenodd","clip-rule":"evenodd",fill:"currentColor"}),a("path",{d:"M21 13H3V11H21V13Z","fill-rule":"evenodd","clip-rule":"evenodd",fill:"currentColor"}),a("path",{d:"M21 19H3V17H21V19Z","fill-rule":"evenodd","clip-rule":"evenodd",fill:"currentColor"})],-1)),Gn=[Un],Yn={key:0,class:"bg-white fixed top-0 left-0 w-full max-h-screen flex flex-col z-10"},zn={class:"flex items-center justify-between h-14 px-4"},Hn=ue(()=>a("img",{class:"h-10 w-auto",src:Fe,alt:"ApiCat"},null,-1)),Jn=ue(()=>a("span",{class:"logo-text logo-apicat"},"ApiCat",-1)),Wn=ue(()=>a("svg",{viewBox:"0 0 24 24",width:"1em",height:"1em",style:{"font-size":"24px"},fill:"currentColor"},[a("path",{d:"M12.0001 13.4141L17.6568 19.0708L19.0711 17.6566L13.4143 11.9998L19.0711 6.34304L17.6569 4.92883L12.0001 10.5856L6.34314 4.92871L4.92893 6.34292L10.5859 11.9998L4.92896 17.6567L6.34317 19.071L12.0001 13.4141Z","fill-rule":"evenodd","clip-rule":"evenodd",fill:"currentColor"})],-1)),Zn=[Wn],qn={class:"flex-1 overflow-y-auto"},Qn=ue(()=>a("div",{class:"px-4 text-base font-medium"},[a("a",{class:"px-3 py-2 mb-1 rounded-lg block",href:"/"},"\u9996\u9875"),a("a",{class:"px-3 py-2 mb-1 rounded-lg block",href:"#"},"\u6587\u6863"),a("a",{class:"px-3 py-2 mb-1 rounded-lg block",href:"#"},"GitHub")],-1)),Xn={class:"px-5"},er=K("\u767B\u5F55"),tr=K("\u6CE8\u518C"),or=Q({props:{isShowNav:{type:Boolean,default:!0}},setup(e){const t=I(!1);return ie(t,()=>{document.body.classList.toggle("overflow-hidden")}),(o,s)=>{const n=nt,r=Z("router-link");return p(),y("header",Dn,[a("div",Sn,[a("div",Pn,[a("div",xn,[jn,e.isShowNav?(p(),y("div",Rn,Tn)):T("",!0)]),e.isShowNav?(p(),y("div",On,[d(r,{to:D(Te),class:"mr-4"},{default:m(()=>[d(n,null,{default:m(()=>[Mn]),_:1})]),_:1},8,["to"]),d(r,{to:D(Rt)},{default:m(()=>[d(n,{type:"primary"},{default:m(()=>[$n]),_:1})]),_:1},8,["to"])])):T("",!0)]),a("div",Bn,[a("div",Fn,[d(r,{class:"inline-flex items-center",to:"/"},{default:m(()=>[Kn,Vn]),_:1}),a("div",{class:"cursor-pointer",onClick:s[0]||(s[0]=i=>t.value=!t.value)},Gn),d(Vo,{name:"slide-fade"},{default:m(()=>[t.value?(p(),y("div",Yn,[a("div",zn,[d(r,{class:"inline-flex items-center",to:"/"},{default:m(()=>[Hn,Jn]),_:1}),a("div",{class:"cursor-pointer",onClick:s[1]||(s[1]=i=>t.value=!t.value)},Zn)]),a("div",qn,[Qn,a("div",Xn,[d(r,{to:"/login"},{default:m(()=>[d(n,{class:"w-full"},{default:m(()=>[er]),_:1})]),_:1}),d(r,{to:"/"},{default:m(()=>[d(n,{type:"primary",class:"w-full my-5"},{default:m(()=>[tr]),_:1})]),_:1})])])])):T("",!0)]),_:1}),t.value?(p(),y("div",{key:0,class:"fixed top-0 left-0 w-screen h-screen bg-opacity-40 bg-gray-900",onClick:s[2]||(s[2]=i=>t.value=!t.value)})):T("",!0)])])])])}}});var sr=H(or,[["__scopeId","data-v-47f509cc"]]);const mo=Q({setup(e){const t=I(!0);return le("switchNavState",s=>{t.value=s}),(s,n)=>{const r=Z("router-view");return p(),y(U,null,[d(sr,{"is-show-nav":t.value},null,8,["is-show-nav"]),d(r)],64)}}}),nr=()=>Y(()=>import("./Index.8b64fb78.js"),["assets/Index.8b64fb78.js","assets/Index.46d30f47.css","assets/vendor.1b70e788.js"]),rr=()=>Y(()=>import("./Login.ae4cdf0e.js"),["assets/Login.ae4cdf0e.js","assets/element-plus.33434d3d.js","assets/element-plus.07fbf481.css","assets/vendor.1b70e788.js"]),ir=()=>Y(()=>import("./Register.43cb560e.js"),["assets/Register.43cb560e.js","assets/element-plus.33434d3d.js","assets/element-plus.07fbf481.css","assets/vendor.1b70e788.js"]),ar=()=>Y(()=>import("./NotFound.67ff1a13.js"),["assets/NotFound.67ff1a13.js","assets/NotFound.3339f423.css","assets/vendor.1b70e788.js","assets/element-plus.33434d3d.js","assets/element-plus.07fbf481.css"]),cr={path:$s,name:"index",component:mo,meta:{ignoreAuth:!0},children:[{path:"",name:"index.feature",component:nr}]},lr={path:Te,name:"login",meta:{ignoreAuth:!0},component:rr},dr={path:Rt,name:"register",meta:{ignoreAuth:!0},component:ir},ur={path:"/:path(.*)*",name:"error",component:mo,meta:{ignoreAuth:!0},children:[{path:"/:path(.*)*",name:"error.not.found",component:ar}]},hr={class:"flex flex-col border divide-y bg-white"},pr=Q({props:{menus:{type:Array,default:()=>[]}},setup(e){return(t,o)=>{const s=Z("router-link");return p(),y("div",hr,[(p(!0),y(U,null,X(e.menus,n=>(p(),G(s,{key:n.name,to:{name:n.name},class:"relative h-12 pl-6 flex items-center text-neutral-600 hover:text-neutral-900"},{default:m(()=>[a("span",null,F(n.meta.title),1)]),_:2},1032,["to"]))),128))])}}}),fr={},mr={class:"flex justify-between flex-col lg:flex-row"},_r={class:"sidebar-nav flex-none lg:w-64 mb-4 lg:mb-0"},gr={class:"flex-auto lg:ml-4 overflow-hidden"};function vr(e,t){const o=pr,s=Z("RouterView");return p(),y("div",mr,[a("aside",_r,[Je(e.$slots,"default",{},()=>[d(o,Uo(Go(e.$attrs)),null,16)])]),a("div",gr,[d(s)])])}var _o=H(fr,[["render",vr]]);const yr=Q({setup(e){const t=I(go);return(o,s)=>(p(),G(_o,{menus:t.value},null,8,["menus"]))}}),Ar=()=>Y(()=>import("./UserProfile.126a57ab.js"),["assets/UserProfile.126a57ab.js","assets/ImagePreview.d5609f35.js","assets/ImagePreview.e9afec23.css","assets/element-plus.33434d3d.js","assets/element-plus.07fbf481.css","assets/vendor.1b70e788.js"]),Cr=()=>Y(()=>import("./ModifyPassword.10d2fd5f.js"),["assets/ModifyPassword.10d2fd5f.js","assets/element-plus.33434d3d.js","assets/element-plus.07fbf481.css","assets/vendor.1b70e788.js"]),go=[{path:"profile",name:"user.profile",meta:{title:"\u4E2A\u4EBA\u4FE1\u606F"},component:Ar},{path:"password",name:"user.password",meta:{title:"\u4FEE\u6539\u5BC6\u7801"},component:Cr}];var Er={path:"/user",name:"user",redirect:{name:"user.profile"},component:yr,children:go};const kr=()=>Y(()=>import("./MemberList.149f35a0.js"),["assets/MemberList.149f35a0.js","assets/element-plus.33434d3d.js","assets/element-plus.07fbf481.css","assets/vendor.1b70e788.js","assets/usePage.f8b9488d.js"]);var wr={path:"/members",name:"members",component:kr};const Fl=(e={})=>A.post("/project/create",e),Kl=(e={})=>A.post("/project/icon",e),Vl=e=>A.post("/project/remove",{project_id:e}),Ul=e=>A.post("/project/quit",{project_id:e}),Gl=(e={})=>A.post("/project/add_member",e),Yl=e=>A.get("/project/members",{params:e}),zl=(e,t)=>A.post("/project/remove_member",{project_id:e,user_id:t}),Hl=(e,t)=>A.post("/project/transfer",{project_id:e,user_id:t}),Jl=(e={})=>A.post("/project/change_member_authority",e),Nr=(e={})=>A.post("/project/setting",e),br=(e,t)=>A.post("/project/share",{project_id:e,share:t}),Ir=e=>A.post("/project/reset_share_secretkey",{project_id:e}),Wl=(e={})=>A.post("/doc/restore_api_doc",e),Zl=e=>A.get("/projects",{params:{group_id:e==0?"":e}}),Dr=e=>A.post("/project_group/create",e),Sr=()=>A.get("/project_groups"),Pr=e=>A.post("/project_group/remove",{id:e}),xr=e=>A.post("/project_group/rename",e),jr=e=>A.post("/project_group/change_order",{ids:e}),Rr=e=>A.get("/project",{params:{project_id:e}}),ql=e=>A.post("/project/change_group",e),Ql=e=>A.get("/doc/trash",{params:{project_id:e}}),Xl=e=>A.get("/project/without_members",{params:{project_id:e}}),zt={id:0,name:"\u6240\u6709\u9879\u76EE"},vo=Pe({id:"projects",state:()=>({projectGroupList:[],activeGroup:j.get(j.KEYS.ACTIVE_PROJECT_GROUP)||zt}),getters:{},actions:{async getProjectGroupList(){const{data:e=[]}=await Sr()||{};this.projectGroupList=e},switchProjectGroup(e=zt){j.set(j.KEYS.ACTIVE_PROJECT_GROUP,e),this.activeGroup=e},async addProjectGroup(e){const t=await Dr(e);return t&&this.projectGroupList.push(t.data),t},async renameProjectGroup(e){const t=await xr(e);if(t){const o=this.projectGroupList.find(s=>s.id==e.id);o.name=e.name}return t},async deleteProjectGroup(e){const t=await Pr(e.id);return this.projectGroupList=this.projectGroupList.filter(o=>o.id!==e.id),this.activeGroup.id===e.id&&this.switchProjectGroup(),t},async sortProjectGroup(e,t){const o=this.projectGroupList.splice(e,1)[0];this.projectGroupList.splice(t,0,o),await jr(this.projectGroupList.map(s=>s.id))}}}),Lr={data(){return{title:"",isShow:!1,isLoading:!1,isEdit:!1,form:{name:""},categoryInfo:null,rules:{name:{required:!0,message:"\u8BF7\u8F93\u5165\u5206\u7EC4\u540D\u79F0",trigger:"blur"}}}},watch:{isShow:function(){this.isShow&&(this.title=`${this.isEdit?"\u7F16\u8F91":"\u6DFB\u52A0"}\u5206\u7EC4`),!this.isShow&&this.reset()}},methods:_e(B({},Yo(vo,["addProjectGroup","renameProjectGroup"])),{show(e){this.isEdit=!!e,e?(this.categoryInfo=e,this.form=B({},e)):this.form.name="",this.isShow=!0,this.focus()},hide(){this.isShow=!1},onCloseBtnClick(){this.isShow=!1,this.reset()},reset(){this.$refs.teamForm.resetFields()},handleSubmit(e){this.$refs[e].validate(t=>t&&this.submit())},submit(){this.isLoading=!0,(this.isEdit?this.renameProjectGroup:this.addProjectGroup)(this.form).then(t=>{this.$Message.success(t.msg||`${this.isEdit?"\u7F16\u8F91":"\u6DFB\u52A0"}\u5206\u7EC4\u6210\u529F!`),this.onCloseBtnClick()}).finally(()=>{this.isLoading=!1}).catch(t=>{})},focus(){setTimeout(()=>this.$refs.input.focus(),200)}})},Tr=K(" \u53D6\u6D88 "),Or=K(" \u786E\u5B9A ");function Mr(e,t,o,s,n,r){const i=rt,c=Dt,l=St,_=nt,C=Be;return p(),G(C,{modelValue:n.isShow,"onUpdate:modelValue":t[4]||(t[4]=u=>n.isShow=u),width:340,"close-on-click-modal":!1,title:n.title,"append-to-body":"","custom-class":"show-footer-line"},{footer:m(()=>[d(_,{onClick:t[2]||(t[2]=u=>r.onCloseBtnClick())},{default:m(()=>[Tr]),_:1}),d(_,{loading:n.isLoading,type:"primary",onClick:t[3]||(t[3]=u=>r.handleSubmit("teamForm"))},{default:m(()=>[Or]),_:1},8,["loading"])]),default:m(()=>[d(l,{ref:"teamForm",model:n.form,rules:n.rules,"label-position":"top",style:{"margin-bottom":"-19px"},onSubmit:t[1]||(t[1]=te(u=>r.handleSubmit("teamForm"),["prevent"]))},{default:m(()=>[d(c,{label:"\u5206\u7EC4\u540D\u79F0",prop:"name",class:"hide_required"},{default:m(()=>[d(i,{type:"text",ref:"input",modelValue:n.form.name,"onUpdate:modelValue":t[0]||(t[0]=u=>n.form.name=u),placeholder:"\u8BF7\u8F93\u5165\u5206\u7EC4\u540D\u79F0",maxlength:255},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}var $r=H(Lr,[["render",Mr]]);const yo=(e=Pt)=>({title:t,message:o,content:s,cb:n,onOk:r})=>(n=n||r,o=o||s,e({title:t,message:o,showCancelButton:!0,confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",beforeClose:function(i,c,l){i==="confirm"?(c.confirmButtonLoading=!0,Promise.resolve(n(l)).then(()=>l()).catch(_=>_).finally(()=>{c.confirmButtonLoading=!1})):l()}})),Ao=yo();var Br={install:function(e){const t=e.config.globalProperties.$msgbox||Pt;e.config.globalProperties.$asyncMsgBox=yo(t)}};function Fr(e,t){function o(){Ze(async()=>{if(e=D(e),!e)return;(await Y(()=>import("./sortable.esm.85cd8ec3.js"),[])).default.create(e,B({animation:200,delay:400,delayOnTouchOnly:!0},t))})}return{initSortable:o}}const Co=e=>(et("data-v-a97b0cbc"),e=e(),tt(),e),Kr={class:"flex flex-col border divide-y bg-white"},Vr=Co(()=>a("span",{class:"ml-1"},"\u6240\u6709\u9879\u76EE",-1)),Ur=["onClick"],Gr=["title"],Yr=Co(()=>a("span",{class:"ml-1"},"\u6DFB\u52A0\u5206\u7EC4",-1)),zr=K("\u91CD\u547D\u540D "),Hr=K("\u5220\u9664 "),Jr=Q({setup(e){const t=vo(),{activeGroup:o,projectGroupList:s}=ke(t),n=I(null),r=I(!1),i=I(),c=I();let l=null;const _=v=>[{active:o.value.id===v}],C=()=>{var v;(v=n.value)==null||v.show()},u=v=>{t.switchProjectGroup(v)},h=(v,S)=>{l=S,i.value=v.currentTarget,r.value=!0},g=()=>{var v;l&&((v=n.value)==null||v.show(l))},f=()=>{l&&Ao({title:"\u5220\u9664\u63D0\u793A",content:`\u786E\u5B9A\u5220\u9664${l.name}\u5206\u7EC4\uFF1F`,onOk:()=>t.deleteProjectGroup(l).then(v=>{de.success(v.msg||"\u5220\u9664\u6210\u529F\uFF01")})})};Wt(i,v=>{var O,L;const P=v.target.parentNode,R=P.parentNode;((O=P==null?void 0:P.classList)==null?void 0:O.contains("el-icon__more"))||((L=R==null?void 0:R.classList)==null?void 0:L.contains("el-icon__more"))||(r.value=!1)});const{initSortable:w}=Fr(c,{draggable:".ac-group-nav__item",onEnd(v){t.sortProjectGroup(v.oldIndex,v.newIndex)}});return st(async()=>{await t.getProjectGroupList(),w()}),zo(()=>{l=null}),(v,S)=>{const P=xe,R=xt;return p(),y(U,null,[d(_o,null,{default:m(()=>[a("div",Kr,[a("a",{class:$(["relative h-12 pl-6 flex items-center text-neutral-600 hover:text-neutral-900",_(0)]),href:"javascript:void(0);",onClick:S[0]||(S[0]=O=>u())},[d(P,null,{default:m(()=>[d(D(ps))]),_:1}),Vr],2),W(a("div",{class:"divide-y ac-group-nav",ref_key:"sortableList",ref:c},[(p(!0),y(U,null,X(D(s),O=>(p(),y("a",{key:O.name,class:$(["relative flex pr-4 items-center justify-between text-neutral-600 hover:text-neutral-900 ac-group-nav__item",_(O.id)]),href:"javascript:void(0);"},[a("section",{class:"overflow-hidden flex items-center flex-1 h-12 pl-6",onClick:L=>u(O)},[d(P,null,{default:m(()=>[d(D(fs))]),_:1}),a("span",{class:"ml-1 truncate",title:O.name},F(O.name),9,Gr)],8,Ur),d(P,{onClick:L=>h(L,O),class:"ml-1 el-icon__more"},{default:m(()=>[d(D(no))]),_:2},1032,["onClick"])],2))),128))],512),[[oe,D(s).length]]),a("a",{class:"relative h-12 pl-6 flex items-center text-neutral-600 hover:text-neutral-900",href:"javascript:void(0);",onClick:C},[d(P,null,{default:m(()=>[d(D(ms))]),_:1}),Yr])])]),_:1}),d($r,{ref_key:"addProjectCategoryModal",ref:n},null,512),d(R,{"popper-class":"ac-popper-menu",width:"auto",visible:r.value,"onUpdate:visible":S[1]||(S[1]=O=>r.value=O),"virtual-ref":i.value,"virtual-triggering":""},{default:m(()=>[a("ul",null,[a("li",{class:"ac-popper-menu__item",onClick:g},[d(P,{class:"mr-1"},{default:m(()=>[d(D(_s))]),_:1}),zr]),a("li",{class:"ac-popper-menu__item",onClick:f},[d(P,{class:"mr-1"},{default:m(()=>[d(D(gs))]),_:1}),Hr])])]),_:1},8,["visible","virtual-ref"])],64)}}});var Wr=H(Jr,[["__scopeId","data-v-a97b0cbc"]]);const Zr=()=>Y(()=>import("./Projects.8168aa97.js"),["assets/Projects.8168aa97.js","assets/Projects.ff0ef135.css","assets/element-plus.33434d3d.js","assets/element-plus.07fbf481.css","assets/vendor.1b70e788.js","assets/ImagePreview.d5609f35.js","assets/ImagePreview.e9afec23.css"]),qr={path:"",name:"projects.index",meta:{title:"\u9879\u76EE\u5217\u8868"},component:Zr},Qr=[qr];var Xr={path:"/projects",name:"projects",redirect:{name:"projects.index"},component:Wr,children:Qr};const ei=()=>Y(()=>import("./ProjectNav.7504e4a6.js"),["assets/ProjectNav.7504e4a6.js","assets/vendor.1b70e788.js","assets/element-plus.33434d3d.js","assets/element-plus.07fbf481.css"]),ti=()=>Y(()=>import("./ProjectSetting.81fcf91a.js"),["assets/ProjectSetting.81fcf91a.js","assets/ImagePreview.d5609f35.js","assets/ImagePreview.e9afec23.css","assets/element-plus.33434d3d.js","assets/element-plus.07fbf481.css","assets/vendor.1b70e788.js"]),oi=()=>Y(()=>import("./ProjectMembers.88116a14.js"),["assets/ProjectMembers.88116a14.js","assets/element-plus.33434d3d.js","assets/element-plus.07fbf481.css","assets/vendor.1b70e788.js","assets/usePage.f8b9488d.js"]),si=()=>Y(()=>import("./ProjectParam.ad855c81.js"),["assets/ProjectParam.ad855c81.js","assets/element-plus.33434d3d.js","assets/element-plus.07fbf481.css","assets/vendor.1b70e788.js","assets/params.0b3617b4.js"]),ni=()=>Y(()=>import("./ProjectTrash.4660ee2d.js"),["assets/ProjectTrash.4660ee2d.js","assets/element-plus.33434d3d.js","assets/element-plus.07fbf481.css","assets/vendor.1b70e788.js"]),Eo=[{path:"setting",name:"project.setting",component:ti,meta:{title:"\u9879\u76EE\u8BBE\u7F6E",role:[ne.MANAGER]}},{path:"members",name:"project.members",component:oi,meta:{title:"\u9879\u76EE\u6210\u5458",role:[ne.MANAGER,ne.DEVELOPER,ne.READER]}},{path:"params",name:"project.params",component:si,meta:{title:"\u516C\u5171\u53C2\u6570",role:[ne.MANAGER,ne.DEVELOPER]}},{path:"trash",name:"project.trash",component:ni,meta:{title:"\u56DE\u6536\u7AD9",role:[ne.MANAGER,ne.DEVELOPER]}}],Ht=Ys(Eo);var ri={path:"/project/:project_id",name:"project",component:ei,redirect:{name:"project.setting"},children:Eo};const ii={data(){return{isShow:!1,isLoading:!1,isPoll:!1,title:"\u5BFC\u51FA\u9879\u76EE",params:{},exportList:[],jobParams:{id:null},currentConfig:null,timer:null}},watch:{isShow:function(){this.isShow||(this.clearTimer(),this.isLoading=!1)}},methods:{hide(){this.isShow=!1},show(e,t){this.clearTimer(),this.isShow=!0,this.exportList=t||[],this.params=e||{}},onItemClick(e){this.currentConfig=e||null,this.getImportJobId(this.buildParams(e))},getImportJobId(e){if(this.jobParams.id=null,!this.currentConfig||!this.currentConfig.action)return this.isLoading=!1,Promise.resolve();this.currentConfig.action(e).then(t=>{this.jobParams.id=t.data||null,this.isPoll=!0,this.getExecResult()}).catch(()=>{this.isLoading=!1})},clearTimer(){this.isLoading=!1,this.isPoll=!1},async exec(){if(!this.currentConfig||!this.currentConfig.getJobResult)return this.clearTimer(),Promise.resolve();this.isLoading=!0;try{const{data:e}=await this.currentConfig.getJobResult(this.params.project_id,this.jobParams.id);let t=e.description||"";if(e.result===De.FAIL&&this.isShow){this.isLoading=!1,this.$Message.error(t||"\u5BFC\u51FA\u5931\u8D25\uFF01"),this.clearTimer();return}if(e.result===De.WAIT&&this.isShow)return;e.result===De.FINISH&&this.isShow&&(this.$Message.success(t||"\u5BFC\u51FA\u5B8C\u6210\uFF01"),this.isLoading=!1,this.clearTimer(),this.hide(),e.url&&Ws(e.url))}catch{this.clearTimer()}},async getExecResult(){for(;this.isPoll;)await this.exec(this.params),await Zt(2e3)},buildParams(e){return this.params.type=e.type,this.params}},unmounted(){this.clearTimer()}},ai={class:"ac-project-export","element-loading-text":"\u5BFC\u5165\u4E2D\uFF0C\u8BF7\u52FF\u5173\u95ED\u7A97\u53E3\uFF01"},ci=["onClick"],li=["src","alt"],di={class:"mt-1.5"};function ui(e,t,o,s,n,r){const i=Be,c=it;return p(),G(i,{modelValue:n.isShow,"onUpdate:modelValue":t[0]||(t[0]=l=>n.isShow=l),width:"fit-content","close-on-click-modal":!1,"append-to-body":"",title:n.title},{default:m(()=>[W((p(),y("div",ai,[(p(!0),y(U,null,X(n.exportList,l=>(p(),y("div",{class:"ac-project-export-item",key:l.type},[a("div",{class:"ac-project-export-inner",onClick:_=>r.onItemClick(l)},[a("img",{src:l.icon,alt:l.text},null,8,li),a("p",di,F(l.text),1)],8,ci)]))),128))])),[[c,n.isLoading]])]),_:1},8,["modelValue","title"])}var hi=H(ii,[["render",ui],["__scopeId","data-v-22a7e993"]]);const pi={setup(){const e=wt({project:null,dom:null,isShow:!1,isLoading:!1,isLoadingResetPwd:!1,shareUrl:"",isShare:!1,password:"",copyText:"",copyTextEl:I()});return B({},qt(e))},methods:{onShareStatusSwitch(e){this.project!==null&&(this.isLoading=!0,br(this.project.id,Number(e)).then(({msg:t,data:o})=>{o=o||{},this.$Message.success(t||"\u64CD\u4F5C\u6210\u529F"),this.updateLinkAndPassword(o.link,o.secret_key),e?this.project.secret_key=o.secret_key:delete this.project.secret_key}).catch(t=>{this.isShare=!this.isShare}).finally(()=>{this.isLoading=!1}))},copy(){this.copyTextEl.select(),document.execCommand("copy")&&(this.copyText="\u590D\u5236\u6210\u529F",setTimeout(()=>{this.copyText=this.project.visibility===1?"\u590D\u5236\u94FE\u63A5":"\u590D\u5236\u94FE\u63A5\u548C\u5BC6\u7801"},2e3))},show(e={}){this.isShow=!0,this.project=e,this.copyText=e.visibility===1?"\u590D\u5236\u94FE\u63A5":"\u590D\u5236\u94FE\u63A5\u548C\u5BC6\u7801",e.visibility===0&&e.secret_key?this.isShare=!0:this.isShare=!1,this.updateLinkAndPassword(e.preview_link,e.secret_key)},updateLinkAndPassword(e,t){this.shareUrl=e||this.shareUrl,this.password=t||this.password,this.updateCopyText()},onResetPasswordBtnClick(){this.isLoadingResetPwd=!0,Ir(this.project.id).then(({data:e})=>{this.project.secret_key=e,this.updateLinkAndPassword(null,e)}).finally(()=>{this.isLoadingResetPwd=!1})},updateCopyText(){var e=[this.project.name?`\u300A${this.project.name}\u300B`:"",`\u94FE\u63A5\uFF1A${this.shareUrl}`];this.project.visibility!==1&&e.push(`\u5BC6\u7801\uFF1A${this.password}`),this.$nextTick(()=>{this.copyTextEl.value=e.join(`
`)})}}},fi={key:0,class:"-m-4"},mi={key:1,class:"-m-4"},_i=a("div",{class:"flex-1"},[a("h4",null,"\u5F00\u542F\u5206\u4EAB"),a("div",{class:"ivu-list-item-meta-description"},"\u5F00\u542F\u5206\u4EAB\u540E\uFF0C\u83B7\u5F97\u94FE\u63A5\u7684\u4EBA\u53EF\u4EE5\u8BBF\u95EE\u9879\u76EE\u5185\u5BB9\u3002")],-1),gi=K("\u91CD\u7F6E\u5BC6\u7801"),vi={ref:"copyTextEl",style:{position:"fixed",left:"-9999px"}};function yi(e,t,o,s,n,r){const i=nt,c=rt,l=Dt,_=St,C=ro,u=jt,h=Be;return p(),G(h,{modelValue:e.isShow,"onUpdate:modelValue":t[4]||(t[4]=g=>e.isShow=g),width:540,"close-on-click-modal":!1,title:"\u5206\u4EAB\u9879\u76EE","append-to-body":""},{default:m(()=>[e.project&&e.project.visibility===1?(p(),y("div",fi,[d(_,{"label-position":"top",class:"px-6 py-3"},{default:m(()=>[d(l,{label:""},{default:m(()=>[d(c,{readonly:"",modelValue:e.shareUrl,"onUpdate:modelValue":t[0]||(t[0]=g=>e.shareUrl=g)},{append:m(()=>[d(i,{type:"primary",onClick:r.copy},{default:m(()=>[K(F(e.copyText),1)]),_:1},8,["onClick"])]),_:1},8,["modelValue"])]),_:1})]),_:1})])):T("",!0),e.project&&e.project.visibility===0?(p(),y("div",mi,[a("div",{class:$(["px-6 flex items-center",{"py-3":!e.isShare,"pt-3":e.isShare}])},[_i,d(C,{loading:e.isLoading,modelValue:e.isShare,"onUpdate:modelValue":t[1]||(t[1]=g=>e.isShare=g),onChange:r.onShareStatusSwitch,"inline-prompt":"","active-text":"\u5F00","inactive-text":"\u5173"},null,8,["loading","modelValue","onChange"])],2),e.isShare?(p(),G(u,{key:0})):T("",!0),e.isShare?(p(),G(_,{key:1,"label-position":"top",class:"px-6"},{default:m(()=>[d(l,{label:"\u9879\u76EE\u94FE\u63A5"},{default:m(()=>[d(c,{readonly:"",modelValue:e.shareUrl,"onUpdate:modelValue":t[2]||(t[2]=g=>e.shareUrl=g)},{append:m(()=>[d(i,{type:"primary",onClick:r.copy},{default:m(()=>[K(F(e.copyText),1)]),_:1},8,["onClick"])]),_:1},8,["modelValue"])]),_:1}),d(l,{label:"\u5BC6\u7801"},{default:m(()=>[d(l,{prop:"date",class:"mr-1"},{default:m(()=>[d(c,{readonly:"",modelValue:e.password,"onUpdate:modelValue":t[3]||(t[3]=g=>e.password=g)},null,8,["modelValue"])]),_:1}),d(i,{loading:e.isLoadingResetPwd,onClick:r.onResetPasswordBtnClick},{default:m(()=>[gi]),_:1},8,["loading","onClick"])]),_:1})]),_:1})):T("",!0)])):T("",!0),a("textarea",vi,null,512)]),_:1},8,["modelValue"])}var Ai=H(pi,[["render",yi]]);const Mt=Pe({id:"project",state:()=>({projectInfo:null}),getters:{isManager:e=>e.projectInfo&&e.projectInfo.authority===ne.MANAGER,isDeveloper:e=>e.projectInfo&&e.projectInfo.authority===ne.DEVELOPER,isReader:e=>e.projectInfo&&e.projectInfo.authority===ne.READER},actions:{async getProjectDetail(e){const{data:t}=await Rr(e);return this.projectInfo=t||null,this.projectInfo},async updateProjectInfo(e){const t=await Nr(e);return this.projectInfo=B(B({},this.projectInfo),e),t},clearProjectInfo(){this.projectInfo=null}}});const Ci=Q({setup(e){return(t,o)=>{const s=xe,n=vs;return p(),G(n,Ho(t.$attrs,{class:"ac-backtop"}),{default:m(()=>[d(s,null,{default:m(()=>[d(D(ys))]),_:1})]),_:1},16)}}});var Ei=H(Ci,[["__scopeId","data-v-de5b7756"]]);const ed=e=>A.post("/preview/single_check",e),ki=(e,t)=>A.get("/preview/single_doc",{params:{doc_id:t,token:e}}),td=(e,t)=>A.get("/api_doc",{params:{project_id:e,doc_id:t,deleted:1,format:"html"}}),wi=e=>A.get("/preview/project",{params:{project_id:e}}),od=(e,t)=>A.get("/preview/api_nodes",{params:{project_id:t,token:e}}),sd=e=>A.post("/preview/check",e),nd=(e,t,o)=>A.get("/preview/api_doc",{params:{project_id:t,node_id:o,token:e}}),Ni=(e,t,o)=>A.get("/preview/search",{params:{project_id:t,keywords:o,token:e}});var ko="/assets/icon-no-result.4a7ec4ce.png";const bi={name:"ProjectSearch",data(){return{data:[],isLoading:!1,isNoData:!1,isShowSearchResult:!1,form:{token:j.get(j.KEYS.SECRET_PROJECT_TOKEN+this.$route.params.project_id||"",!0),project_id:this.$route.params.project_id,keywords:""}}},methods:{onClickSearchResult(e){let t=!1;fe(o=>{if(o.id===(e.node_id||e.doc_id))return t=!0,!1},[]),t?this.$router.push(e.link):location.href=e.href},onStop(e){e.stopPropagation()},onSearchDocument:Nt(function(){!Jo(Qt(this.form.keywords))&&this.form.keywords.length>=2&&(this.isLoading=!0,this.data=[],this.isShowSearchResult=!0,Ni(this.form.token,this.form.project_id,this.form.keywords).then(e=>{this.data=(e.data||[]).map(t=>(t.link={name:"preview.project.document",params:{project_id:this.form.project_id,node_id:t.node_id||t.doc_id}},t.href=`/app/${this.form.project_id}/${t.node_id||t.doc_id}`,t)),this.isNoData=!this.data.length}).finally(()=>{this.isLoading=!1}))},300)},created(){document.body.addEventListener("click",e=>{this.data=[],this.form.keywords="",this.isShowSearchResult=!1})}},Ii={class:"search-popper-input"},Di=a("i",{class:"icon iconfont iconsousuo"},null,-1),Si={style:{padding:"10px","text-align":"center"}},Pi={key:0},xi=["onClick","title"],ji={key:1,class:"result p-2"},Ri=a("div",{class:"result-icon"},[a("img",{src:ko,alt:""})],-1),Li=a("span",null,"\u672A\u627E\u5230\u641C\u7D22\u7ED3\u679C\uFF01",-1),Ti=[Ri,Li];function Oi(e,t,o,s,n,r){return p(),y("div",{class:"search-popper",onClick:t[3]||(t[3]=(...i)=>r.onStop&&r.onStop(...i))},[a("div",Ii,[W(a("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=i=>n.form.keywords=i),placeholder:"\u641C\u7D22",maxlength:"255",onKeyup:t[1]||(t[1]=eo((...i)=>r.onSearchDocument&&r.onSearchDocument(...i),["enter"]))},null,544),[[Xt,n.form.keywords]]),Di]),W(a("div",{class:"search-popper-result scroll-content",onClick:t[2]||(t[2]=(...i)=>r.onStop&&r.onStop(...i))},[W(a("div",Si,"\u641C\u7D22\u4E2D...",512),[[oe,n.isLoading]]),n.data.length?(p(),y("ul",Pi,[(p(!0),y(U,null,X(n.data,i=>(p(),y("li",{key:i.node_id},[a("a",{href:"javascript:void(0);",onClick:c=>r.onClickSearchResult(i),title:i.title},F(i.title),9,xi)]))),128))])):T("",!0),n.isNoData?(p(),y("div",ji,Ti)):T("",!0)],512),[[oe,n.isShowSearchResult]])])}var Mi=H(bi,[["render",Oi]]);const $i={name:"PreviewHeader",props:{isShowSearch:{type:Boolean,default:!0}},components:{ProjectSearch:Mi}},Bi={class:"header header-fixed"},Fi=Wo('<a class="logo" href="/"><img src="'+Fe+'" alt="ApiCat"><span class="logo"><span class="logo-text logo-apicat">ApiCat</span></span></a><ul class="header-nav"></ul>',2);function Ki(e,t,o,s,n,r){const i=Z("project-search");return p(),y("header",Bi,[Fi,o.isShowSearch?(p(),G(i,{key:0})):T("",!0)])}var Vi=H($i,[["render",Ki]]);const $t=Q({setup(e){const t=I(!0),o=I(!0),s=r=>{t.value=r},n=r=>{o.value=r};return le("showSearchInput",s),le("showHeader",n),(r,i)=>{const c=Z("router-view"),l=Ei;return p(),y(U,null,[o.value?(p(),G(Vi,{key:0,"is-show-search":t.value},null,8,["is-show-search"])):T("",!0),d(c),d(l,{bottom:100,right:100})],64)}}}),Ui=()=>Y(()=>import("./ProjectPreview.a8b0d9b7.js"),["assets/ProjectPreview.a8b0d9b7.js","assets/element-plus.33434d3d.js","assets/element-plus.07fbf481.css","assets/vendor.1b70e788.js","assets/AcEditorDocument.b2ca191d.js","assets/useHighlight.f09c3d66.js"]),Gi=()=>Y(()=>import("./ProjectVerification.c48b0946.js"),["assets/ProjectVerification.c48b0946.js","assets/element-plus.33434d3d.js","assets/element-plus.07fbf481.css","assets/vendor.1b70e788.js","assets/img_join.8db8ddd5.js"]),Yi=()=>Y(()=>import("./DocumentPreview.08aecbc4.js"),["assets/DocumentPreview.08aecbc4.js","assets/AcEditorDocument.b2ca191d.js","assets/vendor.1b70e788.js","assets/useHighlight.f09c3d66.js","assets/element-plus.33434d3d.js","assets/element-plus.07fbf481.css"]),zi=()=>Y(()=>import("./DocumentVerification.8e274b17.js"),["assets/DocumentVerification.8e274b17.js","assets/element-plus.33434d3d.js","assets/element-plus.07fbf481.css","assets/vendor.1b70e788.js","assets/img_join.8db8ddd5.js"]),Hi=()=>Y(()=>import("./TrashDocumentPreview.90b5b397.js"),["assets/TrashDocumentPreview.90b5b397.js","assets/element-plus.33434d3d.js","assets/element-plus.07fbf481.css","assets/vendor.1b70e788.js","assets/AcEditorDocument.b2ca191d.js","assets/useHighlight.f09c3d66.js"]),Ji=bt("/app/:project_id"),rd=bt("/doc/:project_id/trash_api_preview/:doc_id"),Wi={path:"/doc",name:Me,component:$t,meta:{ignoreAuth:!0},children:[{path:"/doc/:doc_id/verification",name:Qe,component:zi,meta:{ignoreAuth:!0}},{path:"/doc/:doc_id",name:`${Me}.detail`,component:Yi,meta:{ignoreAuth:!0}}]},Zi={path:"/app",name:Oe,component:$t,meta:{ignoreAuth:!0},children:[{path:"/app/:project_id/verification",name:qe,component:Gi,meta:{ignoreAuth:!0}},{path:"/app/:project_id/:node_id?",name:`${Oe}.document`,component:Ui,meta:{ignoreAuth:!0}}]},qi={path:"/doc/:project_id/trash_api_preview/:doc_id",name:"preview.trash",component:$t,children:[{path:"",name:"preview.trash.document",component:Hi}]};var wo="/assets/logo-apicat@2x.ca5d403d.png",Qi="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAJiElEQVR4Xu2de4xU5RnGn+/Msgu7zMzusgGJlUiCCZcELbFJi7GJtrShtgs21RJMi4tim0aqmF5iayMtsTQkbbdYtNTSKtYorpWGmOItqESwaKDEFhURpFsKre7szsyZ3dlhZ87bnDNd3MvMzvnO9ZvZ9/zH8j7v937P8+NcdoYZARcHEcWSur4OhBUA5gNoIyLhomXVSJ996eDjq69fvrpqBi4zqOOwkkn9RhL0ABHNqHYTnMz/SNczmNXWWvUQOAKgL5W6gwidToyrFY0JgHlUOwTSAPTp+jUw6EUi0molTCf7GAag2iGQAsC8vidT+lECLXZiWi1pRgJQzRBIAZBOp5fmDTpQS0E63ctYAKoVAikA+lKpjUS416lptaQrBUA1QiAHQDK9g0BraylIp3spB0C1QSALwJMEusGpabWkmwiAaoKAAXBIZSUAqgUCBsBHAKoBAgbAZwBUh4ABCAAAlSFgAAICQFUIGIAAAVARAgYgYABUg4ABCAEAlSBgAEICQBUIGIAQAVABAgYgZADChoABUACAMCFgABQBICwIGACFAAgDAgZAMQCChoABcAjAY7ufRT6fd6iuLAvq3cYMQOUsSlb8+blXkErrDtX2ZEFAwADYy2Jc1etHj+HtE+87VNuX+Q0BA2A/i1GVybSOPc/vBxE57GBf5icEDID9HMZVHjryd7xz8p8uOtiX+gUBA2A/g3GVhmHghf2H8J8PEy662Jf6AQEDYN//kpUmBG8cPYbjp7qr8nLAALgEYFhu3hO8e6obZ//bg/6BbNU8IjIAHgEwtk2mP4v+7KBP3YEF8y6Vyq7cIFJN+pJp/o8hEpH6CQEDIBFEmKV+QcAAhJmq5Np+QMAASIYQdrnXEDAAYSfqYH0vIWAAHASggsQrCBgAFdJ0OIMXEDAADs1XReYWAgZAlSRdzOEGAgbAhfEqSZ1CwAColKLLWZxAwAC4NF01uSwEDIBqCXowjwwEDIAHhqvYwi4EDICK6Xk0kx0IGACPzFa1TSUIGABVk/NwrokgYAA8NFrlVuUgYABUTs3j2UpBwAB4bLLq7cZCwAConpgP842EgAHwweBqaDkMAQNQDWn5NKMJwZyLL5J6R3e5UaSa8NvCfUrUQdvW5rhUdgyAA5NVljAAKqcTwGwMQAAmq7wEA6ByOgHMxgAEYLLKSzAAKqcTwGwMQAAmq7yE5wAkOlZ83iD6IYiWAGhSefNVOVusGWLeQogVqyCaW11vwVMAejra15BBD7ueihtUdqBxOrTv/9Q1BJ4BQLfd1pjInTtHQKzy9FzhhQNiyVJoa77lqpVnAPSuab+qAHrV1TQslnMg1ozIpl/LacZUewZA4ub2GwyiJ11Nw2JpByK/+qO0ZqSAAXBlX/hiBiD8DEKdgAEI1f7wF2cAws8g1AkYgFDtD39xBiD8DEKdgAEI1f7wF2cAws8g1AkYgFDtD3/xmgWg/spPYerVy0o6TNkBFBIfoHD2DHKH9gNjvnUruv5uiLopo7VEKPQlUDh3BoWz/0L+vXdAg9mS/UvqS1Tmz5zGQNfOUCmoWQCmLb8eTV/tqGhuobcHmR1bMXTs6IXaGdu7IBoaJtRauoe3YejNw+Pq7OhN0dDxfyC1+QcVZ/SzYFIAMLB3N8x/9dYhAK1xOiJz5qJ+wWLrR0ZGR/Ke9TCSvdafhwPMnz6J3JG/FmX19Yi0zYQ2czbq5l4GIYpvhzd7D+z6w6iMSulLhWj0fIDcwZf8zLdi70kBQO9da2H09owzo+GqaxFdd6f18/6nHkX2ma5RAAzufwGZ398/TmcC0PT1b2LK3Musr2dJ/eQ7yL9/YtwZpJy+YioBFkxqAEyfWx98Atq0Rgy+9goy239uCwDrjBCNo2XLdks7dOpdC4LhY/gMwADYJ1l4/XLwyHuAcmcANEzFjK07IRqmInf4Nej3b7YNgFnYuHI1GleusjSJ228CZYrf4MkA2A9+uDIUABqu/iyit3y7eC3fswsDTz8mFWD9FZ9A7M4fWZrkpu8if/L4KH3ujYPof6r8Xb7RlwDO5+Td8lAxKS4B6a33wUinLtgmmqKou+RSTFv2RWjxFlChgJQZ4On3pACIXDwHLfcV31Gj//aXF27o7D4FpH7x45JPER7mW7HVpABgIhfMm7iBrkeQ/cvT0tdw84mgdct2S2c+Eg6+/NwogCq5zwB85JCvlwDKDwEjvlqXsv0o9HyIwtluZPfuRuHf3aOysnsNn7LwcsS/t8nSprbcg6G33hx9BjmwD5mdvynPwfnzABmVOPH17yfFGaDsTWAZa+0CMPUz12H6175hdRm5hl29r8nabM4AlDDKVoCROrRs3obIzNnWL5B6N3QA//8Gb1t6mwH5XcYAOAGgvh5Nq9Zi2rVfKN4APtSJ3IF90vcQfodrpz8DMAEA5q+Bs3t2FSummL8KnoXIrNlo+PQyRFrbrB8PnTxuPUGMPPgMYAe90TW+3gQ6vQeYaBvm08Pgvr3WE8TYVwUZgBoFwHwF0Hwp2HxJOPf6q8ifeLvkThkABQCQH2FyKmr2HmByxim/awZA3rOaUjAANRWn/GYYAHnPakrBANRUnPKbYQDkPaspBQNQU3HKb0YZAHpubv8yEf1JfguscOyAEIh0PupYbgq9+4SQjhULDcM45moaFks5IC76GLS7fyalGVvsGQC0caPWc/rIYRBd4WoiFtt2QLvuKxCfW2m7vlShZwCYzRPrvrSIhsReIrrE1VQsruzAoo8jcusGQNMq105Q4SkAFgTrb4qRnl4DaEsAKvlJoWLe/E/S9BhD4iQ665NCF0AsvtKJepzGcwDsTMVfGWPHpWBqGIBgfFZ2FQZA2WiCGYwBCMZnZVdhAJSNJpjBGIBgfFZ2FQZA2WiCGYwBCMZnZVdhAJSNJpjBGIBgfFZ2FQZA2WiCGYwBCMZnZVdhAJSNJpjBwgJgB4HWBrNFXmUCBzKtzfGoFw4VP3XR5tGX0u8lMjbaLOcyvxwQ4q3WeGyRF+2lAEin00vzBh3wYmHu4dwBIbTOlnh0g/MOHymlACAiLZnS/0ag4me98hG4A0IIo04Ti6PRqCfv45QCwNxtn65fA4NeNGEIfPe8IITAtpZ4/HavrJAGwIIglbqDCJ1eDcF97DkgIPY1x6PLhRDn7SkqVzkCwGybTOo3kqAHiGhG5WW4wo0D5mkfoAebY7G7vAzfnMkxAKa4lyiu6fo6IrQDmA+gjYhc9XRjVI1pMxCiW0A8X6fhd15d88d69D+MM3rbPGNofwAAAABJRU5ErkJggg==",No="/assets/logo-postman@2x.3bda39f9.png";const dt=(e={})=>A.post("/api_doc/export",e),ut=(e,t)=>A.get("/api_doc/export_result",{params:{project_id:e,job_id:t}}),bo=[{text:"ApiCat",icon:wo,type:"apicat",action:dt,getJobResult:ut},{text:"PDF",icon:Qi,type:"pdf",action:dt,getJobResult:ut},{text:"Postman(v2.1)",icon:No,type:"postman",action:dt,getJobResult:ut}],Xi=bo;const ea={props:{status:{type:String,default:()=>"success",validate(e){return["success","error"].indexOf(e)!==-1}},title:{type:String,default:()=>""},subTitle:{type:String,default:()=>""},styles:{type:Object,default:()=>({})}}},ta={class:"result"},oa={class:"result-title"},sa={class:"mt-1 result-subtitle"};function na(e,t,o,s,n,r){return p(),y("div",ta,[a("div",{class:"result-icon",style:to(o.styles)},[Je(e.$slots,"icon",{},void 0,!0)],4),Je(e.$slots,"title",{},()=>[a("p",oa,F(o.title),1)],!0),a("p",sa,[Je(e.$slots,"subTitle",{},()=>[K(F(o.subTitle),1)],!0)])])}var ra=H(ea,[["render",na],["__scopeId","data-v-a27469de"]]),ia="/assets/logo-markdown@2x.084fed6d.png";const id=e=>A.get("/api_url/list",{params:{project_id:e}}),ad=(e,t)=>A.post("/api_url/remove",{project_id:e,url_id:t}),cd=(e,t,o="json")=>A.get("/api_doc",{params:{project_id:e,doc_id:t,format:o}}),aa=(e,t)=>A.get("/api_doc/search",{params:{project_id:e,keywords:t}}),ca=(e={})=>A.post("/api_doc/create",B({},e)),la=(e={})=>A.post("/api_doc/http_template",B({},e)),ld=(e={})=>(typeof e.content=="object"&&(e.content=JSON.stringify(e.content)),A.post("/api_doc/update",e)),da=(e={})=>A.post("/api_doc/copy",e),ua=(e={})=>A.post("/api_doc/rename",e),ha=(e={})=>A.post("/api_doc/remove",e),pa=(e={})=>A.post("/api_doc/share",B({},e)),fa=(e={})=>A.post("/api_doc/share_detail",B({},e)),ma=(e={})=>A.post("/api_doc/share_secretkey",B({},e)),ht=e=>A.post("/api_doc/import",e),pt=(e,t)=>A.get("/api_doc/import_result",{params:{project_id:e,job_id:t}}),_a=[{text:"ApiCat",icon:wo,type:"apicat",action:ht,getJobResult:pt,maxSize:2,accept:".json"},{text:"Markdown",icon:ia,type:"markdown",action:ht,getJobResult:pt,maxSize:.5,accept:".md"},{text:"Postman(v2.1)",icon:No,type:"postman",action:ht,getJobResult:pt,maxSize:2,accept:".json"}],ga=(e={})=>A.post("/dir/create",e),va=(e={})=>A.post("/dir/remove",e),ya=(e={})=>A.post("/dir/rename",e),Aa=(e={})=>A.post("/api_tree/sort",e),Ca=e=>A.get("/api_tree",{params:{project_id:e}}),dd=e=>A.get("/dir/list",{params:{project_id:e}}),Ye=(e={},t=ye.DOC)=>_e(B({},e),{type:e.type===void 0?t:e.type,isEditable:!1,isCurrent:!1,isLeaf:(e.type===void 0?t:e.type)===ye.DOC}),Io=Pe({id:"document",state:()=>({apiDocTree:[]}),getters:{},actions:{async getApiDocTree(e){if(!e)return[];try{const{data:t}=await Ca(e);this.apiDocTree=fe(o=>(o.isLeaf=o.type===ye.DOC,o.isEditable=!1,o.isCurrent=!1,o),t||[],{subKey:"sub_nodes"})}catch{}return this.apiDocTree}}});const Do=e=>(et("data-v-7f635b5e"),e=e(),tt(),e),Ea={class:"search-result scroll-content text-left"},ka=["onClick"],wa={class:"truncate px-2 hover:bg-gray-100"},Na=Do(()=>a("img",{src:ko},null,-1)),ba=Do(()=>a("span",null,"\u672A\u627E\u5230\u641C\u7D22\u7ED3\u679C\uFF01",-1)),Ia=Q({setup(e,{expose:t}){const{params:o}=oo(),{push:s}=$e(),{apiDocTree:n}=ke(Io()),r=I(!1),i=I(!1),c=I(!1),l=I(""),_=I([]),C=I(),u=I(),h=I(),g=I();Wt(C,()=>{r.value=!1,w()},{ignore:[g]});const f=Nt(()=>{const P=D(l);P.length<2||(i.value=!0,c.value=!0,aa(o.project_id,P).then(R=>{_.value=R.data||[]}).catch(R=>{}).finally(()=>{c.value=!1}))},200),w=()=>{_.value=[],l.value="",i.value=!1},v=P=>{let R=null;fe(L=>{if(L.id===parseInt(P.node_id,10))return R=L,!1},n.value||[],{subKey:"sub_nodes"});const O=pl({project_id:o.project_id,node_id:P.node_id});R?s({path:O}):location.href=O};return t({show:P=>{g.value=P,r.value=!0,h.value.focus()}}),(P,R)=>{const O=rt,L=ra,ae=xt,z=it;return p(),G(ae,{visible:r.value,"onUpdate:visible":R[1]||(R[1]=q=>r.value=q),ref_key:"popoverRef",ref:u,placement:"bottom-end","virtual-ref":g.value,"virtual-triggering":"",width:"auto"},{default:m(()=>[a("div",{ref_key:"searchDomRef",ref:C,class:"search-poptip"},[d(O,{ref_key:"searchInput",ref:h,"suffix-icon":D(io),placeholder:"\u5173\u952E\u5B57 \u56DE\u8F66\u641C\u7D22",modelValue:l.value,"onUpdate:modelValue":R[0]||(R[0]=q=>l.value=q),onChange:D(f),clearable:""},null,8,["suffix-icon","modelValue","onChange"]),W((p(),y("div",Ea,[(p(!0),y(U,null,X(_.value,(q,b)=>(p(),y("span",{class:"cursor-pointer",key:q.doc_id+"_"+b,onClick:M=>v(q)},[a("h4",wa,F(q.title),1)],8,ka))),128)),W(d(L,null,{icon:m(()=>[Na]),title:m(()=>[ba]),_:1},512),[[oe,i.value&&!c.value&&!_.value.length]])])),[[oe,i.value],[z,c.value]])],512)]),_:1},8,["visible","virtual-ref"])}}});var Da=H(Ia,[["__scopeId","data-v-7f635b5e"]]);const Sa={class:"ac-doc-header"},Pa={class:"ac-doc-header-inner"},xa={class:"w-full relative text-center"},ja=K(" \u8FD4\u56DE "),Ra={class:"h-14 text-base font-medium"},La={class:"flex items-center justify-center h-full max-w-sm m-auto cursor-pointer hover:text-zinc-600"},Ta={class:"truncate"},Oa=["onClick"],Ma={class:"absolute right-0 top-0 h-full flex items-center text-zinc-500"},$a=K("\u641C\u7D22 "),Ba=K("\u9884\u89C8\u9879\u76EE "),Fa=K("\u5206\u4EAB "),Ka=Q({setup(e){const{push:t,currentRoute:o}=$e(),s=Mt(),{projectInfo:n,isManager:r}=ke(s),i=I(),c=I(),l=me("projectExportModal"),_=Ji({project_id:o.value.params.project_id}),C=v=>{if(v.href){t(v.href.replace("{project_id}",o.value.params.project_id));return}},u=v=>{var S;(S=c.value)==null||S.show(v.currentTarget)},h=()=>{var v;(v=l.value)==null||v.show({project_id:n.value.id},bo)},g=()=>{var v;(v=i.value)==null||v.show(n.value)},f=[{text:"\u516C\u5171\u53C2\u6570",icon:"iconIconPopoverConfig",href:"/project/{project_id}/params"},{text:"\u9879\u76EE\u8BBE\u7F6E",icon:"iconIconPopoverSetting",href:"/project/{project_id}/setting"},{text:"\u9879\u76EE\u6210\u5458",icon:"iconIconPopoverUser",href:"/project/{project_id}/members"},{text:"\u5BFC\u51FA\u9879\u76EE",icon:"iconIconPopoverUpload",onClick:v=>h(),divided:!0},{text:"\u56DE\u6536\u7AD9",icon:"icontrash",href:"/project/{project_id}/trash"}],w=I(f);return ie(n,()=>{n.value&&!r.value&&(w.value=f.filter(v=>v.icon!=="iconIconPopoverSetting"))},{immediate:!0}),(v,S)=>{const P=xe,R=Z("router-link"),O=xt,L=jt,ae=Ai;return p(),y(U,null,[a("header",Sa,[a("div",Pa,[a("div",xa,[d(R,{class:"absolute left-0 top-0 h-full flex items-center text-zinc-500",to:{name:"projects"}},{default:m(()=>[d(P,{class:"mr-1"},{default:m(()=>[d(D(As))]),_:1}),ja]),_:1}),a("div",Ra,[d(O,{placement:"bottom",trigger:"click","popper-class":"ac-popper-menu ac-popper-menu--small",width:"auto"},{reference:m(()=>{var z;return[a("div",La,[a("p",Ta,F((z=D(n))==null?void 0:z.name),1),W(d(P,{size:12,class:"ml-1"},{default:m(()=>[d(D(Cs))]),_:1},512),[[oe,D(n)]])])]}),default:m(()=>[a("ul",null,[(p(!0),y(U,null,X(w.value,z=>(p(),y("li",{key:z.icon,class:$(["ac-popper-menu__item",{"border-t":z.divided}]),onClick:q=>z.onClick?z.onClick(z):C(z)},[a("i",{class:$(["icon iconfont mr-1",z.icon])},null,2),K(F(z.text),1)],10,Oa))),128))])]),_:1})]),a("div",Ma,[a("a",{class:"flex items-center h-full",href:"javascript:void(0)",onClick:u},[d(P,{class:"mr-2"},{default:m(()=>[d(D(io))]),_:1}),$a]),d(L,{class:"mx-5",direction:"vertical"}),d(R,{class:"flex items-center",to:{path:D(_)},target:"_blank"},{default:m(()=>[d(P,{class:"mr-2"},{default:m(()=>[d(D(Es))]),_:1}),Ba]),_:1},8,["to"]),d(L,{class:"mx-5",direction:"vertical"}),a("a",{class:"flex items-center",href:"javascript:void(0)",onClick:g},[d(P,{class:"mr-2"},{default:m(()=>[d(D(ks))]),_:1}),Fa])])])])]),d(ae,{ref_key:"projectShareModal",ref:i},null,512),d(Da,{ref_key:"searchDocumentPopoverRef",ref:c},null,512)],64)}}}),Va={emits:["on-menu-item-click"],name:"NewMenus",props:{node:{type:Object,default:()=>({})}},setup(){return{menus:Po}},methods:{onPopperItemClick(e){Ot(this,"on-menu-item-click",e)}}},Ua={class:"ac-popper-menu"},Ga=["onClick"],Ya=["src"];function za(e,t,o,s,n,r){return p(),y("ul",Ua,[(p(!0),y(U,null,X(s.menus,i=>(p(),y(U,{key:i.value},[o.node.level<5||o.node.level===5&&i.value!=="newCatetory"?(p(),y("li",{key:0,class:$(["ac-popper-menu__item",{"border-t":i.divided}]),onClick:te(c=>r.onPopperItemClick(i),["stop"])},[i.icon?(p(),y("span",{key:0,class:$(["icon iconfont ac-popper-menu__icon",i.icon])},null,2)):T("",!0),i.img?(p(),y("img",{key:1,class:"ac-popper-menu__icon",src:i.img,alt:""},null,8,Ya)):T("",!0),K(F(i.text),1)],10,Ga)):T("",!0)],64))),128))])}var Ha=H(Va,[["render",za]]);const Ja={name:"DirOperateMenus",data(){return{menus:ac}},methods:{onPopperItemClick(e){Ot(this,"on-menu-item-click",e)}}},Wa={class:"ac-popper-menu ac-popper-menu--thin"},Za=["onClick"];function qa(e,t,o,s,n,r){return p(),y("ul",Wa,[(p(!0),y(U,null,X(n.menus,i=>(p(),y("li",{class:$(["ac-popper-menu__item",{"border-t":i.divided}]),key:i.value,onClick:te(c=>r.onPopperItemClick(i),["stop"])},F(i.text),11,Za))),128))])}var Qa=H(Ja,[["render",qa]]);const Xa={emits:["on-menu-item-click"],name:"DocOperateMenus",props:{node:{type:Object,default:()=>({})},source:{type:Object,default:()=>({})},isDetailPage:{type:Boolean,default:!1}},data(){return{menus:Ct}},methods:{onPopperItemClick(e){Ot(this,"on-menu-item-click",e)}}},ec={class:"ac-popper-menu ac-popper-menu--thin"},tc=["onClick"],oc=["onClick"],sc=["onClick"];function nc(e,t,o,s,n,r){return p(),y("ul",ec,[(p(!0),y(U,null,X(n.menus,i=>(p(),y(U,null,[(i.value==="delete"||i.value==="export"||i.value==="share"||i.value==="copy")&&o.isDetailPage&&o.source.isCurrent?(p(),y("li",{class:$(["ac-popper-menu__item",{"border-t":i.divided}]),key:i.value,onClick:te(c=>r.onPopperItemClick(i),["stop"])},F(i.text),11,tc)):T("",!0),i.value==="delete"&&!o.isDetailPage&&o.source.isCurrent?(p(),y("li",{class:$(["ac-popper-menu__item",{"border-t":i.divided}]),key:i.value,onClick:te(c=>r.onPopperItemClick(i),["stop"])},F(i.text),11,oc)):T("",!0),o.source.isCurrent?T("",!0):(p(),y("li",{class:$(["ac-popper-menu__item",{"border-t":i.divided}]),key:i.value,onClick:te(c=>r.onPopperItemClick(i),["stop"])},F(i.text),11,sc))],64))),256))])}var rc=H(Xa,[["render",nc]]),So="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAUGVYSWZNTQAqAAAACAACARIAAwAAAAEAAQAAh2kABAAAAAEAAAAmAAAAAAADoAEAAwAAAAEAAQAAoAIABAAAAAEAAAAgoAMABAAAAAEAAAAgAAAAAL5bTO0AAAIwaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA1LjQuMCI+CiAgIDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+CiAgICAgIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICAgICAgICAgIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIgogICAgICAgICAgICB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyI+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgICAgIDxleGlmOkNvbG9yU3BhY2U+MTwvZXhpZjpDb2xvclNwYWNlPgogICAgICAgICA8ZXhpZjpQaXhlbFhEaW1lbnNpb24+MzI8L2V4aWY6UGl4ZWxYRGltZW5zaW9uPgogICAgICAgICA8ZXhpZjpQaXhlbFlEaW1lbnNpb24+MzI8L2V4aWY6UGl4ZWxZRGltZW5zaW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4K9GTeTwAAAW9JREFUWAntVLtKQ0EQvWsUi0AKtRFESaWlP2Nl/AMLK62sbExhlz+I8XusxE6sfRRBCxuv50guXJKZfS8IZuBw787ZmTk7+6iq/25GacA5/IcKZ3O/gxwBj7ZJbW6lPWj9xxRn+AZwARxw4GNaB+5mwWN8nx2J9sEfAVz9N7AFfAFDwNmJVUyyGYs/2CaA6874D3xvgEuAItgJpwhtCxAbZS+IugJegXXAuR25BaBmFSSihIAgEaUESCJO6Zw31yGcn28bb4O8FiY0i+QVXbAcAp6QlddvDdhdqOBw5BDAE38G9JVaO/DznRAthwAmpghCsk/J2fia/WnGoV++pEk5UjtQQwARbb7qO9EVHIG+ApJWadPgK4DXrIj5CihSnEmXApYdCOpAXdfm9vitp51Icpyj8ZI/6CU0xvA9mEqJ6BtMNqeDicbK/qAOyCnSvK4O7KWl/4225nAJOMkgwJpC24J7a1QcWSJnnJI/FfUDsbg5OtwYRrcAAAAASUVORK5CYII=",ic="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABZUlEQVRYR+3XMUvEMBTA8X9uvkHE2wQRBMHJQScdHO4rCCL4DTp4izgoOLh4KBxSP4HgZ3AQXHRzcBJXXVxEHE8FI4EuXtt7LyGhg3ZsXvJ+eU3T1NDwZRrOTx1gB1gMwL0BOfCo7VsHuNAOUBH3ARxpERLgHHgSMPPAOuBm/w1MAWqEBDgEHgTAMtADnoETYN8HERuwC3R8ECkArmBqRCqAGpESMIpwizQbXU8xAV/AS8WCbQOTxf3NFAD32g2AlmLvSAJweR1itgYwXewTrjkZYNzkF4C9lI9AqnwEQGaXsFxJmX61G7rk5g6IAljBcuMJWCU3t3EALvO2nfACDMx7ER+hAl6ZS8ERAD07xyfHpaENQ3KzIfgiADK7huW6MtGZkY51EQAHts0r3RKgxZBTc5m+Ao2vgX/AX66A5lgu1WcG2Ar9GkqD+7arzwOhv2bjQPdAX3sk851ZcLy0jQYPrO34A6sFhSHFThBJAAAAAElFTkSuQmCC";const Po=[{text:"\u65B0\u5EFA\u6587\u6863",value:"createDoc",img:So,onClick:"createDoc"},{text:"\u65B0\u5EFA HTTP API \u6587\u6863",value:"createHttpDoc",img:ic,onClick:"createHttpDoc"},{text:"\u5BFC\u5165\u6587\u4EF6",value:"importFile",icon:"iconimport",onClick:"onImportBtnClick",divided:!0},{text:"\u65B0\u5EFA\u5206\u7C7B",value:"newCatetory",type:"newCatetory",icon:"iconIconPopoverTree",onClick:"onCreateDirBtnClick",divided:!0}],Ct=[{text:"\u590D\u5236",value:"copy",onClick:"onCopyBtnClick"},{text:"\u91CD\u547D\u540D",value:"rename",onClick:"onRenameBtnClick"},{text:"\u5206\u4EAB",value:"share",onClick:"onShareBtnClick"},{text:"\u5BFC\u51FA",value:"export",onClick:"onExportBtnClick"},{text:"\u5220\u9664",value:"delete",onClick:"onDeleteBtnClick"}],ac=[Ct[1],Ct[4]],cc="DIR_NEW_TYPE",lc="DIR_OPERATE_TYPE",dc="DOC_OPERATE_TYPE";function ft(e,t){const o=document.createElement("div"),s=gt(e);return Zo(s,o),Object.keys(t).forEach(n=>{s.component.props[n]=t[n]}),s}var uc={[cc]:{render(e){return ft(Ha,e)}},[lc]:{render(e){return ft(Qa,e)}},[dc]:{render(e){return ft(rc,e)}}},mt={onPopperItemClick:Le,onPopperHide:Le,popper:qo(document.body,{appendTo:()=>document.body,trigger:"manual",placement:"bottom",interactive:!0,theme:"light"}),show(e,t,o){const s=uc[e];!s||(this.$vm=s.render(o),Hs(this.$vm.component.proxy,"on-menu-item-click",n=>{this.onPopperItemClick(B({menu:n},o)),this.hide()}),this.popper.setProps({getReferenceClientRect:()=>t.getBoundingClientRect(),content:this.$vm.el,onHide:()=>{this.onPopperHide()}}),this.popper.show())},hide(){this.popper.hide()}};const hc={props:{shareData:{type:Object,default:()=>({docId:-1})}},watch:{shareData(){this.shareData.docId!==-1&&this.getShareDetail()}},setup(){const{currentRoute:e}=$e(),t=wt({project_id:parseInt(e.value.params.project_id,10),document:null,isShow:!1,isShowDetail:!1,isLoading:!1,isLoadingResetPwd:!1,shareUrl:"",isShare:!1,password:"",copyText:"",copyTextEl:I()});return B({},qt(t))},methods:{onShareStatusSwitch(e){this.document!==null&&(this.isLoading=!0,pa({project_id:this.project_id,doc_id:this.shareData.docId,share:e}).then(({data:t})=>{e?(this.updateLinkAndPassword(t.link,t.secret_key),this.document.secret_key=t.secret_key):(this.document.secret_key="",this.isShare=!1)}).catch(t=>{this.isShare=!this.isShare}).finally(()=>{this.isLoading=!1}))},copy(){this.copyTextEl.select(),document.execCommand("copy")&&(this.copyText="\u590D\u5236\u6210\u529F",setTimeout(()=>{this.copyText=this.document.visibility===1?"\u590D\u5236\u94FE\u63A5":"\u590D\u5236\u94FE\u63A5\u548C\u5BC6\u7801"},2e3))},show(){this.isShow=!0},setDocument(e={}){return this.document=e,this.copyText=e.visibility===1?"\u590D\u5236\u94FE\u63A5":"\u590D\u5236\u94FE\u63A5\u548C\u5BC6\u7801",this.isShare=e.visibility===0&&!!e.secret_key,this.updateLinkAndPassword(e.link,e.secret_key),this},updateLinkAndPassword(e,t){this.shareUrl=e||this.shareUrl,this.password=t||this.password,this.updateCopyText()},onResetPasswordBtnClick(){this.isLoadingResetPwd=!0,ma({project_id:this.project_id,doc_id:this.shareData.docId}).then(({data:e})=>this.updateLinkAndPassword(null,e)).finally(()=>{this.isLoadingResetPwd=!1})},updateCopyText(){this.copyTextEl.value=this.document.visibility===1?this.shareUrl:[`\u94FE\u63A5\uFF1A${this.shareUrl}`,`\u5BC6\u7801\uFF1A${this.password}`].join(`
`)},getShareDetail(){this.isShowDetail=!0,fa({project_id:this.project_id,doc_id:this.shareData.docId}).then(({data:e})=>{this.setDocument(e)}).finally(()=>{this.isShowDetail=!1})}}},pc={class:"-m-4"},fc={key:0},mc={key:1},_c=a("div",{class:"flex-1"},[a("h4",null,"\u5F00\u542F\u5206\u4EAB"),a("div",{class:"ivu-list-item-meta-description"},"\u5F00\u542F\u5206\u4EAB\u540E\uFF0C\u83B7\u5F97\u94FE\u63A5\u7684\u4EBA\u53EF\u4EE5\u8BBF\u95EE\u9879\u76EE\u5185\u5BB9\u3002")],-1),gc=K("\u91CD\u7F6E\u5BC6\u7801"),vc={ref:"copyTextEl",style:{position:"fixed",left:"-9999px"}};function yc(e,t,o,s,n,r){const i=nt,c=rt,l=Dt,_=St,C=ro,u=jt,h=Be,g=it;return p(),G(h,{modelValue:e.isShow,"onUpdate:modelValue":t[4]||(t[4]=f=>e.isShow=f),title:"\u5206\u4EAB\u6587\u6863","custom-class":"vertical-center-modal",width:540,"append-to-body":""},{default:m(()=>[W((p(),y("div",pc,[e.document&&e.document.visibility===1?(p(),y("div",fc,[d(_,{"label-position":"top",class:"px-6 py-3"},{default:m(()=>[d(l,{label:""},{default:m(()=>[d(c,{readonly:"",modelValue:e.shareUrl,"onUpdate:modelValue":t[0]||(t[0]=f=>e.shareUrl=f)},{append:m(()=>[d(i,{type:"primary",onClick:r.copy},{default:m(()=>[K(F(e.copyText),1)]),_:1},8,["onClick"])]),_:1},8,["modelValue"])]),_:1})]),_:1})])):T("",!0),e.document&&e.document.visibility===0?(p(),y("div",mc,[a("div",{class:$(["px-6 flex items-center",{"py-3":!e.isShare,"pt-3":e.isShare}])},[_c,d(C,{loading:e.isLoading,modelValue:e.isShare,"onUpdate:modelValue":t[1]||(t[1]=f=>e.isShare=f),onChange:r.onShareStatusSwitch,"inline-prompt":"","active-text":"\u5F00","inactive-text":"\u5173"},null,8,["loading","modelValue","onChange"])],2),e.isShare?(p(),G(u,{key:0})):T("",!0),e.isShare?(p(),G(_,{key:1,"label-position":"top",class:"px-6"},{default:m(()=>[d(l,{label:"\u6587\u6863\u94FE\u63A5"},{default:m(()=>[d(c,{readonly:"",modelValue:e.shareUrl,"onUpdate:modelValue":t[2]||(t[2]=f=>e.shareUrl=f)},{append:m(()=>[d(i,{type:"primary",onClick:r.copy},{default:m(()=>[K(F(e.copyText),1)]),_:1},8,["onClick"])]),_:1},8,["modelValue"])]),_:1}),d(l,{label:"\u5BC6\u7801"},{default:m(()=>[d(l,{prop:"date",class:"mr-1"},{default:m(()=>[d(c,{readonly:"",modelValue:e.password,"onUpdate:modelValue":t[3]||(t[3]=f=>e.password=f)},null,8,["modelValue"])]),_:1}),d(i,{loading:e.isLoadingResetPwd,onClick:r.onResetPasswordBtnClick},{default:m(()=>[gc]),_:1},8,["loading","onClick"])]),_:1})]),_:1})):T("",!0)])):T("",!0)])),[[g,e.isShowDetail]]),a("textarea",vc,null,512)]),_:1},8,["modelValue"])}var Ac=H(hc,[["render",yc]]);let Et=null;const Xe=()=>{Et=ao.service({lock:!0,background:"rgba(255, 255, 255, 1)"})},Ce=()=>{Et&&Et.close()},Cc="el",Ec="is-",ve=(e,t,o,s,n)=>{let r=`${e}-${t}`;return o&&(r+=`-${o}`),s&&(r+=`__${s}`),n&&(r+=`--${n}`),r},Ke=e=>{const t=It(()=>Cc);return{namespace:t,b:(f="")=>ve(D(t),e,f,"",""),e:f=>f?ve(D(t),e,"",f,""):"",m:f=>f?ve(D(t),e,"","",f):"",be:(f,w)=>f&&w?ve(D(t),e,f,w,""):"",em:(f,w)=>f&&w?ve(D(t),e,"",f,w):"",bm:(f,w)=>f&&w?ve(D(t),e,f,"",w):"",bem:(f,w,v)=>f&&w&&v?ve(D(t),e,f,w,v):"",is:(f,...w)=>{const v=w.length>=1?w[0]:!0;return f&&v?`${Ec}${f}`:""},cssVar:f=>{const w={};for(const v in f)w[`--${t.value}-${v}`]=f[v];return w},cssVarName:f=>`--${t.value}-${f}`,cssVarBlock:f=>{const w={};for(const v in f)w[`--${t.value}-${e}-${v}`]=f[v];return w},cssVarBlockName:f=>`--${t.value}-${e}-${f}`}},kc=(e,t,o,s=!1)=>{e&&t&&o&&(e==null||e.addEventListener(t,o,s))},wc=(e,t,o,s=!1)=>{e&&t&&o&&(e==null||e.removeEventListener(t,o,s))},Se="$treeNodeId",Jt=function(e,t){!t||t[Se]||Object.defineProperty(t,Se,{value:e.id,enumerable:!1,configurable:!1,writable:!1})},Bt=function(e,t){return e?t[e]:t[Se]},kt=e=>{let t=!0,o=!0,s=!0;for(let n=0,r=e.length;n<r;n++){const i=e[n];(i.checked!==!0||i.indeterminate)&&(t=!1,i.disabled||(s=!1)),(i.checked!==!1||i.indeterminate)&&(o=!1)}return{all:t,none:o,allWithoutDisable:s,half:!t&&!o}},We=function(e){if(e.childNodes.length===0)return;const{all:t,none:o,half:s}=kt(e.childNodes);t?(e.checked=!0,e.indeterminate=!1):s?(e.checked=!1,e.indeterminate=!0):o&&(e.checked=!1,e.indeterminate=!1);const n=e.parent;!n||n.level===0||e.store.checkStrictly||We(n)},ze=function(e,t){const o=e.store.props,s=e.data||{},n=o[t];if(typeof n=="function")return n(s,e);if(typeof n=="string")return s[n];if(typeof n=="undefined"){const r=s[t];return r===void 0?"":r}};let Nc=0;class Ee{constructor(t){x(this,"id");x(this,"text");x(this,"checked");x(this,"indeterminate");x(this,"data");x(this,"expanded");x(this,"parent");x(this,"visible");x(this,"isCurrent");x(this,"store");x(this,"isLeafByUser");x(this,"isLeaf");x(this,"canFocus");x(this,"level");x(this,"loaded");x(this,"childNodes");x(this,"loading");this.id=Nc++,this.text=void 0,this.checked=!1,this.indeterminate=!1,this.data=void 0,this.expanded=!1,this.parent=void 0,this.visible=!0,this.isCurrent=!1,this.canFocus=!1;for(const o in t)vt(t,o)&&(this[o]=t[o]);this.level=0,this.loaded=!1,this.childNodes=[],this.loading=!1,this.parent&&(this.level=this.parent.level+1)}initialize(){const t=this.store;if(!t)throw new Error("[Node]store is required!");t.registerNode(this);const o=t.props;if(o&&typeof o.isLeaf!="undefined"){const r=ze(this,"isLeaf");typeof r=="boolean"&&(this.isLeafByUser=r)}if(t.lazy!==!0&&this.data?(this.setData(this.data),t.defaultExpandAll&&(this.expanded=!0,this.canFocus=!0)):this.level>0&&t.lazy&&t.defaultExpandAll&&this.expand(),Array.isArray(this.data)||Jt(this,this.data),!this.data)return;const s=t.defaultExpandedKeys,n=t.key;n&&s&&s.includes(this.key)&&this.expand(void 0,t.autoExpandParent),n&&t.currentNodeKey!==void 0&&this.key===t.currentNodeKey&&(t.currentNode=this,t.currentNode.isCurrent=!0),t.lazy&&t._initDefaultCheckedNode(this),this.updateLeafState(),this.parent&&(this.level===1||this.parent.expanded===!0)&&(this.canFocus=!0)}setData(t){Array.isArray(t)||Jt(this,t),this.data=t,this.childNodes=[];let o;this.level===0&&Array.isArray(this.data)?o=this.data:o=ze(this,"children")||[];for(let s=0,n=o.length;s<n;s++)this.insertChild({data:o[s]})}get label(){return ze(this,"label")}get key(){const t=this.store.key;return this.data?this.data[t]:null}get disabled(){return ze(this,"disabled")}get nextSibling(){const t=this.parent;if(t){const o=t.childNodes.indexOf(this);if(o>-1)return t.childNodes[o+1]}return null}get previousSibling(){const t=this.parent;if(t){const o=t.childNodes.indexOf(this);if(o>-1)return o>0?t.childNodes[o-1]:null}return null}contains(t,o=!0){return(this.childNodes||[]).some(s=>s===t||o&&s.contains(t))}remove(){const t=this.parent;t&&t.removeChild(this)}insertChild(t,o,s){if(!t)throw new Error("InsertChild error: child is required.");if(!(t instanceof Ee)){if(!s){const n=this.getChildren(!0);n.includes(t.data)||(typeof o=="undefined"||o<0?n.push(t.data):n.splice(o,0,t.data))}Object.assign(t,{parent:this,store:this.store}),t=wt(new Ee(t)),t instanceof Ee&&t.initialize()}t.level=this.level+1,typeof o=="undefined"||o<0?this.childNodes.push(t):this.childNodes.splice(o,0,t),this.updateLeafState()}insertBefore(t,o){let s;o&&(s=this.childNodes.indexOf(o)),this.insertChild(t,s)}insertAfter(t,o){let s;o&&(s=this.childNodes.indexOf(o),s!==-1&&(s+=1)),this.insertChild(t,s)}removeChild(t){const o=this.getChildren()||[],s=o.indexOf(t.data);s>-1&&o.splice(s,1);const n=this.childNodes.indexOf(t);n>-1&&(this.store&&this.store.deregisterNode(t),t.parent=null,this.childNodes.splice(n,1)),this.updateLeafState()}removeChildByData(t){let o=null;for(let s=0;s<this.childNodes.length;s++)if(this.childNodes[s].data===t){o=this.childNodes[s];break}o&&this.removeChild(o)}expand(t,o){const s=()=>{if(o){let n=this.parent;for(;n.level>0;)n.expanded=!0,n=n.parent}this.expanded=!0,t&&t(),this.childNodes.forEach(n=>{n.canFocus=!0})};this.shouldLoadData()?this.loadData(n=>{Array.isArray(n)&&(this.checked?this.setChecked(!0,!0):this.store.checkStrictly||We(this),s())}):s()}doCreateChildren(t,o={}){t.forEach(s=>{this.insertChild(Object.assign({data:s},o),void 0,!0)})}collapse(){this.expanded=!1,this.childNodes.forEach(t=>{t.canFocus=!1})}shouldLoadData(){return this.store.lazy===!0&&this.store.load&&!this.loaded}updateLeafState(){if(typeof this.isLeafByUser!="undefined"){this.isLeaf=this.isLeafByUser;return}this.isLeaf=!1}setChecked(t,o,s,n){if(this.indeterminate=t==="half",this.checked=t===!0,this.store.checkStrictly)return;if(!(this.shouldLoadData()&&!this.store.checkDescendants)){const{all:i,allWithoutDisable:c}=kt(this.childNodes);!this.isLeaf&&!i&&c&&(this.checked=!1,t=!1);const l=()=>{if(o){const _=this.childNodes;for(let h=0,g=_.length;h<g;h++){const f=_[h];n=n||t!==!1;const w=f.disabled?f.checked:n;f.setChecked(w,o,!0,n)}const{half:C,all:u}=kt(_);u||(this.checked=u,this.indeterminate=C)}};if(this.shouldLoadData()){this.loadData(()=>{l(),We(this)},{checked:t!==!1});return}else l()}const r=this.parent;!r||r.level===0||s||We(r)}getChildren(t=!1){if(this.level===0)return this.data;const o=this.data;if(!o)return null;const s=this.store.props;let n="children";return s&&(n=s.children||"children"),o[n]===void 0&&(o[n]=null),t&&!o[n]&&(o[n]=[]),o[n]}updateChildren(){const t=this.getChildren()||[],o=this.childNodes.map(r=>r.data),s={},n=[];t.forEach((r,i)=>{const c=r[Se];!!c&&o.findIndex(_=>_[Se]===c)>=0?s[c]={index:i,data:r}:n.push({index:i,data:r})}),this.store.lazy||o.forEach(r=>{s[r[Se]]||this.removeChildByData(r)}),n.forEach(({index:r,data:i})=>{this.insertChild({data:i},r)}),this.updateLeafState()}loadData(t,o={}){if(this.store.lazy===!0&&this.store.load&&!this.loaded&&(!this.loading||Object.keys(o).length)){this.loading=!0;const s=n=>{this.loaded=!0,this.loading=!1,this.childNodes=[],this.doCreateChildren(n,o),this.updateLeafState(),t&&t.call(this,n)};this.store.load(this,s)}else t&&t.call(this)}}class bc{constructor(t){x(this,"currentNode");x(this,"currentNodeKey");x(this,"nodesMap");x(this,"root");x(this,"data");x(this,"lazy");x(this,"load");x(this,"filterNodeMethod");x(this,"key");x(this,"defaultCheckedKeys");x(this,"checkStrictly");x(this,"defaultExpandedKeys");x(this,"autoExpandParent");x(this,"defaultExpandAll");x(this,"checkDescendants");x(this,"props");this.currentNode=null,this.currentNodeKey=null;for(const o in t)vt(t,o)&&(this[o]=t[o]);this.nodesMap={}}initialize(){this.root=new Ee({data:this.data,store:this}),this.root.initialize(),this.lazy&&this.load?this.load(this.root,o=>{this.root.doCreateChildren(o),this._initDefaultCheckedNodes()}):this._initDefaultCheckedNodes()}filter(t){const o=this.filterNodeMethod,s=this.lazy,n=function(r){const i=r.root?r.root.childNodes:r.childNodes;if(i.forEach(c=>{c.visible=o.call(c,t,c.data,c),n(c)}),!r.visible&&i.length){let c=!0;c=!i.some(l=>l.visible),r.root?r.root.visible=c===!1:r.visible=c===!1}!t||r.visible&&!r.isLeaf&&!s&&r.expand()};n(this)}setData(t){t!==this.root.data?(this.root.setData(t),this._initDefaultCheckedNodes()):this.root.updateChildren()}getNode(t){if(t instanceof Ee)return t;const o=typeof t!="object"?t:Bt(this.key,t);return this.nodesMap[o]||null}insertBefore(t,o){const s=this.getNode(o);s.parent.insertBefore({data:t},s)}insertAfter(t,o){const s=this.getNode(o);s.parent.insertAfter({data:t},s)}remove(t){const o=this.getNode(t);o&&o.parent&&(o===this.currentNode&&(this.currentNode=null),o.parent.removeChild(o))}append(t,o){const s=o?this.getNode(o):this.root;s&&s.insertChild({data:t})}_initDefaultCheckedNodes(){const t=this.defaultCheckedKeys||[],o=this.nodesMap;t.forEach(s=>{const n=o[s];n&&n.setChecked(!0,!this.checkStrictly)})}_initDefaultCheckedNode(t){(this.defaultCheckedKeys||[]).includes(t.key)&&t.setChecked(!0,!this.checkStrictly)}setDefaultCheckedKey(t){t!==this.defaultCheckedKeys&&(this.defaultCheckedKeys=t,this._initDefaultCheckedNodes())}registerNode(t){const o=this.key;!t||!t.data||(o?t.key!==void 0&&(this.nodesMap[t.key]=t):this.nodesMap[t.id]=t)}deregisterNode(t){!this.key||!t||!t.data||(t.childNodes.forEach(s=>{this.deregisterNode(s)}),delete this.nodesMap[t.key])}getCheckedNodes(t=!1,o=!1){const s=[],n=function(r){(r.root?r.root.childNodes:r.childNodes).forEach(c=>{(c.checked||o&&c.indeterminate)&&(!t||t&&c.isLeaf)&&s.push(c.data),n(c)})};return n(this),s}getCheckedKeys(t=!1){return this.getCheckedNodes(t).map(o=>(o||{})[this.key])}getHalfCheckedNodes(){const t=[],o=function(s){(s.root?s.root.childNodes:s.childNodes).forEach(r=>{r.indeterminate&&t.push(r.data),o(r)})};return o(this),t}getHalfCheckedKeys(){return this.getHalfCheckedNodes().map(t=>(t||{})[this.key])}_getAllNodes(){const t=[],o=this.nodesMap;for(const s in o)vt(o,s)&&t.push(o[s]);return t}updateChildren(t,o){const s=this.nodesMap[t];if(!s)return;const n=s.childNodes;for(let r=n.length-1;r>=0;r--){const i=n[r];this.remove(i.data)}for(let r=0,i=o.length;r<i;r++){const c=o[r];this.append(c,s.data)}}_setCheckedKeys(t,o=!1,s){const n=this._getAllNodes().sort((c,l)=>l.level-c.level),r=Object.create(null),i=Object.keys(s);n.forEach(c=>c.setChecked(!1,!1));for(let c=0,l=n.length;c<l;c++){const _=n[c],C=_.data[t].toString();if(!i.includes(C)){_.checked&&!r[C]&&_.setChecked(!1,!1);continue}let h=_.parent;for(;h&&h.level>0;)r[h.data[t]]=!0,h=h.parent;if(_.isLeaf||this.checkStrictly){_.setChecked(!0,!1);continue}if(_.setChecked(!0,!0),o){_.setChecked(!1,!1);const g=function(f){f.childNodes.forEach(v=>{v.isLeaf||v.setChecked(!1,!1),g(v)})};g(_)}}}setCheckedNodes(t,o=!1){const s=this.key,n={};t.forEach(r=>{const i=r||{};n[i[s]]=!0}),this._setCheckedKeys(s,o,n)}setCheckedKeys(t,o=!1){this.defaultCheckedKeys=t;const s=this.key,n={};t.forEach(r=>{n[r]=!0}),this._setCheckedKeys(s,o,n)}setDefaultExpandedKeys(t){t=t||[],this.defaultExpandedKeys=t,t.forEach(o=>{const s=this.getNode(o);s&&s.expand(void 0,this.autoExpandParent)})}setChecked(t,o,s){const n=this.getNode(t);n&&n.setChecked(!!o,s)}getCurrentNode(){return this.currentNode}setCurrentNode(t){const o=this.currentNode;o&&(o.isCurrent=!1),this.currentNode=t,this.currentNode.isCurrent=!0}setUserCurrentNode(t,o=!0){const s=t[this.key],n=this.nodesMap[s];this.setCurrentNode(n),o&&this.currentNode.level>1&&this.currentNode.parent.expand(null,!0)}setCurrentNodeKey(t,o=!0){if(t==null){this.currentNode&&(this.currentNode.isCurrent=!1),this.currentNode=null;return}const s=this.getNode(t);s&&(this.setCurrentNode(s),o&&this.currentNode.level>1&&this.currentNode.parent.expand(null,!0))}}const Ic=Q({name:"AcTreeNodeContent",props:{node:{type:Object,required:!0},renderContent:Function},setup(e){const t=Ke("tree"),o=me("NodeInstance"),s=me("RootTree");return()=>{const n=e.node,{data:r,store:i}=n;return e.renderContent?e.renderContent(gt,{_self:o,node:n,data:r,store:i}):s.ctx.slots.default?s.ctx.slots.default({node:n,data:r}):gt("span",{class:t.be("node","label")},[n.label])}}});function xo(e){const t=me("TreeNodeMap",void 0),o={treeNodeExpand:s=>{e.node!==s&&e.node.collapse()},children:[]};return t&&t.children.push(o),le("TreeNodeMap",o),{broadcastExpanded:s=>{if(!!e.accordion)for(const n of o.children)n.treeNodeExpand(s)}}}const jo=Symbol("dragEvents");function Dc({props:e,ctx:t,el$:o,dropIndicator$:s,store:n}){const r=Ke("tree"),i=I({showDropIndicator:!1,draggingNode:null,dropNode:null,allowDrop:!0,dropType:null});return le(jo,{treeNodeDragStart:({event:C,treeNode:u})=>{if(typeof e.allowDrag=="function"&&!e.allowDrag(u.node))return C.preventDefault(),!1;C.dataTransfer.effectAllowed="move";try{C.dataTransfer.setData("text/plain","")}catch{}i.value.draggingNode=u,t.emit("node-drag-start",u.node,C)},treeNodeDragOver:({event:C,treeNode:u})=>{const h=u,g=i.value.dropNode;g&&g!==h&&lt(g.$el,r.is("drop-inner"));const f=i.value.draggingNode;if(!f||!h)return;let w=!0,v=!0,S=!0,P=!0;typeof e.allowDrop=="function"&&(w=e.allowDrop(f.node,h.node,"prev"),P=v=e.allowDrop(f.node,h.node,"inner"),S=e.allowDrop(f.node,h.node,"next")),C.dataTransfer.dropEffect=v||w||S?"move":"none",(w||v||S)&&g!==h&&(g&&t.emit("node-drag-leave",f.node,g.node,C),t.emit("node-drag-enter",f.node,h.node,C)),(w||v||S)&&(i.value.dropNode=h),h.node.nextSibling===f.node&&(S=!1),h.node.previousSibling===f.node&&(w=!1),h.node.contains(f.node,!1)&&(v=!1),(f.node===h.node||f.node.contains(h.node))&&(w=!1,v=!1,S=!1);const R=h.$el.getBoundingClientRect(),O=o.value.getBoundingClientRect();let L;const ae=w?v?.25:S?.45:1:-1,z=S?v?.75:w?.55:0:1;let q=-9999;const b=C.clientY-R.top;b<R.height*ae?L="before":b>R.height*z?L="after":v?L="inner":L="none";const M=h.$el.querySelector(`.${r.be("node","expand-icon")}`).getBoundingClientRect(),J=s.value;L==="before"?q=M.top-O.top:L==="after"&&(q=M.bottom-O.top),J.style.top=`${q}px`,J.style.left=`${M.right-O.left}px`,L==="inner"?zs(h.$el,r.is("drop-inner")):lt(h.$el,r.is("drop-inner")),i.value.showDropIndicator=L==="before"||L==="after",i.value.allowDrop=i.value.showDropIndicator||P,i.value.dropType=L,t.emit("node-drag-over",f.node,h.node,C)},treeNodeDragEnd:C=>{const{draggingNode:u,dropType:h,dropNode:g}=i.value;if(C.preventDefault(),C.dataTransfer.dropEffect="move",u&&g){const f={data:u.node.data};h!=="none"&&u.node.remove(),h==="before"?g.node.parent.insertBefore(f,g.node):h==="after"?g.node.parent.insertAfter(f,g.node):h==="inner"&&g.node.insertChild(f),h!=="none"&&n.value.registerNode(f),lt(g.$el,r.is("drop-inner")),t.emit("node-drag-end",u.node,g.node,h,C),h!=="none"&&t.emit("node-drop",u.node,g.node,h,C)}u&&!g&&t.emit("node-drag-end",u.node,null,h,C),i.value.showDropIndicator=!1,i.value.draggingNode=null,i.value.dropNode=null,i.value.allowDrop=!0}}),{dragState:i}}const Sc=Q({name:"AcTreeNode",components:{NodeContent:Ic,Loading:ws},props:{node:{type:Ee,default:()=>({})},props:{type:Object,default:()=>({})},accordion:Boolean,renderContent:Function,renderAfterExpand:Boolean,showCheckbox:{type:Boolean,default:!1}},emits:["node-expand"],setup(e,t){const o=Ke("tree"),{broadcastExpanded:s}=xo(e),n=me("RootTree"),r=I(!1),i=I(!1),c=I(!1),l=I(!1),_=I(null),C=me(jo),u=so();le("NodeInstance",u),e.node.expanded&&(r.value=!0,i.value=!0);const h=n.props.children||"children";ie(()=>{const b=e.node.data[h];return b&&[...b]},()=>{e.node.updateChildren()}),ie(()=>e.node.indeterminate,b=>{w(e.node.checked,b)}),ie(()=>e.node.checked,b=>{w(b,e.node.indeterminate)}),ie(()=>e.node.expanded,b=>{Ze(()=>r.value=b),b&&(i.value=!0)});const g=b=>Bt(n.props.nodeKey,b.data),f=b=>{const M=e.props.class;if(!M)return{};let J;if(Qo(M)){const{data:je}=b;J=M(je,b)}else J=M;return Xo(J)?{[J]:!0}:J},w=(b,M)=>{(c.value!==b||l.value!==M)&&n.ctx.emit("check-change",e.node.data,b,M),c.value=b,l.value=M},v=b=>{const M=n.store.value;M.setCurrentNode(e.node),n.ctx.emit("current-change",M.currentNode?M.currentNode.data:null,M.currentNode),n.currentNode.value=e.node,n.props.expandOnClickNode&&P(),n.props.checkOnClickNode&&!e.node.disabled&&R(null,{target:{checked:!e.node.checked}}),n.ctx.emit("node-click",e.node.data,e.node,u,b)},S=b=>{n.instance.vnode.props.onNodeContextmenu&&(b.stopPropagation(),b.preventDefault()),n.ctx.emit("node-contextmenu",b,e.node.data,e.node,u)},P=()=>{e.node.isLeaf||(r.value?(n.ctx.emit("node-collapse",e.node.data,e.node,u),e.node.collapse()):(e.node.expand(),t.emit("node-expand",e.node.data,e.node,u)))},R=(b,M)=>{e.node.setChecked(M.target.checked,!n.props.checkStrictly),Ze(()=>{const J=n.store.value;n.ctx.emit("check",e.node.data,{checkedNodes:J.getCheckedNodes(),checkedKeys:J.getCheckedKeys(),halfCheckedNodes:J.getHalfCheckedNodes(),halfCheckedKeys:J.getHalfCheckedKeys()})})};return{ns:o,node$:_,tree:n,expanded:r,childNodeRendered:i,oldChecked:c,oldIndeterminate:l,getNodeKey:g,getNodeClass:f,handleSelectChange:w,handleClick:v,handleContextMenu:S,handleExpandIconClick:P,handleCheckChange:R,handleChildNodeExpand:(b,M,J)=>{s(M),n.ctx.emit("node-expand",b,M,J)},handleDragStart:b=>{!n.props.draggable||C.treeNodeDragStart({event:b,treeNode:e})},handleDragOver:b=>{b.preventDefault(),n.props.draggable&&C.treeNodeDragOver({event:b,treeNode:{$el:_.value,node:e.node}})},handleDrop:b=>{b.preventDefault()},handleDragEnd:b=>{!n.props.draggable||C.treeNodeDragEnd(b)},CaretRight:Ns}}}),Pc=["aria-expanded","aria-disabled","aria-checked","draggable","data-key"],xc=["aria-expanded"];function jc(e,t,o,s,n,r){const i=xe,c=bs,l=Z("loading"),_=Z("node-content"),C=Z("ac-tree-node");return W((p(),y("div",{ref:"node$",class:$([e.ns.b("node"),e.ns.is("expanded",e.expanded),e.ns.is("current",e.node.isCurrent),e.ns.is("hidden",!e.node.visible),e.ns.is("focusable",!e.node.disabled),e.ns.is("checked",!e.node.disabled&&e.node.checked),e.getNodeClass(e.node)]),role:"treeitem",tabindex:"-1","aria-expanded":e.expanded,"aria-disabled":e.node.disabled,"aria-checked":e.node.checked,draggable:e.tree.props.draggable,"data-key":e.getNodeKey(e.node),onClick:t[1]||(t[1]=te((...u)=>e.handleClick&&e.handleClick(...u),["stop"])),onContextmenu:t[2]||(t[2]=(...u)=>e.handleContextMenu&&e.handleContextMenu(...u)),onDragstart:t[3]||(t[3]=te((...u)=>e.handleDragStart&&e.handleDragStart(...u),["stop"])),onDragover:t[4]||(t[4]=te((...u)=>e.handleDragOver&&e.handleDragOver(...u),["stop"])),onDragend:t[5]||(t[5]=te((...u)=>e.handleDragEnd&&e.handleDragEnd(...u),["stop"])),onDrop:t[6]||(t[6]=te((...u)=>e.handleDrop&&e.handleDrop(...u),["stop"]))},[a("div",{class:$(e.ns.be("node","content")),style:to({paddingLeft:(e.node.level-1)*e.tree.props.indent+"px"})},[e.tree.props.icon||e.CaretRight?(p(),G(i,{key:0,class:$([e.ns.be("node","expand-icon"),e.ns.is("leaf",e.node.isLeaf),{expanded:!e.node.isLeaf&&e.expanded}]),onClick:te(e.handleExpandIconClick,["stop"])},{default:m(()=>[(p(),G(es(e.tree.props.icon||e.CaretRight)))]),_:1},8,["class","onClick"])):T("",!0),e.showCheckbox?(p(),G(c,{key:1,"model-value":e.node.checked,indeterminate:e.node.indeterminate,disabled:!!e.node.disabled,onClick:t[0]||(t[0]=te(()=>{},["stop"])),onChange:e.handleCheckChange},null,8,["model-value","indeterminate","disabled","onChange"])):T("",!0),e.node.loading?(p(),G(i,{key:2,class:$([e.ns.be("node","loading-icon"),e.ns.is("loading")])},{default:m(()=>[d(l)]),_:1},8,["class"])):T("",!0),d(_,{node:e.node,"render-content":e.renderContent},null,8,["node","render-content"])],6),!e.renderAfterExpand||e.childNodeRendered?W((p(),y("div",{key:0,class:$(e.ns.be("node","children")),role:"group","aria-expanded":e.expanded},[(p(!0),y(U,null,X(e.node.childNodes,u=>(p(),G(C,{key:e.getNodeKey(u),"render-content":e.renderContent,"render-after-expand":e.renderAfterExpand,"show-checkbox":e.showCheckbox,node:u,accordion:e.accordion,props:e.props,onNodeExpand:e.handleChildNodeExpand},null,8,["render-content","render-after-expand","show-checkbox","node","accordion","props","onNodeExpand"]))),128))],10,xc)),[[oe,e.expanded]]):T("",!0)],42,Pc)),[[oe,e.node.visible]])}var Rc=H(Sc,[["render",jc]]);function Lc({el$:e},t){const o=Ke("tree"),s=Ut([]),n=Ut([]);st(()=>{i(),kc(e.value,"keydown",r)}),ts(()=>{wc(e.value,"keydown",r)}),os(()=>{s.value=Array.from(e.value.querySelectorAll("[role=treeitem]")),n.value=Array.from(e.value.querySelectorAll("input[type=checkbox]"))}),ie(n,c=>{c.forEach(l=>{l.setAttribute("tabindex","-1")})});const r=c=>{const l=c.target;if(!l.className.includes(o.b("node")))return;const _=c.code;s.value=Array.from(e.value.querySelectorAll(`.${o.is("focusable")}[role=treeitem]`));const C=s.value.indexOf(l);let u;if([ge.up,ge.down].includes(_)){if(c.preventDefault(),_===ge.up){u=C===-1?0:C!==0?C-1:s.value.length-1;const g=u;for(;!t.value.getNode(s.value[u].dataset.key).canFocus;){if(u--,u===g){u=-1;break}u<0&&(u=s.value.length-1)}}else{u=C===-1?0:C<s.value.length-1?C+1:0;const g=u;for(;!t.value.getNode(s.value[u].dataset.key).canFocus;){if(u++,u===g){u=-1;break}u>=s.value.length&&(u=0)}}u!==-1&&s.value[u].focus()}[ge.left,ge.right].includes(_)&&(c.preventDefault(),l.click());const h=l.querySelector('[type="checkbox"]');[ge.enter,ge.space].includes(_)&&h&&(c.preventDefault(),h.click())},i=()=>{var l;s.value=Array.from(e.value.querySelectorAll(`.${o.is("focusable")}[role=treeitem]`)),n.value=Array.from(e.value.querySelectorAll("input[type=checkbox]"));const c=e.value.querySelectorAll(`.${o.is("checked")}[role=treeitem]`);if(c.length){c[0].setAttribute("tabindex","0");return}(l=s.value[0])==null||l.setAttribute("tabindex","0")}}const Tc=Q({name:"AcTree",components:{AcTreeNode:Rc},props:{data:{type:Array,default:()=>[]},emptyText:{type:String},renderAfterExpand:{type:Boolean,default:!0},nodeKey:String,checkStrictly:Boolean,defaultExpandAll:Boolean,expandOnClickNode:{type:Boolean,default:!0},checkOnClickNode:Boolean,checkDescendants:{type:Boolean,default:!1},autoExpandParent:{type:Boolean,default:!0},defaultCheckedKeys:Array,defaultExpandedKeys:Array,currentNodeKey:[String,Number],renderContent:Function,showCheckbox:{type:Boolean,default:!1},draggable:{type:Boolean,default:!1},allowDrag:Function,allowDrop:Function,props:{type:Object,default:()=>({children:"children",label:"label",disabled:"disabled"})},lazy:{type:Boolean,default:!1},highlightCurrent:Boolean,load:Function,filterNodeMethod:Function,accordion:Boolean,indent:{type:Number,default:18},icon:[String,Object]},emits:["check-change","current-change","node-click","node-contextmenu","node-collapse","node-expand","check","node-drag-start","node-drag-end","node-drop","node-drag-leave","node-drag-enter","node-drag-over"],setup(e,t){const o=Ke("tree"),s=I(new bc({key:e.nodeKey,data:e.data,lazy:e.lazy,props:e.props,load:e.load,currentNodeKey:e.currentNodeKey,checkStrictly:e.checkStrictly,checkDescendants:e.checkDescendants,defaultCheckedKeys:e.defaultCheckedKeys,defaultExpandedKeys:e.defaultExpandedKeys,autoExpandParent:e.autoExpandParent,defaultExpandAll:e.defaultExpandAll,filterNodeMethod:e.filterNodeMethod}));s.value.initialize();const n=I(s.value.root),r=I(null),i=I(null),c=I(null),{broadcastExpanded:l}=xo(e),{dragState:_}=Dc({props:e,ctx:t,el$:i,dropIndicator$:c,store:s});Lc({el$:i},s);const C=It(()=>{const{childNodes:k}=n.value;return!k||k.length===0||k.every(({visible:E})=>!E)});ie(()=>e.defaultCheckedKeys,k=>{s.value.setDefaultCheckedKey(k)}),ie(()=>e.defaultExpandedKeys,k=>{s.value.setDefaultExpandedKeys(k)}),ie(()=>e.data,k=>{s.value.setData(k)},{deep:!0}),ie(()=>e.checkStrictly,k=>{s.value.checkStrictly=k});const u=k=>{if(!e.filterNodeMethod)throw new Error("[Tree] filterNodeMethod is required when filter");s.value.filter(k)},h=k=>Bt(e.nodeKey,k.data),g=k=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in getNodePath");const E=s.value.getNode(k);if(!E)return[];const N=[E.data];let V=E.parent;for(;V&&V!==n.value;)N.push(V.data),V=V.parent;return N.reverse()},f=(k,E)=>s.value.getCheckedNodes(k,E),w=k=>s.value.getCheckedKeys(k),v=()=>{const k=s.value.getCurrentNode();return k?k.data:null},S=()=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in getCurrentKey");const k=v();return k?k[e.nodeKey]:null},P=(k,E)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCheckedNodes");s.value.setCheckedNodes(k,E)},R=(k,E)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCheckedKeys");s.value.setCheckedKeys(k,E)},O=(k,E,N)=>{s.value.setChecked(k,E,N)},L=()=>s.value.getHalfCheckedNodes(),ae=()=>s.value.getHalfCheckedKeys(),z=(k,E=!0)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCurrentNode");s.value.setUserCurrentNode(k,E)},q=(k,E=!0)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCurrentKey");s.value.setCurrentNodeKey(k,E)},b=k=>s.value.getNode(k),M=k=>{s.value.remove(k)},J=(k,E)=>{s.value.append(k,E)},je=(k,E)=>{s.value.insertBefore(k,E)},at=(k,E)=>{s.value.insertAfter(k,E)},we=(k,E,N)=>{l(E),t.emit("node-expand",k,E,N)},Ue=(k,E)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in updateKeyChild");s.value.updateChildren(k,E)};return le("RootTree",{ctx:t,props:e,store:s,root:n,currentNode:r,instance:so()}),{ns:o,store:s,root:n,currentNode:r,dragState:_,el$:i,dropIndicator$:c,isEmpty:C,filter:u,getNodeKey:h,getNodePath:g,getCheckedNodes:f,getCheckedKeys:w,getCurrentNode:v,getCurrentKey:S,setCheckedNodes:P,setCheckedKeys:R,setChecked:O,getHalfCheckedNodes:L,getHalfCheckedKeys:ae,setCurrentNode:z,setCurrentKey:q,getNode:b,remove:M,append:J,insertBefore:je,insertAfter:at,handleNodeExpand:we,updateKeyChildren:Ue}}});function Oc(e,t,o,s,n,r){var c;const i=Z("ac-tree-node");return p(),y("div",{ref:"el$",class:$([e.ns.b(),e.ns.is("dragging",!!e.dragState.draggingNode),e.ns.is("drop-not-allow",!e.dragState.allowDrop),e.ns.is("drop-inner",e.dragState.dropType==="inner"),{[e.ns.m("highlight-current")]:e.highlightCurrent}]),role:"tree"},[(p(!0),y(U,null,X(e.root.childNodes,l=>(p(),G(i,{key:e.getNodeKey(l),node:l,props:e.props,accordion:e.accordion,"render-after-expand":e.renderAfterExpand,"show-checkbox":e.showCheckbox,"render-content":e.renderContent,onNodeExpand:e.handleNodeExpand},null,8,["node","props","accordion","render-after-expand","show-checkbox","render-content","onNodeExpand"]))),128)),e.isEmpty?(p(),y("div",{key:0,class:$(e.ns.e("empty-block"))},[a("span",{class:$(e.ns.e("empty-text"))},F((c=e.emptyText)!=null?c:"\u6682\u65E0\u6570\u636E"),3)],2)):T("",!0),W(a("div",{ref:"dropIndicator$",class:$(e.ns.e("drop-indicator"))},null,2),[[oe,e.dragState.showDropIndicator]])],2)}var Mc=H(Tc,[["render",Oc]]),$c=Q({components:{AcTree:Mc,DocumentShareModal:Ac,Plus:Is,MoreFilled:no},setup(){const e=me("documentImportModal"),t=me("projectExportModal"),o=oo(),s=$e(),{currentRoute:n}=s,{params:r}=o,{project_id:i}=r,c=Io(),{apiDocTree:l}=ke(c),_=Po,C=I(null),u=I(null),h=I(null),g=I(null),f=I(null),w=I({docType:null,dicId:null});let v=1;const S=null,P=It(()=>n.value.name==="document.api.detail"),R=(E,N,V)=>{if(V.target.tagName!=="INPUT"){if(N.isLeaf){O(N);return}E.expanded=!E.expanded}},O=E=>{const{node_id:N}=n.value.params;P.value&&E.id===parseInt(N,10)||(we(E.id),s.push({name:"document.api.detail",params:_e(B({},r),{node_id:E.id})}))},L=(E,N,V,ee)=>{E.stopPropagation(),C.value=V.id,mt.show(ee,E.target,{node:N,source:V,isDetailPage:P.value})},ae=E=>{var N;L(E,(N=h.value)==null?void 0:N.root,l.value,"DIR_NEW_TYPE")},z=ss(function(E){let N=0;return fe(V=>{V.isLeaf||N++},[E],{subKey:"sub_nodes"}),N}),q=(E,N,V)=>{const{data:ee}=N,{data:ce}=E;return ee.isLeaf&&V==="inner"?!1:!ce.isLeaf&&!ee.isLeaf?z(ce)+N.level<=5:!0},b=E=>E.isLeaf?"is-doc":"is-dir",M=E=>E.type===ye.DOC,J=async()=>{var E,N,V;await Ze(),(E=u.value)==null||E.focus(),(V=u.value)==null||V.setSelectionRange(0,(N=u.value)==null?void 0:N.value.length)},je=E=>{E.target&&E.target.blur()},at=Nt(function(E,N){if(N.isEditable=!1,!E.target.value&&N._oldName){N.title=N._oldName;return}const V=N.type===ye.DIR,ee=V?ya:ua,ce={project_id:i,title:N.title};ce[V?"node_id":"doc_id"]=N.id,ee(ce).then(()=>{delete N._oldName}).catch(()=>{N._oldName&&(N.title=N._oldName)})},200),we=E=>{var Ne,Ft;fe(Kt=>{if(Kt.isCurrent)return Kt.isCurrent=!1,!1},l.value,{subKey:"sub_nodes"});const{node_id:N}=n.value.params,ee=parseInt(E||N,10),ce=(Ne=h.value)==null?void 0:Ne.getNode(ee);ce&&(ce.data.isCurrent=!0,(Ft=h.value)==null||Ft.setCurrentKey(ee))},Ue=()=>{if(!h.value)return;let E=!1;if(fe(N=>{if(N.isCurrent)return E=!0,!1},l.value,{subKey:"sub_nodes"}),!E){let N=null;fe(ce=>{let Ne=h.value.getNode(ce.id);if(Ne&&Ne.data.isLeaf)return N=Ne,!1},l.value,{subKey:"sub_nodes"});let V={project_id:i};N&&(V.node_id=N.key,we(N.key));const ee=f.value;ee==null||ee.scrollTo(0,0),s.replace({name:"document.api.detail",params:V})}},k=async()=>{await c.getApiDocTree(i),Ce()};return st(async()=>{await k(),n.value.params.node_id?we():Ue()}),{$router:s,index:v,oldDraggingNodeInfo:S,project_id:i,apiDocTree:l,renameInput:u,dir:f,activeMoreNodeId:C,treeIns:h,newMenus:_,documentShareModal:g,shareData:w,createDocIcon:So,handleTreeNodeClick:R,onRootMoreIconClick:ae,onMoreIconClick:L,allowDrop:q,customNodeClass:b,customNodeLeaf:M,onEnterKeyUp:je,setUnEditable:at,inputFocus:J,activeNode:we,reactiveNode:Ue,documentImportModal:e,projectExportModal:t}},mounted(){mt.onPopperItemClick=({menu:e,node:t,source:o})=>this.onPopperItemClick(e,t,o),mt.onPopperHide=()=>{this.activeMoreNodeId=null}},methods:{onPopperItemClick(e,t,o){const s=this[e.onClick];s&&s(t||this.treeIns.root,o||{sub_nodes:this.apiDocTree,id:0},e)},onRenameBtnClick(e,t){t._oldName=t.title,t.isEditable=!0,this.inputFocus()},onDeleteBtnClick(e,t){let o=!t.isLeaf;Ao({title:"\u5220\u9664\u63D0\u793A",content:d("div",{class:"break-all"},[K("\u786E\u5B9A\u5220\u9664\u300C"),t.title,K("\u300D"),o?"\u5206\u7C7B":"\u6587\u4EF6",K("\u5417\uFF1F")]),onOk:()=>{const s=t.type===ye.DIR,n=s?va:ha;let r={project_id:this.project_id};return r[s?"node_id":"doc_id"]=t.id,n(r).then(i=>{de.success(i.msg||"\u5220\u9664\u6210\u529F\uFF01"),this.treeIns.remove(e),this.reactiveNode()})}})},onCreateDirBtnClick(e,t){let o={project_id:this.project_id,name:"\u65B0\u5EFA\u5206\u7C7B"+this.index++};t.id&&(o.parent_id=t.id,o.pid=t.id),he.start(),ga(o).then(s=>{const n=Ye(s.data,ye.DIR);!e.parent&&e.level===0?t.unshift(n):!t.sub_nodes||!t.sub_nodes.length?this.treeIns.append(n,e):this.treeIns.insertBefore(n,t.sub_nodes[0]),this.$nextTick(()=>{const r=this.treeIns.getNode(t);r&&(r.expanded=!0);const i=this.treeIns.getNode(s.data);i.data.isEditable=!0,setTimeout(()=>this.inputFocus(),100)})}).finally(()=>{he.done()})},createDoc(e,t){let o={project_id:this.project_id,parent_id:e.key,pid:e.key};he.start(),ca(o).then(({data:s})=>{this.treeIns.append(Ye(s),e),this.$nextTick(()=>{this.treeIns.setCurrentKey(s.id);const n=this.treeIns.getNode(t);n&&(n.expanded=!0),this.$router.push({name:"document.api.edit",params:{project_id:this.project_id,node_id:s.id},query:{isNew:!0}}),this.activeNode(s.id)})}).finally(()=>{he.done()})},onMoveNodeStart(e){const t=e.parent;this.oldDraggingNodeInfo={oldPid:t.id===0?null:t.key,oldChildIds:t.childNodes.filter(o=>o.id!==e.id).map(o=>o.key)}},onMoveNode(e,t,o){if(!this.oldDraggingNodeInfo)return;const{oldPid:s,oldChildIds:n}=this.oldDraggingNodeInfo;let r=s===t.parent.id&&o!=="inner";const i=this.treeIns.getNode(e.data).parent,c=i.id===0?null:i.key,l=i.childNodes.map(C=>C.key),_={oldPid:r?c:s,oldChildIds:r?l:n,newPid:c,newChildIds:l};this.oldDraggingNodeInfo=null,Aa({new_pid:_.newPid||0,new_node_ids:_.newChildIds,old_pid:_.oldPid||0,old_node_ids:_.oldChildIds,project_id:this.project_id})},onCopyBtnClick(e,t){he.start(),da({project_id:this.project_id,doc_id:t.id}).then(({data:o})=>{this.treeIns.insertAfter(Ye(o),e),this.$router.push({name:"document.api.edit",params:{project_id:this.project_id,node_id:o.id}})}).finally(()=>{he.done()})},onShareBtnClick(e,t){this.shareData={docId:t.id,nodeId:t.id},this.documentShareModal.show()},onImportBtnClick(e,t){this.documentImportModal.show({project_id:this.project_id,parent_id:t.id?t.id:0},_a)},onExportBtnClick(e,t){this.projectExportModal.title="\u5BFC\u51FA\u6587\u6863",this.projectExportModal.show({project_id:this.project_id,doc_id:t.id},Xi)},updateTreeNode(e,t={title:""}){let o=this.treeIns.getNode(e);o&&o.data.title&&(o.data.title=t.title||o.title)},createHttpDoc(e,t){let o={project_id:this.project_id,parent_id:e.key,pid:e.key};he.start(),la(o).then(({data:s})=>{this.treeIns.append(Ye(s),e),this.$nextTick(()=>{const n=this.treeIns.getNode(t);n&&(n.expanded=!0),this.$router.push({name:"document.api.edit",params:{project_id:this.project_id,node_id:s.id},query:{isNew:!0}})})}).finally(()=>{he.done()})}}});const Bc={class:"h-full overflow-x-scroll scroll-content",ref:"dir"},Fc={class:"flex justify-between items-center mb-7 px-1"},Kc=a("h3",{class:"text-base font-medium"},"\u76EE\u5F55",-1),Vc=a("div",{class:"el-tree-node__bg"},null,-1),Uc=["onClick"],Gc=["src"],Yc=["title"],zc=["id","onUpdate:modelValue","maxlength","onBlur"],Hc=a("span",{class:"mx-1"},null,-1);function Jc(e,t,o,s,n,r){const i=Z("plus"),c=xe,l=Z("more-filled"),_=Z("ac-tree"),C=Z("DocumentShareModal");return p(),y(U,null,[a("div",Bc,[a("div",Fc,[Kc,d(c,{class:"cursor-pointer text-zinc-500",onClick:e.onRootMoreIconClick},{default:m(()=>[d(i)]),_:1},8,["onClick"])]),d(_,{data:e.apiDocTree,class:"bg-transparent","node-key":"id","empty-text":"",draggable:"",ref:"treeIns","expand-on-click-node":!1,props:{children:"sub_nodes",label:"title",class:e.customNodeClass,isLeaf:e.customNodeLeaf},"allow-drop":e.allowDrop,onNodeDragStart:e.onMoveNodeStart,onNodeDrop:e.onMoveNode},{default:m(({node:u,data:h})=>[Vc,a("div",{class:$(["flex justify-between ac-tree-node",{"is-editable":h.isEditable}])},[a("div",{class:"ac-tree-node__main",onClick:g=>e.handleTreeNodeClick(u,h,g)},[a("div",{class:$(["ac-doc-node",{"is-active":h.isCurrent}])},[h.isLeaf?(p(),y("img",{key:0,class:"ac-doc-node__icon",src:e.createDocIcon},null,8,Gc)):T("",!0),W(a("span",{class:"ac-doc-node__label",title:h.title},F(h.title),9,Yc),[[oe,!h.isEditable]]),h.isEditable?W((p(),y("input",{key:1,type:"text",ref:"renameInput",class:"ac-doc-node__input el-input el-input__inner",id:"tree_input_"+h.id,"onUpdate:modelValue":g=>h.title=g,onKeyup:t[0]||(t[0]=eo((...g)=>e.onEnterKeyUp&&e.onEnterKeyUp(...g),["enter"])),maxlength:h.isLeaf?255:50,onBlur:g=>e.setUnEditable(g,h)},null,40,zc)),[[Xt,h.title]]):T("",!0)],2)],8,Uc),a("div",{class:$(["ac-tree-node__more",{active:h.id===e.activeMoreNodeId}])},[W(d(c,{onClick:g=>e.onMoreIconClick(g,u,h,"DIR_NEW_TYPE")},{default:m(()=>[d(i)]),_:2},1032,["onClick"]),[[oe,!h.isLeaf]]),Hc,W(d(c,{onClick:g=>e.onMoreIconClick(g,u,h,"DIR_OPERATE_TYPE")},{default:m(()=>[d(l)]),_:2},1032,["onClick"]),[[oe,!h.isLeaf]]),W(d(c,{onClick:g=>e.onMoreIconClick(g,u,h,"DOC_OPERATE_TYPE")},{default:m(()=>[d(l)]),_:2},1032,["onClick"]),[[oe,h.isLeaf]])],2)],2)]),_:1},8,["data","props","allow-drop","onNodeDragStart","onNodeDrop"])],512),d(C,{ref:"documentShareModal","share-data":e.shareData},null,8,["share-data"])],64)}var Wc=H($c,[["render",Jc]]);const Zc=(e={})=>At.post("/upload_path",e),_t={},ud=e=>new Promise((t,o)=>{const s={complete:!1,width:0,height:0,src:e};if(!e){o(s);return}if(_t[e]){t(B({},_t[e]));return}const n=new Image;n.onload=()=>{s.width=n.width,s.height=n.height,s.complete=!0,_t[e]=B({},s),t(s)},n.onerror=()=>{o(s)},n.src=e});function se(){this.chunkSize=1024*1024,this.threadsQuantity=2,this.timeout=1e3*10,this.file=null,this.aborted=!1,this.uploadedSize=0,this.progressCache={},this.activeConnections={},this.taskConfig={}}se.prototype.setOptions=function(e={}){this.chunkSize=e.chunkSize||this.chunkSize,this.threadsQuantity=e.threadsQuantity||this.threadsQuantity};se.prototype.setupFile=function(e){!e||(this.file=e)};se.prototype.start=function(){if(!this.file)throw new Error("Can't start uploading: file have not chosen");const e=Math.ceil(this.file.size/this.chunkSize);this.chunksQueue=new Array(e).fill().map((s,n)=>n).reverse();const t=new XMLHttpRequest;t.timeout=this.timeout,t.open("post","/api/upload_init"),t.setRequestHeader("Content-Type","application/json;charset=UTF-8"),t.setRequestHeader("Accept","application/json, text/plain, */*");let o=j.get(j.KEYS.TOKEN)||"";o&&t.setRequestHeader("Authorization",o),t.withCredentials=!0,t.onreadystatechange=()=>{if(t.readyState===XMLHttpRequest.DONE&&t.status===200){const{status:s,msg:n,data:r}=JSON.parse(t.responseText);if(s!==0){this.complete(new Error(n||"\u4E0A\u4F20\u521D\u59CB\u5316\u5931\u8D25\uFF01"));return}this.fileId=r.file_id,this.sendNext()}},t.onerror=s=>{this.complete(s)},t.ontimeout=s=>{this.complete(s)},t.send(JSON.stringify({name:this.file.name,chunks:e,fileSize:Math.ceil(this.file.size/1024)}))};se.prototype.sendNext=function(){const e=Object.keys(this.activeConnections).length;let t=!1;if(Object.keys(this.taskConfig).forEach(r=>{this.taskConfig[r].retryCount>=3&&(t=!0)}),t){this.complete(new Error("\u4E0A\u4F20\u5931\u8D25\uFF01"));return}if(e>=this.threadsQuantity)return;if(!this.chunksQueue.length){e||this.getResult();return}const o=this.chunksQueue.pop(),s=o*this.chunkSize,n=this.file.slice(s,s+this.chunkSize);this.sendChunk(n,o).then(()=>this.sendNext()).catch(r=>{this.chunksQueue.push(o);let i=this.taskConfig[o];i&&i.retryCount<=3?this.sendNext():this.complete(r)}),this.sendNext()};se.prototype.complete=function(e){const t=e&&e.message||e;if(e&&!this.aborted){this.end(t);return}this.end(t)};se.prototype.sendChunk=function(e,t){return this.upload(t,e)};se.prototype.handleProgress=function(e,t){(t.type==="progress"||t.type==="error"||t.type==="abort")&&(this.progressCache[e]=t.loaded),t.type==="loadend"&&(this.uploadedSize+=this.progressCache[e]||0,delete this.progressCache[e]);const o=Object.keys(this.progressCache).reduce((n,r)=>n+=this.progressCache[r],0),s=Math.min(this.uploadedSize+o,this.file.size);this.onProgress&&this.onProgress({loaded:s,total:this.file.size})};se.prototype.upload=function(e,t){return new Promise((o,s)=>{let n=this.taskConfig[e]=this.taskConfig[e]||{retryCount:0};const r=this.activeConnections[e]=new XMLHttpRequest;r.timeout=this.timeout;const i=this.handleProgress.bind(this,e);r.upload.addEventListener("progress",i),r.addEventListener("error",i),r.addEventListener("abort",i),r.addEventListener("loadend",i),r.open("post","/api/upload_save"),r.setRequestHeader("Accept","application/json, text/plain, */*");let c=j.get(j.KEYS.TOKEN)||"";c&&r.setRequestHeader("Authorization",c),r.onreadystatechange=()=>{if(delete this.activeConnections[e],r.readyState===XMLHttpRequest.DONE&&r.status===200){const _=JSON.parse(r.responseText);if(_.status!==0){s(new Error(_.msg||"\u4E0A\u4F20\u5931\u8D25\uFF01")),n.retryCount++;return}_.status===0&&o(_)}r.readyState===XMLHttpRequest.DONE&&r.status!==200&&(s(new Error("\u4E0A\u4F20\u5931\u8D25\uFF01")),n.retryCount++)},r.onerror=_=>{s(_),delete this.activeConnections[e]},r.onabort=()=>{s(new Error("\u53D6\u6D88\u4E0A\u4F20\uFF01")),delete this.activeConnections[e]},r.ontimeout=_=>{s(_),delete this.activeConnections[e]};let l=new FormData;l.append("file_id",this.fileId),l.append("chunk_id",e),l.append("file",t),r.send(l)})};se.prototype.on=function(e,t){typeof t!="function"&&(t=Le),this[e]=t};se.prototype.abort=function(){Object.keys(this.activeConnections).forEach(e=>{this.activeConnections[e].abort()}),this.aborted=!0};se.prototype.getResult=function(){Zc({file_id:this.fileId}).then(e=>this.end(null,e)).catch(e=>this.complete(e))};const qc=function(){const e=new se;return{options:function(t){return e.setOptions(t),this},send:function(t){return e.setupFile(t),this},continue:function(){e.sendNext()},onProgress:function(t){return e.on("onProgress",t||Le),this},end:function(t){return e.on("end",t||Le),e.start(),this},abort:function(){e.abort()}}};const Qc={props:{maxSize:{type:Number,default:1},multiple:{type:Boolean,default:!1}},data(){return{isShow:!1,isLoading:!1,isPoll:!1,title:"\u5BFC\u5165\u6587\u6863",params:{},jobParams:{id:null},importList:[],currentConfig:null,timer:null}},methods:{projectItemClass(e){return["ac-project-export-item","ac-project-export-file",{disabled:e.disabled}]},hide(){this.isShow=!1},show(e,t){this.clearTimer(),this.isShow=!0,this.importList=t||[],this.params=e||{}},onFileChange(e,t){this.currentConfig=t||{},this.validFile(e)&&this.upload()},validFile(e){const t=e.target.files;if(!t)return!1;let o=Array.prototype.slice.call(t);if(this.multiple||(o=o.slice(0,1)),o.length===0)return!1;let s=o[0];e.target.value=null;let{maxSize:n}=this.currentConfig;return n=n||this.maxSize,s.size>n*1024*1024?(this.$Message.error(`\u6587\u4EF6\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC7${n}MB`),!1):(this.currentConfig.file=s,!0)},upload(){if(!this.currentConfig||!this.currentConfig.file)return this.$Message.error("\u672A\u9009\u62E9\u6587\u4EF6\uFF01");this.isLoading=!0,qc().options().send(this.currentConfig.file).end((e,t)=>{if(e){this.isLoading=!1,this.$Message.error(e instanceof Error?e.message:e);return}this.currentConfig.fileUrl=t.data,this.getImportJobId(this.buildParams())})},getImportJobId(e){if(!this.currentConfig||!this.currentConfig.action)return this.isLoading=!1,Promise.resolve();this.currentConfig.action(e).then(t=>{this.jobParams.id=t.data||null,this.isPoll=!0,this.getExecResult()}).catch(()=>{this.isLoading=!1})},clearTimer(){this.currentConfig=null,this.isLoading=!1,this.isPoll=!1},async exec(){if(!this.currentConfig||!this.currentConfig.getJobResult||!this.jobParams.id)return this.clearTimer(),Promise.resolve();try{const{data:e,msg:t}=await this.currentConfig.getJobResult(this.params.project_id,this.jobParams.id);if(e.result===De.FAIL){this.$Message.error(t||"\u5BFC\u5165\u5931\u8D25\uFF01"),this.clearTimer();return}if(e.result===De.WAIT)return;e.result===De.FINISH&&(this.$Message.success(t||"\u5BFC\u5165\u5B8C\u6210\uFF01"),this.clearTimer(),this.hide(),location.reload())}catch{this.clearTimer()}},async getExecResult(){for(;this.isPoll;)await this.exec(),await Zt(2e3)},buildParams(){return this.currentConfig?_e(B({},this.params),{filename:this.currentConfig.file?this.currentConfig.file.name:"\u672A\u547D\u540D",file:this.currentConfig.fileUrl,type:this.currentConfig.type}):{}}}},Xc={class:"ac-project-export","element-loading-text":"\u5BFC\u5165\u4E2D\uFF0C\u8BF7\u52FF\u5173\u95ED\u7A97\u53E3\uFF01"},el={class:"ac-project-export-inner"},tl=["src","alt"],ol={class:"mt-1.5"},sl=["onChange","accept"];function nl(e,t,o,s,n,r){const i=Be,c=it;return p(),G(i,{modelValue:n.isShow,"onUpdate:modelValue":t[0]||(t[0]=l=>n.isShow=l),width:"fit-content","custom-class":"vertical-center-modal","close-on-click-modal":!1,title:n.title,"append-to-body":""},{default:m(()=>[W((p(),y("div",Xc,[(p(!0),y(U,null,X(n.importList,l=>(p(),y("div",{class:$(r.projectItemClass(l)),key:l.type},[a("div",el,[a("img",{src:l.icon,alt:l.text},null,8,tl),a("p",ol,F(l.text),1),a("input",{type:"file",onChange:_=>r.onFileChange(_,l),accept:l.accept},null,40,sl)])],2))),128))])),[[c,n.isLoading]])]),_:1},8,["modelValue","title"])}var rl=H(Qc,[["render",nl],["__scopeId","data-v-d927ecec"]]);const il={class:"ac-doc-layout"},al={class:"ac-doc-layout--left"},cl={class:"ac-doc-layout--right"},ll=a("div",{class:"ac-doc-layout__gap"},null,-1),dl=Q({setup(e){const t=I(),o=I(),s=I();return le("projectExportModal",t),le("documentImportModal",o),le("updateTreeNode",(n,r)=>s.value&&s.value.updateTreeNode(n,r)),(n,r)=>{const i=Z("router-view"),c=hi;return p(),y(U,null,[d(Ka),a("main",il,[a("div",al,[d(Wc,{ref_key:"directoryTree",ref:s},null,512)]),a("div",cl,[ll,d(i)])]),d(c,{ref_key:"projectExportModal",ref:t},null,512),d(rl,{ref_key:"documentImportModal",ref:o},null,512)],64)}}}),ul=()=>Y(()=>import("./DocumentDetail.5debfafc.js"),["assets/DocumentDetail.5debfafc.js","assets/element-plus.33434d3d.js","assets/element-plus.07fbf481.css","assets/vendor.1b70e788.js","assets/useHighlight.f09c3d66.js"]),hl=()=>Y(()=>import("./DocumentEditor.dd28c2a0.js"),["assets/DocumentEditor.dd28c2a0.js","assets/element-plus.33434d3d.js","assets/element-plus.07fbf481.css","assets/vendor.1b70e788.js","assets/params.0b3617b4.js"]),Ro="/editor/:project_id/doc/:node_id?",pl=bt(Ro);var fl={path:"/editor",name:co,component:dl,redirect:{name:"document.api.detail"},children:[{path:Ro,name:"document.api.detail",component:ul},{path:"/editor/:project_id/doc/:node_id/edit",name:"document.api.edit",component:hl}]};function ml(e){e.beforeEach(async(t,o,s)=>{const r=Ae().isLogin;if(t.meta.ignoreAuth){if(r&&(t.path===Te||t.path===Rt)){s(Lt);return}s();return}if(!r){s({path:Te,replace:!0});return}s()})}function _l(e){e.beforeEach(async(t,o,s)=>{const n=Mt();if(!t.matched.find(i=>i.name===co))return s();const r=parseInt(t.params.project_id,10);if(n.projectInfo&&n.projectInfo.id===r)return s();try{if(Xe(),await n.getProjectDetail(r),n.isReader)return Ce(),s(re)}catch{return Ce(),s(re)}return s()})}const Lo=Pe({id:"preview",state:()=>({projectInfo:null,documentInfo:null}),getters:{},actions:{async getProjectInfo(e){const{data:t}=await wi(e);return this.projectInfo=t||null,this.projectInfo},async getDocumentInfo(e){const t=j.get(j.KEYS.SECRET_DOCUMENT_TOKEN+e,!0)||"",{data:o}=await ki(t,e);return this.documentInfo=o||null,this.documentInfo},goVerificationPage(){const e=pe.currentRoute.value.params.project_id||"",t=pe.currentRoute.value.params.doc_id||"",o=pe.currentRoute.value.name||"";if(o.includes(Oe)){j.remove(j.KEYS.SECRET_PROJECT_TOKEN+e,!0),pe.push({name:qe,params:{project_id:e}});return}o.includes(Me)&&(j.remove(j.KEYS.SECRET_DOCUMENT_TOKEN+t,!0),pe.push({name:Qe,params:{document_id:t}}))}}});function gl(e){e.beforeEach(async(t,o,s)=>{const n=Lo(),{isLogin:r}=Ae(),{projectInfo:i}=ke(n),{name:c,params:l}=t,_=!!j.get(j.KEYS.SECRET_PROJECT_TOKEN+l.project_id,!0),C=!!j.get(j.KEYS.SECRET_DOCUMENT_TOKEN+l.doc_id,!0);if(String(c).startsWith(Oe)){if(!i.value)try{Xe();const f=await n.getProjectInfo(l.project_id);if(!f||!f.id)return Ce(),s(re)}catch{return Ce(),s(re)}const{has_shared:u,visibility:h,in_this:g}=i.value||{};if(h){s();return}if(r&&g){s();return}if(!h&&!r&&!u){s(re);return}if(!h&&!u&&r&&!g){s(re);return}if(!h&&!u&&r&&g){s();return}if(c===qe){s();return}if(!h&&u&&!_){s({name:qe,params:{project_id:l.project_id}});return}if(!h&&u&&_){s();return}s(re);return}if(String(c).startsWith(Me)){if(c===Qe){s();return}if(!C){s({name:Qe,params:{doc_id:l.doc_id}});return}Xe();try{const u=await n.getDocumentInfo(l.doc_id);return!u||!u.id?s(re):s()}catch{}finally{Ce()}s(re);return}s()})}function vl(e){e.beforeEach(async(t,o,s)=>{const n=Mt();if(!Ht.some(i=>i.name===t.name)||n.projectInfo&&t.params.project_id===String(n.projectInfo.id))return s();let r=null;Xe();try{const i=await n.getProjectDetail(parseInt(t.params.project_id));Ht.filter(_=>_.meta.role.indexOf(i.authority)!==-1).some(_=>_.name===t.name)||(r=re)}catch{r=re}finally{Ce()}return r?s(r):s()})}const yl=e=>{ml(e),_l(e),vl(e),gl(e)},pe=ns({history:rs("/"),routes:[cr,lr,dr,{path:Lt,name:"main",component:Nn,redirect:{name:"projects"},children:[Xr,Er,wr,ri]},fl,Zi,Wi,qi,ur]});var Al=e=>{e.use(de),e.use(Pt),e.use(Br),e.use(ao),e.config.globalProperties.$Message=de};const Cl=function(e){e.mixin({mounted:function(){e.__clipboard__&&e.__clipboard__.destroy(),e.__clipboard__=new is(".copy_text",{text:function(t){return Qt(t.getAttribute("data-text")||t.innerText||"")}}),e.__clipboard__.on("success",()=>{de.closeAll(),de.success("\u590D\u5236\u6210\u529F")})}})};var El={install:Cl};class kl{constructor(){this._pendingMap=new Map}gatherKey(t){return[t.url,t.method,JSON.stringify(t.params)].join("_")}add(t){this.remove(t);const o=ot.CancelToken.source();t.cancelToken=t.cancelToken||o.token;const s=this.gatherKey(t);this._pendingMap.set(s,o.cancel)}remove(t){const o=this.gatherKey(t);if(this._pendingMap.has(o)){const s=this._pendingMap.get(o);s&&Gt(s)&&s(),this._pendingMap.delete(o)}}removeAll(){this._pendingMap.forEach(t=>t&&Gt(t)&&t()),this.clear()}clear(){this._pendingMap.clear()}}const He=new kl,wl=()=>{A.interceptors.request.use(e=>{He.add(e);const t=Ae().token;return t&&(e.headers=_e(B({},e.headers),{Authorization:t})),e}),A.interceptors.response.use(e=>{He.remove(e.config);let t="";!e.data&&(e.data={});const o=e.data.status;switch(e.headers.authorization&&Ae().updateToken(e.headers.authorization),o){case be.NO_LOGIN:t="\u767B\u5F55\u72B6\u6001\u5DF2\u5931\u6548\uFF0C\u8BF7\u91CD\u65B0\u767B\u5F55",He.removeAll(),Ae().logout();break;case be.INVALID_PREVIEW_SECRET:t=e.data.msg||"\u8BBF\u95EE\u79D8\u94A5\u5DF2\u5931\u6548\u3002",He.removeAll(),Lo().goVerificationPage();break;case be.OK:case be.NO_PARENT_DIR:case be.NOT_FOUND:break;default:t=e.data.msg||"\u6570\u636E\u5F02\u5E38\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5\uFF01";break}return t?Promise.reject({message:t}):e.data}),A.interceptors.response.use(void 0,e=>{var r,i;let t="";const{code:o,message:s}=e||{},n=(i=(r=e==null?void 0:e.toString)==null?void 0:r.call(e))!=null?i:"";return t=s,o==="ECONNABORTED"&&t.indexOf("timeout")!==-1&&(t="\u8BF7\u6C42\u8D85\u65F6\uFF0C\u8BF7\u91CD\u8BD5"),n!=null&&n.includes("Network Error")&&(t="\u7F51\u7EDC\u5F02\u5E38\uFF0C\u8BF7\u91CD\u8BD5"),de.closeAll(),t&&de.error(t),Promise.reject(e)}),At.interceptors.request.use(e=>{const t=Ae().token;return t&&(e.headers=_e(B({},e.headers),{Authorization:t})),e}),At.interceptors.response.use(e=>{let t;switch(!e.data&&(e.data={}),e.data.status){case 0:break;default:t=e.data.msg||"\u6570\u636E\u5F02\u5E38\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5\uFF01";break}return t?Promise.reject(t):e.data},e=>(e.message.indexOf("timeout")!==-1&&de.error("\u8BF7\u6C42\u8D85\u65F6\uFF0C\u8BF7\u91CD\u8BD5\uFF01"),Promise.reject(e)))};wl();const Ve=as(Ms);Ve.use(cs());Ve.use(pe);Ve.use(El);yl(pe);Al(Ve);Ve.mount("#app");export{Ot as $,A,Yl as B,Sl as C,ye as D,Hl as E,zl as F,Jl as G,Gl as H,Xl as I,Pl as J,Wl as K,Te as L,dd as M,be as N,Ql as O,Dl as P,Ol as Q,Rt as R,_o as S,Vs as T,rd as U,Ll as V,Rl as W,jl as X,Tl as Y,_a as Z,Fe as _,Ae as a,cd as a0,Ce as a1,ra as a2,Ei as a3,Y as a4,qc as a5,ud as a6,id as a7,ad as a8,ld as a9,ua as aa,j as ab,Lo as ac,od as ad,nd as ae,Xe as af,sd as ag,ed as ah,td as ai,ho as aj,Hs as ak,H as b,Ie as c,Ao as d,xl as e,vo as f,Kl as g,Fl as h,Ml as i,ql as j,Ge as k,hi as l,Bl as m,Ai as n,Us as o,Vl as p,Ul as q,bo as r,$l as s,Zl as t,Bs as u,pl as v,ne as w,Ji as x,Mt as y,Ht as z};
