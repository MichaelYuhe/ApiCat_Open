var F=Object.defineProperty;var S=Object.getOwnPropertySymbols;var I=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable;var V=(t,e,n)=>e in t?F(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,v=(t,e)=>{for(var n in e||(e={}))I.call(e,n)&&V(t,n,e[n]);if(S)for(var n of S(e))O.call(e,n)&&V(t,n,e[n]);return t};import{g as R,I as U,J as q,h as D,i as z,j as K,z as N,f as L,E as Y,K as H,L as G,H as J,v as W}from"./element-plus.0e86e7ab.js";import{u as X,a as Z,d as Q,g as $}from"./params.78b59d30.js";import{bs as B,br as ee,bh as x,au as te,o as w,W as k,X as a,Z as s,R as P,f as oe,an as se,U as le,av as ae,ai as f,G as ne,r as E,aT as ie,t as re,h as b,$ as ue}from"./vendor.da18d6a7.js";import{b as de,z as A,d as me}from"./index.c9e71ecd.js";const j={name:"",type:B.TYPES[0].value,is_must:!0,default_value:"",description:""},pe={emits:["on-ok"],directives:{param:{bind:function(t){let e=t.querySelector("input");e.removeEventListener("input",t.handler),t.handler=function(n){n.preventDefault();for(var c=new RegExp("[`~!#%^&*()=|{}':;',<>/?~\uFF01#\uFFE5\u2026\u2026&*\uFF08\uFF09|{}\u3010\u3011\u2018\uFF1B\uFF1A\u201D\u201C'\u3002\uFF0C\u3001\uFF1F]"),o="",r=0;r<this.value.length;r++)o=o+this.value.substr(r,1).replace(c,"");this.value=o.replace(/[^\w\.@$-\[\]]/gi,"")},e.addEventListener("input",t.handler)},unbind:function(t){t.querySelector("input").removeEventListener("input",t.handler)}}},data(){return{isShow:!1,isEdit:!1,isLoading:!1,types:B.TYPES,form:v({},j),rules:{name:{required:!0,message:"\u8BF7\u8F93\u5165\u53C2\u6570\u540D\u79F0",trigger:"blur"}}}},computed:v({},ee(A,{project:"projectInfo"})),watch:{isShow:function(){!this.isShow&&this.reset()}},methods:{onChange(t){this.form.name=t.target.value},show(t={}){!x(t)&&(this.form=t),this.isEdit=!x(t),this.isShow=!0},hide(){this.isShow=!1,this.reset(),this.form.name=""},onCloseBtnClick(){this.isShow=!1,this.reset()},reset(){this.form=v({},j),this.$refs.form.resetFields()},handleSubmit(t){this.$refs[t].validate(e=>e&&this.submit())},submit(){this.isLoading=!0;let t=this.isEdit?X:Z;this.form.project_id=this.project.id,this.form.param_id=this.form.id||"",t(this.form).then(e=>{this.$Message.success(e.msg||(this.isEdit?"\u4FEE\u6539\u6210\u529F!":"\u6DFB\u52A0\u6210\u529F!")),this.onCloseBtnClick(),this.$emit("on-ok")}).catch(e=>{}).finally(()=>{this.isLoading=!1})}}},ce=f("\u662F\u5426\u5FC5\u9009"),fe=f("\u53D6\u6D88"),_e=f("\u786E\u5B9A");function he(t,e,n,c,o,r){const _=K,m=R,y=U,h=q,i=N,u=D,p=L,d=z,C=te("param");return w(),k(d,{modelValue:o.isShow,"onUpdate:modelValue":e[8]||(e[8]=l=>o.isShow=l),width:400,"close-on-click-modal":!1,"append-to-body":"","custom-class":"show-footer-line vertical-center-modal",title:(o.isEdit?"\u7F16\u8F91":"\u6DFB\u52A0")+"\u53C2\u6570"},{footer:a(()=>[s(p,{onClick:e[6]||(e[6]=l=>r.onCloseBtnClick())},{default:a(()=>[fe]),_:1}),s(p,{loading:o.isLoading,type:"primary",onClick:e[7]||(e[7]=l=>r.handleSubmit("form"))},{default:a(()=>[_e]),_:1},8,["loading"])]),default:a(()=>[s(u,{onKeyup:e[5]||(e[5]=ae(l=>r.handleSubmit("form"),["enter"])),ref:"form",model:o.form,rules:o.rules,"label-position":"top"},{default:a(()=>[s(m,{label:"\u53C2\u6570\u540D\u79F0",prop:"name",class:"hide_required"},{default:a(()=>[P(s(_,{onOnChange:r.onChange,modelValue:o.form.name,"onUpdate:modelValue":e[0]||(e[0]=l=>o.form.name=l),placeholder:"\u53C2\u6570\u540D\u79F0",maxlength:"100"},null,8,["onOnChange","modelValue"]),[[C]])]),_:1}),s(m,{label:"\u53C2\u6570\u7C7B\u578B",prop:"type"},{default:a(()=>[s(h,{modelValue:o.form.type,"onUpdate:modelValue":e[1]||(e[1]=l=>o.form.type=l),placeholder:"\u53C2\u6570\u7C7B\u578B",class:"w-full"},{default:a(()=>[(w(!0),oe(le,null,se(o.types,l=>(w(),k(y,{value:l.value,key:l.value,label:l.text},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),s(m,{label:"",prop:"is_must"},{default:a(()=>[s(i,{modelValue:o.form.is_must,"onUpdate:modelValue":e[2]||(e[2]=l=>o.form.is_must=l)},{default:a(()=>[ce]),_:1},8,["modelValue"])]),_:1}),s(m,{label:"\u9ED8\u8BA4\u503C",prop:"default_value",class:"hide_required"},{default:a(()=>[s(_,{modelValue:o.form.default_value,"onUpdate:modelValue":e[3]||(e[3]=l=>o.form.default_value=l),placeholder:"\u9ED8\u8BA4\u503C",maxlength:"255"},null,8,["modelValue"])]),_:1}),s(m,{label:"\u53C2\u6570\u8BF4\u660E",prop:"description",class:"hide_required"},{default:a(()=>[s(_,{modelValue:o.form.description,"onUpdate:modelValue":e[4]||(e[4]=l=>o.form.description=l),placeholder:"\u53C2\u6570\u540D\u79F0",type:"textarea",autosize:{minRows:4,maxRows:4},maxlength:"255"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}var ve=de(pe,[["render",he]]);const be=b("span",{innerHTML:"\xA0"},null,-1),ge={class:"absolute right-2",style:{top:"7px"}},we=f("\u6DFB\u52A0\u53C2\u6570"),ye=["onClick"],Ce=["onClick"];var je=ne({setup(t){const e=E(),n=E([]),c=E(!1),o=A(),{projectInfo:r}=ie(o),_=()=>{var i;(i=e.value)==null||i.show()},m=i=>{var u;(u=e.value)==null||u.show(v({},i))},y=i=>{me({title:"\u5220\u9664\u63D0\u793A",content:s("div",{class:"truncate"},[f("\u786E\u5B9A\u5220\u9664\u53C2\u6570\u300C"),i.name,f("\u300D\u5417\uFF1F")]),onOk:()=>Q(o.projectInfo.id,i.id).then(u=>{Y.success(u.msg||"\u5220\u9664\u6210\u529F\uFF01"),h()})})},h=async()=>{c.value=!0;try{const{data:i}=await $(o.projectInfo.id);let u=i.map||{};const p=[];Object.keys(u).forEach(d=>{u[d]&&p.push(u[d])}),n.value=p}catch{}finally{c.value=!1}};return re(()=>r.value,async()=>{r.value&&r.value.id&&await h()},{immediate:!0}),(i,u)=>{const p=L,d=H,C=G,l=J,M=W;return P((w(),k(l,{shadow:"never","body-style":{padding:0}},{header:a(()=>[be,b("div",ge,[s(p,{type:"primary",onClick:_},{default:a(()=>[we]),_:1})])]),default:a(()=>[s(C,{data:n.value,"empty-text":"\u6682\u65E0\u6570\u636E"},{default:a(()=>[s(d,{prop:"name",label:"\u53C2\u6570\u540D\u79F0","show-overflow-tooltip":""}),s(d,{prop:"type_name",label:"\u53C2\u6570\u7C7B\u578B",width:"120"}),s(d,{prop:"is_must",label:"\u5FC5\u4F20",width:"70"},{default:a(g=>[b("span",null,ue(g.is_must?"\u662F":"\u5426"),1)]),_:1}),s(d,{prop:"default_value",label:"\u9ED8\u8BA4\u503C",width:"100","show-overflow-tooltip":""}),s(d,{prop:"description",label:"\u53C2\u6570\u8BF4\u660E","show-overflow-tooltip":""}),s(d,{label:"\u64CD\u4F5C",width:"120"},{default:a(({row:g})=>[b("span",{class:"cursor-pointer mr-3 text-blue-600",onClick:T=>m(g)},"\u7F16\u8F91",8,ye),b("span",{class:"cursor-pointer mr-3 text-red-400",onClick:T=>y(g)},"\u5220\u9664",8,Ce)]),_:1})]),_:1},8,["data"]),s(ve,{ref_key:"modifyModal",ref:e,onOnOk:h},null,512)]),_:1})),[[M,c.value]])}}});export{je as default};
