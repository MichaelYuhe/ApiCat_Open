var F=Object.defineProperty,O=Object.defineProperties;var L=Object.getOwnPropertyDescriptors;var b=Object.getOwnPropertySymbols;var T=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable;var v=(e,o,n)=>o in e?F(e,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[o]=n,r=(e,o)=>{for(var n in o||(o={}))T.call(o,n)&&v(e,n,o[n]);if(b)for(var n of b(o))R.call(o,n)&&v(e,n,o[n]);return e},u=(e,o)=>O(e,L(o));import{_ as S,a as N}from"./ImagePreview.d5609f35.js";import{O as A,z as B,P as D,a as $,Q as q,R as z,e as J,f as M,h as Y,g as Z,i as G,I as Q}from"./element-plus.33434d3d.js";import{b as W,y as k,g as H,e as K}from"./index.edf0554f.js";import{a3 as X,v as x,aj as ee,aZ as oe,a1 as p,o as ne,e as te,Y as t,W as l,Z as le,T as ae,f as se,ab as d}from"./vendor.1b70e788.js";var m="/assets/icon-project.e0f48f4a.png";const ie={setup(){const e=k(),o=X({PROJECT_DEFAULT_ICON:m,isLoading:!1,imgUrl:null,file:null,disableType:!1,form:{icon_link:m,name:"",visibility:0,description:""},rules:{name:[{required:!0,message:"\u8BF7\u8F93\u5165\u9879\u76EE\u540D\u79F0",trigger:"blur"},{min:2,message:"\u9879\u76EE\u540D\u79F0\u4E0D\u80FD\u5C11\u4E8E\u4E24\u4E2A\u5B57",trigger:"blur"}]}});return x(()=>e.projectInfo,()=>{const n=e.projectInfo||{};o.form=u(r({},n),{icon_link:n.icon||m})},{immediate:!0}),r({},ee(o))},components:{Lock:A,View:B,Upload:D},methods:u(r({},oe(k,["updateProjectInfo"])),{handleUpload(e){return e.append("icon",this.file),H(e)},reset(){this.$refs.projectForm.resetFields(),this.form={icon_link:m,name:"",type:K.API.value,visibility:0,description:""}},onImageUpload(e,o){this.imgUrl=e,this.file=o},onProjectIconUploadSuccess(e){this.form.icon_link=e},handleSubmit(e){this.$refs[e].validate(o=>{if(o){this.isLoading=!0;const n={};n.project_id=this.form.id,n.icon_link=this.form.icon_link,n.icon=this.form.icon_link,n.name=this.form.name,n.visibility=this.form.visibility,n.description=this.form.description,this.updateProjectInfo(n).then(_=>{this.$message.success(_.msg||"\u9879\u76EE\u4FEE\u6539\u6210\u529F\uFF01")}).finally(()=>{this.isLoading=!1})}})}}),emits:["on-ok"]},re=se("span",null,"\u9879\u76EE\u8BBE\u7F6E",-1),me=d("\u4E0A\u4F20\u65B0\u56FE\u6807 "),de=d("\u79C1\u6709 "),ce=d("\u516C\u5F00 "),ue=d("\u4FDD\u5B58");function pe(e,o,n,_,_e,s){const I=$,U=p("Upload"),c=J,f=M,j=S,i=Y,h=Z,E=p("Lock"),g=q,V=p("View"),P=z,w=G,y=Q,C=N;return ne(),te(ae,null,[t(y,{shadow:"never"},{header:l(()=>[re]),default:l(()=>[t(w,{ref:"projectForm",model:e.form,rules:e.rules,"label-position":"top",class:"py-2 pl-2 max-w-sm",onSubmit:o[4]||(o[4]=le(a=>s.handleSubmit("projectForm"),["prevent"]))},{default:l(()=>[t(i,{label:""},{default:l(()=>[t(I,{class:"mr-7",shape:"square",size:60,src:e.form.icon_link?e.form.icon_link:e.PROJECT_DEFAULT_ICON},null,8,["src"]),t(j,{onDone:s.onImageUpload},{default:l(()=>[t(f,null,{default:l(()=>[t(c,null,{default:l(()=>[t(U)]),_:1}),me]),_:1})]),_:1},8,["onDone"])]),_:1}),t(i,{label:"\u9879\u76EE\u540D\u79F0",prop:"name",class:"hide_required"},{default:l(()=>[t(h,{modelValue:e.form.name,"onUpdate:modelValue":o[0]||(o[0]=a=>e.form.name=a),placeholder:"\u9879\u76EE\u540D\u79F0",maxlength:"255"},null,8,["modelValue"])]),_:1}),t(i,{label:"\u6743\u9650"},{default:l(()=>[t(P,{modelValue:e.form.visibility,"onUpdate:modelValue":o[1]||(o[1]=a=>e.form.visibility=a)},{default:l(()=>[t(g,{label:0},{default:l(()=>[t(c,{class:"mr-1"},{default:l(()=>[t(E)]),_:1}),de]),_:1}),t(g,{label:1},{default:l(()=>[t(c,{class:"mr-1"},{default:l(()=>[t(V)]),_:1}),ce]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(i,{label:"\u9879\u76EE\u63CF\u8FF0"},{default:l(()=>[t(h,{modelValue:e.form.description,"onUpdate:modelValue":o[2]||(o[2]=a=>e.form.description=a),type:"textarea",autosize:{minRows:4,maxRows:4},maxlength:"255"},null,8,["modelValue"])]),_:1}),t(f,{onClick:o[3]||(o[3]=a=>s.handleSubmit("projectForm")),loading:e.isLoading},{default:l(()=>[ue]),_:1},8,["loading"])]),_:1},8,["model","rules"])]),_:1}),t(C,{"img-url":e.imgUrl,file:e.file,onOnOk:s.onProjectIconUploadSuccess,"handle-upload":s.handleUpload},null,8,["img-url","file","onOnOk","handle-upload"])],64)}var ke=W(ie,[["render",pe]]);export{ke as default};
