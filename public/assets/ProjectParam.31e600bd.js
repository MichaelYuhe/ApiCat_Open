var F=Object.defineProperty;var x=Object.getOwnPropertySymbols;var I=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable;var S=(t,e,n)=>e in t?F(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,v=(t,e)=>{for(var n in e||(e={}))I.call(e,n)&&S(t,n,e[n]);if(x)for(var n of x(e))O.call(e,n)&&S(t,n,e[n]);return t};import{a as q,I as D,J as R,b as U,c as K,d as N,z as Y,e as j,E as z,K as H,L as J,H as W,v as Z}from"./element-plus.aa12b6bd.js";import{u as G,a as Q,d as X,g as $}from"./params.b7b3bcd7.js";import{bB as L,bz as ee,bp as V,aN as te,o as w,Y as k,Z as a,$ as l,T as P,h as oe,at as le,W as se,aA as ae,ak as f,K as ne,r as E,a$ as ie,x as re,j as b,a1 as ue}from"./vendor.b7ec7f69.js";import{c as de,B as A,e as me}from"./index.6e925652.js";const B={name:"",type:L.TYPES[0].value,is_must:!0,default_value:"",description:""},pe={emits:["on-ok"],directives:{param:{bind:function(t){let e=t.querySelector("input");e.removeEventListener("input",t.handler),t.handler=function(n){n.preventDefault();for(var c=new RegExp("[`~!#%^&*()=|{}':;',<>/?~\uFF01#\uFFE5\u2026\u2026&*\uFF08\uFF09|{}\u3010\u3011\u2018\uFF1B\uFF1A\u201D\u201C'\u3002\uFF0C\u3001\uFF1F]"),o="",r=0;r<this.value.length;r++)o=o+this.value.substr(r,1).replace(c,"");this.value=o.replace(/[^\w\.@$-\[\]]/gi,"")},e.addEventListener("input",t.handler)},unbind:function(t){t.querySelector("input").removeEventListener("input",t.handler)}}},data(){return{isShow:!1,isEdit:!1,isLoading:!1,types:L.TYPES,form:v({},B),rules:{name:{required:!0,message:"\u8BF7\u8F93\u5165\u53C2\u6570\u540D\u79F0",trigger:"blur"}}}},computed:v({},ee(A,{project:"projectInfo"})),watch:{isShow:function(){!this.isShow&&this.reset()}},methods:{onChange(t){this.form.name=t.target.value},show(t={}){!V(t)&&(this.form=t),this.isEdit=!V(t),this.isShow=!0},hide(){this.isShow=!1,this.reset(),this.form.name=""},onCloseBtnClick(){this.isShow=!1,this.reset()},reset(){this.form=v({},B),this.$refs.form.resetFields()},handleSubmit(t){this.$refs[t].validate(e=>e&&this.submit())},submit(){this.isLoading=!0;let t=this.isEdit?G:Q;this.form.project_id=this.project.id,this.form.param_id=this.form.id||"",t(this.form).then(e=>{this.$Message.success(e.msg||(this.isEdit?"\u4FEE\u6539\u6210\u529F!":"\u6DFB\u52A0\u6210\u529F!")),this.onCloseBtnClick(),this.$emit("on-ok")}).catch(e=>{}).finally(()=>{this.isLoading=!1})}}},ce=f("\u662F\u5426\u5FC5\u9009"),fe=f("\u53D6\u6D88"),_e=f("\u786E\u5B9A");function he(t,e,n,c,o,r){const _=N,m=q,y=D,h=R,i=Y,u=U,p=j,d=K,C=te("param");return w(),k(d,{modelValue:o.isShow,"onUpdate:modelValue":e[8]||(e[8]=s=>o.isShow=s),width:400,"close-on-click-modal":!1,"append-to-body":"",class:"show-footer-line vertical-center-modal",title:(o.isEdit?"\u7F16\u8F91":"\u6DFB\u52A0")+"\u53C2\u6570"},{footer:a(()=>[l(p,{onClick:e[6]||(e[6]=s=>r.onCloseBtnClick())},{default:a(()=>[fe]),_:1}),l(p,{loading:o.isLoading,type:"primary",onClick:e[7]||(e[7]=s=>r.handleSubmit("form"))},{default:a(()=>[_e]),_:1},8,["loading"])]),default:a(()=>[l(u,{onKeyup:e[5]||(e[5]=ae(s=>r.handleSubmit("form"),["enter"])),ref:"form",model:o.form,rules:o.rules,"label-position":"top"},{default:a(()=>[l(m,{label:"\u53C2\u6570\u540D\u79F0",prop:"name",class:"hide_required"},{default:a(()=>[P(l(_,{onOnChange:r.onChange,modelValue:o.form.name,"onUpdate:modelValue":e[0]||(e[0]=s=>o.form.name=s),placeholder:"\u53C2\u6570\u540D\u79F0",maxlength:"100"},null,8,["onOnChange","modelValue"]),[[C]])]),_:1}),l(m,{label:"\u53C2\u6570\u7C7B\u578B",prop:"type"},{default:a(()=>[l(h,{modelValue:o.form.type,"onUpdate:modelValue":e[1]||(e[1]=s=>o.form.type=s),placeholder:"\u53C2\u6570\u7C7B\u578B",class:"w-full"},{default:a(()=>[(w(!0),oe(se,null,le(o.types,s=>(w(),k(y,{value:s.value,key:s.value,label:s.text},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(m,{label:"",prop:"is_must"},{default:a(()=>[l(i,{modelValue:o.form.is_must,"onUpdate:modelValue":e[2]||(e[2]=s=>o.form.is_must=s)},{default:a(()=>[ce]),_:1},8,["modelValue"])]),_:1}),l(m,{label:"\u9ED8\u8BA4\u503C",prop:"default_value",class:"hide_required"},{default:a(()=>[l(_,{modelValue:o.form.default_value,"onUpdate:modelValue":e[3]||(e[3]=s=>o.form.default_value=s),placeholder:"\u9ED8\u8BA4\u503C",maxlength:"255"},null,8,["modelValue"])]),_:1}),l(m,{label:"\u53C2\u6570\u8BF4\u660E",prop:"description",class:"hide_required"},{default:a(()=>[l(_,{modelValue:o.form.description,"onUpdate:modelValue":e[4]||(e[4]=s=>o.form.description=s),placeholder:"\u53C2\u6570\u540D\u79F0",type:"textarea",autosize:{minRows:4,maxRows:4},maxlength:"255"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}var ve=de(pe,[["render",he]]);const be=b("span",{innerHTML:"\xA0"},null,-1),ge={class:"absolute right-2",style:{top:"7px"}},we=f("\u6DFB\u52A0\u53C2\u6570"),ye=["onClick"],Ce=["onClick"];var Be=ne({setup(t){const e=E(),n=E([]),c=E(!1),o=A(),{projectInfo:r}=ie(o),_=()=>{var i;(i=e.value)==null||i.show()},m=i=>{var u;(u=e.value)==null||u.show(v({},i))},y=i=>{me({title:"\u5220\u9664\u63D0\u793A",content:l("div",{class:"truncate"},[f("\u786E\u5B9A\u5220\u9664\u53C2\u6570\u300C"),i.name,f("\u300D\u5417\uFF1F")]),onOk:()=>X(o.projectInfo.id,i.id).then(u=>{z.success(u.msg||"\u5220\u9664\u6210\u529F\uFF01"),h()})})},h=async()=>{c.value=!0;try{const{data:i}=await $(o.projectInfo.id);let u=i.map||{};const p=[];Object.keys(u).forEach(d=>{u[d]&&p.push(u[d])}),n.value=p}catch{}finally{c.value=!1}};return re(()=>r.value,async()=>{r.value&&r.value.id&&await h()},{immediate:!0}),(i,u)=>{const p=j,d=H,C=J,s=W,M=Z;return P((w(),k(s,{shadow:"never","body-style":{padding:0}},{header:a(()=>[be,b("div",ge,[l(p,{type:"primary",onClick:_},{default:a(()=>[we]),_:1})])]),default:a(()=>[l(C,{data:n.value,"empty-text":"\u6682\u65E0\u6570\u636E"},{default:a(()=>[l(d,{prop:"name",label:"\u53C2\u6570\u540D\u79F0","show-overflow-tooltip":""}),l(d,{prop:"type_name",label:"\u53C2\u6570\u7C7B\u578B",width:"120"}),l(d,{prop:"is_must",label:"\u5FC5\u4F20",width:"70"},{default:a(g=>[b("span",null,ue(g.is_must?"\u662F":"\u5426"),1)]),_:1}),l(d,{prop:"default_value",label:"\u9ED8\u8BA4\u503C",width:"100","show-overflow-tooltip":""}),l(d,{prop:"description",label:"\u53C2\u6570\u8BF4\u660E","show-overflow-tooltip":""}),l(d,{label:"\u64CD\u4F5C",width:"120"},{default:a(({row:g})=>[b("span",{class:"cursor-pointer mr-3 text-blue-600",onClick:T=>m(g)},"\u7F16\u8F91",8,ye),b("span",{class:"cursor-pointer mr-3 text-red-400",onClick:T=>y(g)},"\u5220\u9664",8,Ce)]),_:1})]),_:1},8,["data"]),l(ve,{ref_key:"modifyModal",ref:e,onOnOk:h},null,512)]),_:1})),[[M,c.value]])}}});export{Be as default};
